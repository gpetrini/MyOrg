#+title:      Economia Matemática II
#+date:       [2025-11-19 Wed 10:23]
#+filetags:   :ce112:concurso:graduacao:unicamp:
#+identifier: 20251119T102305
#+signature:  1=1
#+options: toc:1
#+LANGUAGE: pt-br



* Preâmbulo :noexport:

#+LATEX_HEADER: \let\oldsection\section
#+LATEX_HEADER: \renewcommand{\section}{\clearpage\oldsection}
#+LATEX_HEADER: \usepackage[brazil]{babel}






* Observações :noexport:


[[denote:20250206T170658][Teaching and Lectures]]

- Para definições com exemplos aplicados à economia, o apêndice estatístico do Petri é bem útil
  - Parece dar maior suporte matemático do que o livro do Silverberg
  - O Livro do Chang já é suficiente para dar exemplos
- Para otimização, priorizar Guidorizi


* Funções de várias variáveis reais

** Materiais :noexport:

- Simon and Blume Ch 13
- Stewart 14.1-14.2
- Guidorizzi Ch 08-09
- Apêndice matemático Petri
** Introdução

Os problemas econômicos, em sua maioria, podem ser especificados como dependentes de mais de uma variável independente.
Este é o caso, por exemplo, da especificação da função de produção com múltiplos insumos, de funções utilidade dependentes de vários bens, de funções de custo que combinam diferentes fatores produtivos e, de forma não exaustiva, de funções de lucro que integram preços e quantidades em um único objeto analítico.
Por esta razão, a variável econômica de interesse é modelada como função de um vetor de argumentos, e não mais de um único escalar, de modo que o aparato do cálculo diferencial e integral univariado torna-se insuficiente para capturar as interdependências entre variáveis e a geometria dos conjuntos de equilíbrio e de otimização.

Surge, assim, a necessidade de ajustar o "mundo univariado" para dar conta da especificidade de funções de várias variáveis, generalizando noções fundamentais como limite e continuidade (agora formuladas em termos de bolas abertas em espaços euclidianos), desenvolvendo representações gráficas adequadas (superfícies e curvas de nível) e classificando tipos especiais de funções que preservam ou exploram estruturas algébricas relevantes.
Ao longo desta resposta, será feita a exemplificação econômica a partir da função de produção Cobb-Douglas, restringindo-se a uma abordagem marginalista sem perda de generalidade analítica para os objetivos da questão.
A escolha desse recorte se dá pela possibilidade de discutir exemplos paradigmáticos que incluem questões como retornos à escala, substituição técnica entre fatores e, como discutido em outras partes do conteúdo programático da disciplina, propriedades de regularidade necessárias à análise de equilíbrio e de otimização.

A partir dessa perspectiva, o desenvolvimento teórico que se segue organiza-se em torno de alguns eixos centrais.
Em primeiro lugar, descreve-se funções entre espaços euclidianos, apresentando a formulação de limites e continuidade para múltiplas variáveis.
Em seguida, parte-se para discussão de como realizar análises de gráficos de funções de duas variáveis e de suas curvas de nível, com ênfase na interpretação econômica via isoquantas.
Na sequência, a apresentação de tipos especiais de funções, destacando sua representação matricial quando pertinente.
Por fim, articula-se esses elementos a partir de um exemplo numérico de modo a integrar os conceitos e ferramentas aqui discutidos.

** Funções entre espaços euclidianos, limite e continuidade

Apresenta-se, em geral, uma função de várias variáveis reais como uma aplicação \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}^m\), em que \(\mathbb{R}^n\) e \(\mathbb{R}^m\) denotam os espaços euclidianos canônicos, isto é, os espaços vetoriais reais de dimensão \(n\) e \(m\) equipados com o produto interno usual e a norma euclidiana associada.
Um ponto do domínio é um vetor \(x = (x_1,\dots,x_n)\) e a imagem é um vetor \(f(x) = (f_1(x),\dots,f_m(x))\), sendo cada componente \(f_j : D \to \mathbb{R}\) uma função escalar de \(n\) variáveis, o que permite analisar funções vetoriais por meio de suas coordenadas escalares.
A estrutura euclidiana permite apresentar a noção de bola aberta, o que permite discutir limites para o espaço multivariado.
Dito isso, para \(a \in \mathbb{R}^n\) e \(\delta > 0\), define-se a bola aberta centrada em \(a\) de raio \(\delta\) como \(B_\delta(a) = \{x \in \mathbb{R}^n : \|x - a\| < \delta\}\), que generaliza intervalos abertos unidimensionais para dimensões superiores.
Com essa notação, o limite de uma função escalar \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}\) em um ponto \(a\) é definido como \(\lim_{x \to a} f(x) = L\) se, para todo \(\varepsilon > 0\), existe \(\delta > 0\) tal que, para todo \(x \in D\) com \(0 < \|x-a\| < \delta\), tem-se \(|f(x) - L| < \varepsilon\).
Uma condição crucial para a existência do limite é que ele deve ser único e independente do caminho de aproximação, ou seja, o valor \(L\) deve ser o mesmo qualquer que seja a direção ou trajetória pela qual \(x\) se aproxima de \(a\).
Em outros termos, o limite deve existir e ser igual para toda sequência \((x_k)\) em \(D\) que converge para \(a\), garantindo assim que a função é bem comportada em todas as direções em torno do ponto.
A mesma definição pode ser estendida para funções vetoriais (troca-se \(|\cdot|\) por \(||\cdot||\) em \(\mathbb{R}^{m}\))_{}, mantendo a condição de que a aproximação seja válida para todas as direções/sequências.

Em mãos da definição de limite, é possível falar de continuidade.
Diz-se que uma função \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}^m\) é contínua em um ponto \(a \in D\) se \(\lim_{x \to a} f(x) = f(a)\), isto é, se o valor de \(f\) no ponto coincide com o limite obtido pela aproximação de \(x\) a \(a\) ao longo de qualquer sequência de pontos em \(D\).
Caso a função seja contínua para todo ponto \(a \in D\), diz-se que esta função é contínua em \(D\).
Para funções escalares \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}\), a continuidade garante que pequenas perturbações nas variáveis exógenas produzem apenas pequenas alterações nas variáveis endógenas.
Como consequência, exclui-se saltos ou descontinuidades locais no comportamento da função.


Vale notar que para a maioria das aplicações em economia, assume-se que funções são contínuas em seus domínios, pois isso garante comportamento bem-comportado para toda a gama de escolhas ou tecnologias possíveis.
No caso da Cobb-Douglas \(F(K,L) = A K^{\alpha} L^{\beta}\), com \(A>0\) e \(\alpha,\beta>0\), a continuidade decorre do fato de ser um produto de potências de funções contínuas em \(\mathbb{R}_{++}\), assegurando que variações marginais em capital (\(K\)) e trabalho (\(L\)) produzam respostas marginais bem definidas em \(Y\).
Essa propriedade é indispensável para a utilização de derivadas parciais como medidas de produto marginal e para a formulação de condições de primeira ordem em problemas de maximização de lucro ou minimização de custo sob restrições tecnológicas.

** Gráficos e curvas de nível

Outro tema relevante é como representar funções multivariadas graficamente.
Para funções escalares de duas variáveis \(f : D \subseteq \mathbb{R}^2 \to \mathbb{R}\), o gráfico é o conjunto \(\{(x,y,z) \in \mathbb{R}^3 : (x,y) \in D,\ z = f(x,y)\}\), que se interpreta como uma superfície no espaço tridimensional.
A geometria dessa superfície sintetiza como o valor de \(f\) varia em resposta ao deslocamento do ponto \((x,y)\) no plano.
Contudo, para análise qualitativa e econômica, muitas vezes é mais conveniente trabalhar com curvas de nível, definidas, para \(c \in \mathbb{R}\), como \(C_c = \{(x,y) \in D : f(x,y) = c\}\), isto é, conjuntos de pontos do domínio em que a função assume um mesmo valor.
Geometricamente, curvas de nível são projeções, sobre o plano \((x,y)\), das interseções da superfície gráfica \(z=f(x,y)\) com planos horizontais \(z=c\), fornecendo um retrato bidimensional da "topografia" da função.

Retomando ao exemplo a partir da função de produção, as curvas de nível de uma função de produção correspondem às isoquantas, que representam as combinações de fatores que geram o mesmo nível de produto.
Para a Cobb-Douglas \(F(K,L)=A K^{\alpha} L^{\beta}\), a isoquanta associada a \(Y^{\star}>0\) é dada por \(\{(K,L) : A K^{\alpha} L^{\beta} = Y^{\star}\}\), o que pode ser reescrito como \(L = \left(\frac{Y^{\star}}{A}\right)^{1/\beta} K^{-\alpha/\beta}\) uma vez que os insumos produtivos são estritamente positivos.
Essa expressão mostra que as isoquantas são curvas estritamente decrescentes no plano \((K,L)\), capturando a possibilidade de substituição técnica entre capital e trabalho para manter constante o nível de produção, com a inclinação em cada ponto refletindo a taxa marginal de substituição técnica entre fatores.
Essa geometria das curvas de nível, combinada com a continuidade e diferenciabilidade da função, é crucial para a formulação de problemas de escolha ótima de insumos e para a análise de estática comparativa em modelos de firma competitiva.


Uma vez entendido o conceito de curvas de nível, o mesmo raciocínio geométrico pode ser estendido para funções com mais de duas variáveis independentes.
Para uma função escalar \(f : D \subseteq \mathbb{R}^3 \to \mathbb{R}\), define-se uma superfície de nível para um valor \(c \in \mathbb{R}\) como o conjunto \(S_c = \{(x,y,z) \in D : f(x,y,z) = c\}\).
Esta superfície reside no espaço \(\mathbb{R}^3\) cuja visualização ainda é geometricamente acessível.
No caso geral de \(n > 3\) variáveis, fala-se em hiper-superfícies de nível.
Apesar de sua visualização direta ser impossível, essas entidades mantêm o mesmo sentido analítico.


** Tipos especiais de funções, formas quadráticas e polinômios

Dentro do universo das funções de várias variáveis, certas classes especiais desempenham papéis fundamentais tanto na teoria matemática quanto nas aplicações econômicas, organizando-se segundo uma hierarquia de inclusão que parte das estruturas mais simples em direção às mais complexas.

No nível mais básico encontram-se as **funções lineares** \(T : \mathbb{R}^n \to \mathbb{R}^m\), caracterizadas por preservarem a estrutura do espaço vetorial através das propriedades de aditividade \(T(x+y) = T(x) + T(y)\) e homogeneidade \(T(\lambda x) = \lambda T(x)\) para todos \(x,y \in \mathbb{R}^n\) e \(\lambda \in \mathbb{R}\).
Uma consequência fundamental é que toda transformação linear admite representação matricial única \(T(x) = A x\), onde \(A\) é uma matriz \(m \times n\).
Em economia, funções lineares modelam tecnologias com substituição perfeita entre insumos, como em \(F(K,L) = aK + bL\), cujas isoquantas são linhas retas refletindo taxa marginal de substituição constante.
Generalizando esta classe, as **funções afins** da forma \(f(x) = T(x) + b\) (com \(T\) linear e \(b\) constante) incluem um termo independente, sendo úteis para representar funções de custo com componentes fixo e variável.
O gráfico de uma função afim em \(\mathbb{R}^2\) é um plano no espaço tridimensional, enquanto seu análogo em dimensões superiores constitui um hiperplano.

A classe dos **polinômios em várias variáveis** engloba funções da forma \(P(x) = \sum_{|\alpha|\leq d} c_\alpha x_1^{\alpha_1} \cdots x_n^{\alpha_n}\), em que \(\alpha = (\alpha_1,\dots,\alpha_n)\) é um multi-índice de inteiros não negativos e \(d\) é o grau máximo.
Tanto as funções lineares quanto as afins constituem casos particulares dos polinômios de grau um.
Dentro desta classe destacam-se as **formas quadráticas**, polinômios homogêneos de grau dois que podem ser escritos como \(Q(x) = x^\top A x\) com \(A\) simétrica \(n \times n\).
Em duas variáveis, uma forma quadrática genérica é dada por \(Q(x,y) = a x^2 + 2b xy + c y^2\), com representação matricial que viabiliza o estudo de convexidade, definitude e propriedades geométricas por meio dos autovalores da matriz.
Esta representação é particularmente relevante em economia ao analisar aproximações de segunda ordem de funções de produção, pois o Hessiano define uma forma quadrática que determina a natureza local do ponto e propriedades como concavidade.

Posicionando a **função Cobb-Douglas** \(F(K,L) = A K^{\alpha} L^{\beta}\) nesta hierarquia a título de exemplo, observa-se que ela **não** pertence estritamente a nenhuma das classes mencionadas, exceto no caso particular em que \(\alpha\) e \(\beta\) são inteiros não negativos — condição rara em aplicações econômicas onde os expoentes são geralmente números reais positivos.
Com expoentes reais, a Cobb-Douglas é uma função transcendente que apenas compartilha certas propriedades com polinômios homogêneos.
Vale notar que, quando \(\alpha\) e \(\beta\) são inteiros maiores que zero, a Cobb-Douglas pode ser um polinômio, mas isso geralmente implica em retornos não constantes à escala, já que a soma \(\alpha + \beta\) seria um inteiro maior ou igual a 2 no caso mais simples, caracterizando retornos crescentes à escala.

Distinta das classificações algébricas, a **homogeneidade** é uma propriedade que certas funções podem exibir independentemente de sua classe.
Uma função \(f : \mathbb{R}^n_{+} \to \mathbb{R}\) é homogênea de grau \(r\) se satisfaz \(f(tx) = t^r f(x)\) para todo \(t > 0\) e todo \(x\) em seu domínio.
Esta propriedade manifesta-se transversalmente: funções lineares são homogêneas de grau 1, formas quadráticas puras são homogêneas de grau 2, e a Cobb-Douglas é homogênea de grau \(r = \alpha + \beta\).
Na Cobb-Douglas, a homogeneidade conecta-se diretamente ao conceito econômico de retornos à escala: \(r = 1\) corresponde a retornos constantes, \(r > 1\) a retornos crescentes, e \(r < 1\) a retornos decrescentes.
Esta propriedade permite que a Cobb-Douglas herde ferramentas analíticas desenvolvidas para funções homogêneas em geral, como o teorema de Euler que relaciona uma função homogênea com suas derivadas parciais.

Uma implicação importante desta estrutura é que todas as funções mencionadas — lineares, afins, polinomiais e a Cobb-Douglas em seu domínio — são **globalmente contínuas** em seus domínios naturais.
Para a Cobb-Douglas especificamente, a continuidade em \(\mathbb{R}^2_{++}\) decorre de ser composição de funções contínuas, garantindo que variações marginais em insumos produzam respostas marginais bem definidas no produto.
Esta propriedade é indispensável para definir conceitos como produto marginal via derivadas parciais e para formular problemas de otimização com condições de primeira ordem bem comportadas, completando assim o arcabouço analítico necessário para a modelagem econômica com funções de várias variáveis.

** Exemplo numérico

De modo a consolidar e fixar os conceitos anteriores, apresenta-se um exemplo numérico.
Considere a função de produção Cobb-Douglas \(F(K,L) = K^{0.5} L^{0.5}\), que é homogênea de grau \(0.5+0.5 = 1\) e, portanto, exibe retornos constantes à escala.
Para um par de insumos \((K,L) = (4,9)\), obtém-se
\[
F(4,9) = 4^{0.5} \cdot 9^{0.5} = 2 \cdot 3 = 6,
\]
de modo que 4 unidades de capital e 9 de trabalho geram 6 unidades de produto em unidades arbitrárias.
Se ambos os insumos forem escalados por um fator \(t=2\), isto é, \((K',L') = (8,18)\), então
\[
F(8,18) = 8^{0.5} \cdot 18^{0.5} = (2\sqrt{2}) \cdot 3\sqrt{2} = 2\cdot 6 = 12,
\]

que é exatamente o dobro do produto original, ilustrando numericamente a propriedade de retornos constantes à escala.
As isoquantas dessa tecnologia são dadas por \(K^{0.5} L^{0.5} = Y\), ou, equivalentemente,
\[
L = \frac{Y^2}{K},
\]
de modo que, para \(Y=6\), a isoquanta é o conjunto \(\{(K,L) : L = 36/K\}\), que contém, por exemplo, os pontos \((4,9)\) e \((9,4)\).
Esses pares de insumos representam combinações alternativas de capital e trabalho que produzem o mesmo nível de produto, evidenciando a substituibilidade entre fatores e a estrutura de curvas de nível da função de produção.

** Conclusão

Em síntese, a formulação de funções de várias variáveis como aplicações entre espaços euclidianos, ancorada na definição de limite e continuidade, fornece o fundamento conceitual para o estudo rigoroso de superfícies, curvas de nível e propriedades de regularidade.
As classes especiais de funções, quando analisadas por meio de representações matriciais, permitem caracterizar de forma precisa a estrutura local e global da função, com exemplo para a função Cobb-Douglas como exemplo central que, embora não pertença estritamente às classes de polinômios ou formas quadráticas, integra homogeneidade, retornos à escala e comportamento geométrico bem-comportado em uma estrutura funcional que tem se mostrado extremamente útil para modelagem econômica.
Cabe pontuar que a aplicação de funções de várias variáveis não se restringem à teoria da firma ou à teoria do consumidor e, menos ainda, ao paradigma marginalista.
Os exemplos acima apresentados foram utilizados para auxiliar na explicitação econômica de elementos matemáticos.




* Derivada total

** Infos gerais :noexport:

*** Materiais

- Simon and Blume Ch 14 - 14.4
- Chiang Ch 7-8
- Stewart 14.3 e 14.4
- Guidorizi Ch 11 (até 11.4 inclusive)
- Apêndice matemático Petri
- [[https://www.youtube.com/watch?v=gsUgDpGWk-M&list=PLHXZ9OQGMqxc_CvEy7xBKRQr6I214QJcd][Cálculo multivariado (playlist)]]
- [[https://www.youtube.com/watch?v=RVwcBGzQcT8&list=PLMCRxGutHqflZoTY8JCm1GRzCdGXvZ3_S][Oxford Calculus]]


*** Conteúdo

- Interpretação Geométrica
- Aproximação Linear
- Funções de mais de duas variáveis
- Aplicações à Economia

** Tópicos discutidos nos textos de referência :noexport:

- Derivada parcial:
  - Contexto: Problemas econômicos costumam analisar como que mudanças em uma variável afetam a outra
    - Talvez fosse interessente trazer a tona a ideia de estática comparativa como forma de introdução
      - Fazendo assim, é possível discutir variações na vizinhança de um ponto de equilíbrio, por exemplo
      - Variações podem levar em conta parâmetros, não apenas variáveis exógenas
  - Exemplo com função de produção
    - Discussão de produto marginal
      - Talvez seja possível usar o exemplo da função de produção Cobb-Doublas para exprimir os rendimentos decrescentes
    - Na resposta, pensar se começa com uma função de produção genérica ou parte para Cobb-Douglas diretamente
      - Melhor começar com uma função Cobb-Douglas e partir para um exemplo em que K e L possuem valores iniciais definidos, mostrando como computar o produto marginal
        - Tentar pensar em algum exemplo que seja possível computar o valor incrementado
  - Outros exemplos:
    - Mercado simples (com função oferta e demanda), determinando preço e quantidade de equilíbrio
    - Modelo da renda nacional (similar ao IS-LM)
  - Texto discute elasticidade
    - Não sei se daria para ter um exemplo coeso
    - No caso multivariado, passa a ser interessante mostrar a elasticidade preço-cruzada
    - No Chiang, o exemplo com elasticidade reaparece
  - Derivada parcial existe se o limite existir e for finito (no ponto)
    - Lembrar que se diferenciável no ponto, é contínua no ponto
      - No entanto, a recíproca não é válida. Pode ser diferenciável no ponto sem ser contínua neste ponto
    - Se for diferenciável, admitirá derivadas parciais (no ponto)
      - Basta provar que admite derivadas parciais para provar diferenciabilidade
        - Isso é importante porque costuma ser mais fácil mostrar continuidade das derivadas parciais do que da função primitiva
      - Se f for da classe C1 (checar) em A, então a função será diferenciável em A
  - Interpretação geométrica:
    - Inclinação da reta tangente da superfície no ponto em que as outras variáveis são fixadas
      - Associação entre proximidade das curvas de nível e derivada parcial
        - Quanto mais próximas, maior a taxa de variação
    - Não tenho certeza em como apresentar isso
      - Isso é menos relevante porque o foco é na derivada total
  - Noção de derivada parcial requer ausência de relação funcional entre as variáveis exógenas
- Derivada total:
  - Uma forma de introduzir a noção de diferenciais é partir das derivadas e introduzir o termo de "erro" na medida que dx não é infinitezimal
    - Na medida que esta distância da vizinhança diminui (delta x em Chiang), podeze dizer que a derivada é uma boa aproximação da função na vizinhança dela
      - O delta representa o erro de aproximação
      - Derivada indica a inclinação da função no ponto
    - Derivada indica uma proporcionalidade entre variações finitas das variáveis na função
      - A diferença em relação ao conceito de derivada é que permite variação não apenas infinitezimais
      - Diferenciação não é o mesmo que calcular a derivada
        - Diferenciação envolve computar o diferencial da variável dependente em termos das variáveis independentes
        - Diferenciação em relação à "variável independente" costuma remover a ambiguidade
      - Derivada entendida como um quociente entre dois diferenciais
    - Mencionar que a função é contínua e possui derivadas parciais contínuas
    - Mencioanr que as derivadas parciais desempenham o papel de conversoras
    - A diferencial total é a soma das variações aproxiamadas das variáveis exógenas
    - Gancho: derivada parcial pode ser interpretada como uma razão entre diferenciais da a hipótese de que as outras variáveis exógenas são mantidas constantes
      - No entanto, a notação usaldo delta minúsculo não representa uma razão de diferenciais
    - Talvez apontar para o Teorema de Euler?
    - Expressar o diferencial em termos de somatório
    - Importante: apenas a derivada parcial requer independência entre as variáveis exógenas
      - A derivada total permite um termo independente dependa de outros
        - Isso está associado à efeitos diretos e indiretos, exemplificados por um mapa de canal
          - Um exemplo interessante envolveria utilizar Cobb-Douglas que depende também do tempo
    - Notar que diferentemente do diferencial, a derivada total preserva o denominador no lado esquerdo
      - Isso explica o porquê de um dos termos ter apenas a derivada parcial, sem nenhum diferencial
      - Da forma como Chiang apresenta, a regra da cadeia multivariada é antecipada se comparada com Simon e Blume
        - A regra da cadeia multivariada é tema de outra questão
        - Observação do livro-texto: "Em todos os casos discutidos, as derivadas totais – incluindo as que foram denominadas derivadas parciais totais – medem taxas de variação em relação a algumas variáveis definitivas na cadeia ou, em outras palavras, em relação a certas variáveis que são, em certo sentido, exógenas e que não são expressas como funções de outras variáveis. A essência da derivada total e do processo de diferenciação total é dar a devida consideração a todos os canais, indiretos e diretos, por meio dos quais os efeitos de uma variação sobre uma variável independente definitiva possa ser transmitido à variável específica em estudo."
          - Dá a entender que derivada total inclui efeitos diretos e indiretos, enquanto diferencial total captura apenas aproximações lineares
    - Diferenciais e diferenciação total são sinônimos
      - Diferencial é, basicamente, um incremento independente
      - A aproximação linear pode ser escrita em termos de diferenciais: Approx L = f(ponto) + dz; dz = fx(ponto)dx + fy(ponto)dy
  - Apresentar efeito total como uma aproximação linear dos efeitos combinados
    - Apresentar a equação como (F(1) - F(0) = d(F)...) para ficar mais claro o porquê do RHS ter F(0) depois
    - Usar exemplo com Cobb-Douglas
    - Aproximação linear pode ser apresentada como a função dependendo da aproximação (T) e do erro cometido ao fazer essa aproximação (E)
      - O erro tende a zero quanto mais próximo do ponto inicial
        - Dito de outro modo, o erro tende a zero mais rápido que o incremento da função
      - Isso pode ser interessante para fazer um gancho com os casos em que as derivadas parciais existem, mas a função não é diferenciável
        - Se as derivadas parciais não forem contínuas no ponto, então não será diferenciável
      - Uma função é diferenciável se uma aproximação linear é um boa aproximação em torno do ponto em questão
        - O plano tangente se aproxima bem do ponto de tangência
    - Diferencial pode ser escrito como diferencial da função no ponto (x0,y0) em termos dos acréscimos (dx, dy)
    - A variação de f se aproxima ao diferencial de f quanto menores os incrementos
  - Interpretação geométrica
    - Plano tangente ao gráfico é uma boa aproximação na vizinhança do ponto em questão
    - Utilizada função paramétrica do plano que precisa de dois vetores independentes dada uma base fixa
      - Isso é introduzido para mostrar a equivalência geométrica da derivada total e plano tangente
    - Segue para a discussão de diferencial total (em termos de dF), entendidas como variações no plano tangente
      - Ao contruir o diferencial, expressa na forma matricial entre as derivadas parciais e os parâmetros (diferenciais de cada variável)
        - Usado para tratar de aproximação linear
          - Depois, apresentada a derivativa de F no ponto star
          - Usando maping (faz diferença?)
    - Também dá para aprensentar o plano no ponto como: z - f(x0,y0) = fx(x0,y0)(x - x0) + fy(x0,y0)(y - y0)
      - Só é possível apresentar se for diferenciável
      - Se não for diferenciável, mas existirem as derivadas parciais, o plano existirá, mas não será tangente (informação importante)
        - Este plano é perpendicular ao vetor definido pelas derivadas parciais e -1: (fx, fy, -1)
          - A reta que passa pelo ponto inicial e é paralela ao plano anterior é denominada de reta *normal* ao plano no ponto
            - Esta reta é dada pelo ponto inicial (x0, y0, f(x0, y0)) e um escalar * plano perpendicular
      - Apresentar em termos da função linear, em que f fica do lado esquerdo, f avaliado no ponto e as derivadas parciais em torno do ponto ficam do lado direito
  - Funções de mais de uma variável:
    - Trata do hiperplano tangente
    - A partir disso, é mencionada com derivada Jacobiana de F no ponto x star
  - Bônus: Determinantes Jacobianos
    - Permite discutir existência de dependência funcional entre um *conjunto* de funções
      - Montando a matriz Jacobiana quadrada
        - Linhas estão as variáveis dependentes
        - Columnas contém as variáveis independentes
        - Se existem n equações, existem n^2 derivadas parciais
      - Determinante será zero somente se as funções forem funcionalmente dependentes (independente dos valores das variáveis exógenas)
- Checar se faz sentido mencionar o Teorema de Euler para Funções Homogêneas




** Resposta 02 :ignore:

*** Introdução

Grande parte da análise em estática comparativa em economia consiste em estudar como o valor de uma variável endógena de equilíbrio responde a pequenas variações nos parâmetros ou variáveis exógenas.
Em situações com múltiplas variáveis de decisão ou de estado, esse efeito total não pode ser descrito apenas por derivadas univariadas, pois alterações em um parâmetro se propagam por diversos canais que interagem entre si, como na propagação de choques em modelos de equilíbrio geral competitivo.

Nesses casos, a variável de interesse é modelada por funções de várias variáveis reais (\(f : D \subseteq \mathbb{R}^n \to \mathbb{R}^m\), comumente com \(m = 1\)), e o conceito de derivada total fornece o instrumento adequado para capturar a taxa de variação de equilíbrio em relação a uma variável de estado, incorporando simultaneamente todas as dependências funcionais relevantes.
Neste ponto, cabe distinguir as derivadas parciais das derivadas totais.
Enquanto as derivadas parciais medem efeitos marginais “ceteris paribus”, a derivada total agrega os efeitos combinados de variações simultâneas em múltiplos argumentos.

Neste texto, a exemplificação será realizada utilizando a função de produção do tipo Cobb-Douglas.
Dessa forma, os conceitos discutidos podem ser apresentados de maneira sucinta e sem perda de generalidade, em consonância com os objetivos analíticos propostos.
Além disso, a função Cobb-Douglas é amplamente utilizada em modelos de equilíbrio geral para analisar a propagação de choques e a interação entre mercados, servindo como referência canônica contra a qual outras tecnologias, como a função de Leontief com complementaridade perfeita, podem ser comparadas.
Embora tais exemplos não abordem diretamente todos os tópicos da questão, sua compreensão depende dos conceitos que serão descritos a seguir, como derivadas parciais, diferencial total, plano tangente e aproximação linear, todos fundamentais para a análise em estática comparativa.
Para evitar ambiguidades, o termo derivada total refere-se ao operador linear que descreve a sensibilidade local de uma função em relação aos seus argumentos, enquanto o termo diferencial total indica a variação aproximada do valor da função decorrente de pequenas mudanças exógenas e simultâneas em seus argumentos.

*** Derivadas parciais e derivada total: leitura econômica marginalista

Começando pelo ente matemático mais simples, considere uma função escalar \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}\), em que o vetor \(x = (x_1,\dots,x_n)\) representa variáveis exógenas que influenciam uma variável endógena de interesse \(y = f(x)\).
A derivada parcial de \(f\) em relação à coordenada \(x_i\) em um ponto \(a = (a_1,\dots,a_n)\) é definida, quando existir, por
\[f_{x_i}(a) = \lim_{h \to 0} \frac{f(a_1,\dots,a_i + h,\dots,a_n) - f(a_1,\dots,a_i,\dots,a_n)}{h}, \]
mantendo-se constantes as demais variáveis.
Do ponto de vista de estática comparativa, \(f_{x_i}(a)\) mede a taxa de variação instantânea de \(y\) em resposta a um pequeno aumento em \(x_i\), mantendo-se constantes os demais argumentos.
Do ponto de vista econômico, sua interpretação como efeito ceteris paribus pressupõe que tais variações sejam admissíveis na estrutura do modelo.

É importante notar que a mera existência de derivadas parciais não garante a diferenciabilidade da função.
Existem exemplos clássicos de funções em \(\mathbb{R}^2\) cujas derivadas parciais existem em um ponto, mas cuja aproximação linear por um plano não é adequada, de modo que a função não é diferenciável naquele ponto.
Por outro lado, certas técnicas produtivas com complementaridade perfeita entre seus insumos, como a função de Leontief, ilustram uma situação ainda mais irregular, uma vez que as derivadas parciais não existem nos pontos de canto, embora da função seja contínua.
Essa característica evidencia os ganhos de se utilizar uma função do tipo Cobb-Douglas para exemplificar os conceitos aqui descritos.

Quando todas as derivadas parciais \(f_{x_i}\) existem em uma vizinhança de \(a\) e são contínuas em \(a\), diz-se que \(f\) é de classe \(C^1\) em \(a\), o que é suficiente para garantir que \(f\) seja diferenciável em \(a\).
A diferenciabilidade significa que existe uma aplicação linear \(L : \mathbb{R}^n \to \mathbb{R}\) tal que, para incrementos pequenos \(h\),
\[f(a + h) = f(a) + L(h) + o(|h|), \]
com \(o(|h|)/|h| \to 0\) quando \(h \to 0\).
Essa aplicação linear é dada por
\[L(h) = \nabla f(a)\cdot h = \sum_{i=1}^n f_{x_i}(a), h_i, \]
em que \(\nabla f(a) = (f_{x_1}(a),\dots,f_{x_n}(a))\) é o vetor gradiente, definido pelas derivadas parciais em termos de cada variável exógena.

Define-se, nesse contexto, o diferencial total de \(f\) em \(a\) como a forma linear
\[df(a) = \sum_{i=1}^n f_{x_i}(a), dx_i, \]
onde \(dx_i\) representa um incremento infinitesimal em \(x_i\).
Para incrementos pequenos \(h=(dx_1,\dots,dx_n)\), a variação de \(f\) é aproximada por
\[f(a + h) - f(a) \approx df(a) = \sum_{i=1}^n f_{x_i}(a), dx_i, \]
fornecendo uma decomposição de primeira ordem do efeito total de pequenas variações simultâneas nas variáveis explicativas.

No caso da função de produção Cobb-Douglas de dois fatores,
\[F(K,L) = A K^{\alpha} L^{1-\alpha}, \quad A>0,\ 0<\alpha<1, \]
as derivadas parciais em \((K_0,L_0)\) são
\[F_{K}(K_0,L_0) = A \alpha K_0^{\alpha - 1} L_0^{1-\alpha}, \quad F_{L}(K_0,L_0) = A (1-\alpha) K_0^{\alpha} L_0^{-\alpha}, \]
interpretadas como produto marginal do capital e do trabalho, respectivamente.
O diferencial total em \((K_0,L_0)\) é
\[dY = F_{K}(K_0,L_0), dK + F_{L}(K_0,L_0), dL, \]
que exprime a variação aproximada da produção em resposta a pequenas alterações simultâneas nos níveis de capital e trabalho.
As elasticidades de produção em relação a \(K\) e \(L\) são dadas, respectivamente, por \(\alpha\) e \(1-\alpha\), o que reforça a interpretação dos expoentes como medidas de sensibilidade proporcional da produção aos insumos.
Sob hipóteses usuais de concorrência perfeita e retornos constantes à escala, \(\alpha\) e \(1-\alpha\) coincidem com as participações de cada um dos fatores na renda, podendo ser interpretados como a contribuição relativa de cada insumo para o produto agregado.
Por se tratar de uma função homogênea de grau 1, é possível utilizar o Teorema de Euler para funções homogêneas para verificar que as contribuições dos fatores exaurem o valor do produto.

*** Interpretação geométrica: plano tangente e qualidade da aproximação

No caso de duas variáveis, \(f : D \subseteq \mathbb{R}^2 \to \mathbb{R}\), a interpretação geométrica do diferencial total se dá em termos do plano tangente ao gráfico de \(f\) em um ponto \((x_0,y_0)\) onde a função é diferenciável.
O gráfico de \(f\) é a superfície \({(x,y,z) : z = f(x,y)}\) em \(\mathbb{R}^3\), e a existência de derivadas parciais contínuas em uma vizinhança de \((x_0,y_0)\) garante a existência de um plano que aproxima bem essa superfície na vizinhança de \((x_0,y_0,f(x_0,y_0))\).

A equação do plano tangente é
\[z - f(x_0,y_0) = f_{x}(x_0,y_0),(x - x_0) + f_{y}(x_0,y_0),(y - y_0). \]
Para \((x,y)\) próximo de ((x_0,y_0)), obtém-se a aproximação linear
\[f(x,y) \approx f(x_0,y_0) + f_{x}(x_0,y_0),(x - x_0) + f_{y}(x_0,y_0),(y - y_0), \]
em que o erro dessa aproximação tende a zero quando \((x,y)\to(x_0,y_0)\).
Um vetor normal ao plano tangente é dado por \((f_{x}(x_0,y_0),f_{y}(x_0,y_0),-1)\), sendo a expressão afim da aplicação linear associada ao diferencial total em \((x_0,y_0)\).

É essencial distinguir entre a mera existência de derivadas parciais e a diferenciabilidade.
Mesmo que \(f_{x}(x_0,y_0)\) e \(f_{y}(x_0,y_0)\) existam, o plano acima pode não ser uma boa aproximação do gráfico na vizinhança, caso o termo de erro não seja assintoticamente pequeno em relação ao incremento.
Somente quando \(f\) é diferenciável em \((x_0,y_0)\) o plano é verdadeiramente tangente e o diferencial total fornece uma aproximação linear robusta, condição para a validade de análises comparativas baseadas em variações marginais.
No caso da função Cobb-Douglas, o plano tangente em \((K_0,L_0)\) traduz, de maneira geométrica, a combinação linear dos produtos marginais \(F_{K}(K_0,L_0)) e (F_{L}(K_0,L_0)\) como a aproximação da variação da produção para pequenas mudanças simultâneas em capital e trabalho.

*** Generalização para mais variáveis: gradiente e hiperplano tangente

O raciocínio desenvolvido para o caso de duas variáveis estende-se diretamente a funções definidas em $\mathbb{R}^n$, sem a introdução de novos elementos conceituais.
Nesse contexto, a derivada total de $f$ em um ponto $a \in D$ é o operador linear que associa a cada vetor de variações $h \in \mathbb{R}^n$ a taxa de variação local correspondente da função, sendo definida por
\[Df(a)[h] = \nabla f(a)\cdot h = \sum_{i=1}^n f_{x_i}(a), h_i, \]
em que $\nabla f(a)$ denota o gradiente avaliado no ponto de referência.

Ao identificar o vetor $h$ com incrementos efetivos nas variáveis exógenas do modelo, isto é, $h = (dx_1,\dots,dx_n)$, obtém-se o diferencial total de $f$ em $a$,
\[df(a) = \sum_{i=1}^n f_{x_i}(a), dx_i, \]
o qual fornece uma aproximação de primeira ordem para a variação da variável endógena em resposta a pequenas mudanças simultâneas nos argumentos da função.
Dessa forma, enquanto a derivada total expressa a estrutura local de sensibilidade da função, o diferencial total traduz essa estrutura em uma medida operacional do efeito agregado de choques ou variações exógenas nas variáveis explicativas.

Do ponto de vista geométrico, o gráfico de $f$ é um subconjunto de $\mathbb{R}^{n+1}$, e a diferenciabilidade em $a$ assegura a existência de um hiperplano tangente que fornece a melhor aproximação afim do gráfico na vizinhança do ponto $(a,f(a))$.
A equação desse hiperplano é
\[z - f(a) = \sum_{i=1}^n f_{x_i}(a),(x_i - a_i). \]

O gradiente sintetiza as derivadas parciais em cada direção coordenada, enquanto o hiperplano tangente expressa, em termos geométricos, a ideia de que a função é localmente bem aproximada por uma expressão linear em termos das variáveis exógenas.

*** Exemplo numérico: efeito total em Cobb-Douglas via diferenciais

Para evidenciar a aplicabilidade dos conceitos agora descritos, considere diretamente a função de produção Cobb–Douglas no caso particular
\[F(K,L) = K^{\tfrac{1}{2}} L^{\tfrac{1}{2}}, \]
que corresponde a \(\alpha = 1/2\) e implica retornos constantes à escala.
A função é inicialmente avaliada em \((K_0,L_0) = (9,16)\).

O nível de produção nesse ponto é
\[Y_0 = F(9,16) = 9^{\tfrac{1}{2}},16^{\tfrac{1}{2}} = 3 \cdot 4 = 12. \]

As derivadas parciais são dadas por
\[F_K(K,L) = \tfrac{1}{2} K^{-\tfrac{1}{2}} L^{\tfrac{1}{2}}, \quad F_L(K,L) = \tfrac{1}{2} K^{\tfrac{1}{2}} L^{-\tfrac{1}{2}}. \]
Avaliando em \((9,16)\), obtém-se
\[F_K(9,16) = \tfrac{1}{2}\cdot 9^{-\tfrac{1}{2}}\cdot 16^{\tfrac{1}{2}} = \tfrac{1}{2}\cdot \tfrac{1}{3}\cdot 4 = \tfrac{2}{3}, \]
\[F_L(9,16) = \tfrac{1}{2}\cdot 9^{\tfrac{1}{2}}\cdot 16^{-\tfrac{1}{2}} = \tfrac{1}{2}\cdot 3\cdot \tfrac{1}{4} = \tfrac{3}{8}. \]

O diferencial total da produção em \((9,16)\) é, portanto,
\[dY = F_K(9,16), dK + F_L(9,16), dL = \tfrac{2}{3}, dK + \tfrac{3}{8}, dL. \]

Suponha, em um experimento de estática comparativa, que o capital e o trabalho aumentem em uma unidade, isto é, \(\Delta K = 1\) e \(\Delta L = 1\).
Identificando \(dK \approx \Delta K\) e \(dL \approx \Delta L\), a variação aproximada de primeira ordem da produção é
\[\Delta Y \approx \tfrac{2}{3}\cdot 1 + \tfrac{3}{8}\cdot 1 = \tfrac{25}{24}. \]

Assim, o novo nível de produção é aproximadamente
\[Y \approx Y_0 + \Delta Y = 12 + \tfrac{25}{24}. \]
Esse valor é bastante próximo do nível exato
\[F(10,17) = \sqrt{170}, \]
mostrando que o diferencial total fornece uma aproximação simples e computável manualmente para a variação do produto em torno do ponto de referência.

Nesse exemplo, o efeito total das variações conjuntas em \(K\) e \(L\) é obtido como a combinação linear dos produtos marginais, ponderados pelos incrementos dos fatores.
Essa decomposição explicita, em termos diferenciais, como a estática comparativa pode ser operacionalizada de forma transparente e sem recorrer a cálculos numéricos complexos.

*** Considerações finais

A derivada total em funções de várias variáveis oferece um quadro matemático robusto para analisar problemas de estática comparativa em que variáveis endógenas dependem simultaneamente de múltiplos argumentos.
Do ponto de vista formal, a noção de gradiente, diferencial total e plano ou hiperplano tangente cristaliza a ideia de aproximação linear local, permitindo traduzir variações pequenas em insumos, preços ou parâmetros em variações correspondentes na produção, utilidade, custo, lucro ou renda, com controle explícito sobre o erro de aproximação.
Com o intuito de fixar o que foi descrito, mostrou-se que a função de produção Cobb-Douglas exemplifica como se articulam, na análise de produtos marginais, a função de produção, as derivadas parciais \(F_{K}\) e \(F_{L}\), o diferencial total \(dY\) e a linearização em torno de um ponto, bem como os retornos à escala e os efeitos agregados de choques.
Apesar de sintético, o exemplo aqui apresentado pode ser generalizado para situações-problema mais complexas, como é o caso de modelos de equilíbrio geral, em que a análise da propagação de choques exógenos desempenha um papel fundamental.
Vale notar que o instrumental aqui apresentado não se restringe à tradição marginalista, podendo ser facilmente aplicado em contextos heterodoxos, como, por exemplo, em modelos SFC, ABM, Insumo-Produto, entre outros.
Embora frequentemente apresentado no contexto da teoria marginalista, o instrumental de derivadas parciais, diferenciais totais e aproximações lineares é matematicamente geral, podendo ser utilizado como ferramenta analítica em diferentes tradições e classes de modelos econômicos, incluindo modelos Stock-Flow Consistent, modelos baseados em agentes e modelos Insumo-Produto, sempre que se analisem variações locais em torno de um estado de referência.

* Regra da cadeia

** Informações :noexport:

Materiais:
- Simon and Blume Ch 14.5
- Stewart 14.4
- Guidorizzi 11.5 e 12
- Apêndice matemático Petri
- Guidorizzi Ch 12

Conteúdo:
- Vetor tangente
- Derivação ao longo de euma curva
- Aplicações à Economia

** Rascunho :noexport:

A derivada total torna-se particularmente relevante quando os argumentos de uma função multivariada dependem, por sua vez, de outra variável, como o tempo ou um parâmetro de política. [conversation_history:1]
Se \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}\) é diferenciável e \(x : I \subseteq \mathbb{R} \to D\) é uma curva diferenciável, \(x(t) = (x_1(t),\dots,x_n(t))\), então a função composta \(g(t) = f(x(t))\) é diferenciável, e sua derivada é dada pela regra da cadeia multivariada,
\[
\frac{d}{dt} f(x(t))
=
\sum_{i=1}^n
\frac{\partial f}{\partial x_i}(x(t))\,
\frac{dx_i}{dt}(t).
\]
Em termos de diferenciais, num ponto \(t_0\),
\[
df
=
\sum_{i=1}^n
\frac{\partial f}{\partial x_i}(x(t_0))\, dx_i,
\quad
dx_i
=
\frac{dx_i}{dt}(t_0)\, dt,
\]
o que implica
\[
\frac{df}{dt}(t_0)
=
\sum_{i=1}^n
\frac{\partial f}{\partial x_i}(x(t_0))\,
\frac{dx_i}{dt}(t_0).
\]

Em termos econômicos, essa identidade mostra que a derivada total de \(f\) em relação a \(t\) contabiliza tanto os efeitos diretos quanto os indiretos de uma variação em \(t\) sobre a variável de interesse. [conversation_history:1]
Enquanto a derivada parcial \(\partial f/\partial x_i\) mede um efeito “puro” de \(x_i\) mantidas as demais variáveis constantes, a derivada total \(df/dt\) combina essas sensibilidades marginais com a forma como cada \(x_i\) responde a variações em \(t\), via \(\frac{dx_i}{dt}\). [conversation_history:1]
Esse é precisamente o tipo de raciocínio necessário em estática comparativa quando se deseja saber como o equilíbrio reage a mudanças em um parâmetro estrutural ou em uma variável de política. [conversation_history:1]


** Tópicos discutidos :noexport:
:PROPERTIES:
:ID:       b151bd19-070b-4a38-a6c1-a8eb45d49ac5
:END:

- Introdução
  - Derivadas parciais indicam como a função varia em uma direção paralela aos eixos
    - No entanto, podem ser utilizadas para descrever como a função se comporta em qualquer direção, incluindo sob curvas
      - Mais precisamente, ao longo de uma curva em seu domínio
  - Dado isso, apresenta o que é uma curva em Rn
    - Exemplifica parametrizando uma curva em termos do tempo
  - Se x(t) é uma curva parametrizada em Rn, x'j(t) representa a velocidade instantânea da coordenada j
    - Se, por outro lado, x'(t0) é um vetor com ponto inicial em x(t0), este vetor é tangente à curva x(t) no ponto t0.
      - Uma forma de exemplificar, considere a distância entre dois pontos pertencentes à curva. Se os pontos forem próximos suficientes, a reta que aponta para na direção da distância entre esses dois pontos será tangente à curva no ponto
  - Dito de outra forma, a derivada dos componentes da equação paramétrica da curva no ponto t0 é equivalente ao vetor tangente à curva no ponto t0.
    - Lembrando que o ponto em questão deve ser utilizado na função para descobrir o ponto em termos das coordenadas x e y, não em termos de t
      - O fim do vetor tangente ao ponto P(x(t), y(t)) é dado por: r'(P) + P (rever como expressar)
  - Adiante, discute o que é uma curva regular
    - Basicamente, a curva é regular se a derivada da função paramétrica é contínua e diferente do vetor nulo (0,0)
    - Talvez seja interessante deixar explícito na resposta que serão tratados casos de curvas regulares
- Dado esse contexto sobre curvas, a regra da cadeia é apresentada como diferenciação ao longo de uma curva
  - Em outras palavras, a regra da cadeia permite dizer como que uma função se comporta ao longo de uma curva, não somente na direção paralela aos eixos
    - Por se tratar de uma função composta g(t) = f(x(t)), é possível avaliar como a função f se comporta ao longo da curva x(t) como g'(t) = f'(t)x'(t)
      - Derivada de uma função composta é dada pela derivada da função "de fora" avaliada em termos da variável independente multiplicada pela derivada da função "de dentro"
      - Caso exista mais uma função "de dentro", toma-se a derivada parcial dessas funções uma a uma
- Regra da cadeia como forma de derivar uma função composta
  - Logo, a função principal depende indiretamente de outras
  - Sejam f(x,y) e \(\gamma(t)\), funções diferenciávies, a composta \(f(\gamma(t))\) é diferenciável e vale a regra da cadeia
    - Sendo assim, a derivada por regra da cadeia pode ser expressa pelo produto escalar do vetor gradiente e do vetor tangente
- Antes de apresentar a regra da cadeia como um teorema, é apresentada a definição de uma função continuamente difrenciável (C1)
  - Derivada de cada componente de f deve existir e deve ser contínua
  - Uma curva é dita continuamente diferenciável se os componentes da função paramétrica que a descrevem são continuamente diferenciáveis
    - Dada essa definição, apresenta o teorema 14.1 de que se uma função paramétrica é C1 e a função composta g(t) = f(x(t)) é C1, então a derivada na direção da curva x em torno do ponto t0 é compuada como o produto escalar entre a derivada da função em termos das variáveis transitórias multiplicada pela derivada da função paramétrica
- Caso 1: z = f(x(t), y(t)), com x e y sendo diferenciais em t; z é diferenciável em t
- Demonstração parte de uma equação similar ao diferencial total, mas dividindo ambos os lados da equação pela variação da variável mais exógena
  - Adicionam termos de erro que convergem a zero quanto mais infinitezimal a variação da variável mais exógena
- A derivada da equação computada por meio da regra da cadeia mede a taxa de variação da função ao longo de uma curva \(C\) em que pode ser definida como uma equação paramétrica em termos da variável mais exógena (t -> (x,y); R1 -> R2).
  - Taxa de variação ao longo da curva ao se movimentar a partir de um ponto a.
- Quando a função depende de (x,y), mas x = g(s, t) e y = h(s,t); então a função z terá duas derivadas parciais (cada uma em termos da variável mais exógena) que podem ser computadas em termos da regra da cadeia
  - Anteção para o uso da notação de derivada parcial invés de derivada total
  - Este é o caso 2 em Stewart
    - Este caso contém as variáveis independentes (exógenas), intermediárias e dependentes (endógenas)
  - Isso pode ser representado por um diagrama de árvore, em que são coletados os ramos que tem a mesma variável dependente em comum
- Indo ao caso mais geral em que uma função u depende de n variáveis x que, por sua vez, dependem de outras m variáveis independentes t
  - Neste caso, u é uma função de t1 ... tm
  - Seja u uma função de Rs -> Rn (paramétrica), então para qualquer função Rn -> Rl, a função composta g é uma função de Rs -> Rl. A derivada dessa função g é tomada variando cada componente t_i de u(t) por vez, mantendo os demais fixos
- Em seguida, discute-se diferenciação implícita
  - Se F(x,y) = 0 e y = f(x), é possível utilizar a regra da cadeia para expressar a relação de y e x
    - Verificar se é possível utilizar para o caso de uma função Cobb-Doublas
    - F precisa ser diferenciável
    - Demosntração a partir de uma equação similar ao diferencial total
      - Lembrando que dx/dx = 1
      - Obtem-se uma relação entre as derivadas parciais (Fx/Fy) com um sinal negativo
        - Este sinal negativo indica que é uma movimentação ao longo da curva
        - Este sinal negativo possui intuição econômica
  - Guidorizzi também discute derivação implícita e Teorema da Função Implícita no mesmo capítulo que discute regra da cadeia (não incluir nesta resposta)
  - Para a resposta da questão, talvez convenha mencionar a utilização do Teorema da Função Implícita que depende da utilização de derivadas parciais e consegue exprimir a relação entre duas variáveis que não possuem uma relação explícita entre elas
    - Teorema da Função Implícita (Tema de outra resposta, não adicionar) indica as condições para que tal relação seja válida
      - F definida em uma bola aberta contendo (a,b); F(a,b) = 0; Fy(a,b) !=0
      - Em seguida é apresentado um caso para 3 variáveis
  - É apresentado um exemplo a partir de uma função de produção Cobb-Douglas em que capital depende da taxa de juros  e do tempo enquanto o trabalho depende do tempo (ok?) e do juros (!)
    - Talvez dê para pensar em um exemplo melhor a partir da função de produção
    - Computa a regra da cadeia e depois substitui juros e tempo na função intermediária de capital e trabalho, para então substituir os valores desses insumos nesse ponto
      - Faz primeiro para o tempo, mas não o faz para o juros
  - Discutido como a regra da cadeia pode ser utilizada para calcular hyperplanos tangentes as supercíficies de nível
    - Calculada de forma similar à derivada total (com regra da cadeia) e igualando a função a zero
    - Computado como produto vetorial do gradiente e das derivadas da expressão paramétrica (r), igualando a zero
      - Sempre avaliada em um ponto
      - Vetor gradienet é *perpendicular* ao hiperplano tangente
      - Este r é o vetor tangente
    - O plano tangente pode ser determinado como o plano que passa pelo ponto P e é normal ao vetor gradiente nesse ponto
    - A direção da reta normal é dada pelo vetor gradiente
      - Observação, a expressão da equação do plano tangente contém (z - 1) apenas no caso para duas variáveis
  - Reta tangente ao plano
    - A reta tangente no ponto P está contida no planto tangente
      - A reta tangente pode ser calculada como sendo um ponto (P0) + uma direção (dada pela derivada) multiplicada por um escalar
    - Substituindo as coordenadas (x,y) da equação do plano tangente pelas componentes da reta tangente (x = x0 + lamdbda*x'(t), e o mesmo para y e z)
      - Com isso, é possível mostrar que o reta tangente ao ponto está contido no plano tangente a este ponto

** Resposta 03 :ignore:

*** Introdução

Em modelos econômicos teóricos e aplicados, frequentemente busca-se compreender como uma variável endógena de interesse responde a variações em parâmetros exógenos ou a mudanças nas condições de contorno.
Em contextos univariados, a derivada ordinária fornece uma resposta completa.
No entanto, ambientes economicamente relevantes são intrinsecamente multivariados.
A análise, portanto, não se limita a perturbações isoladas em uma única direção coordenada, mas envolve deslocamentos coordenados de múltiplos argumentos ao longo de trajetórias definidas por relações estruturais, tais como leis de movimento, identidades contábeis ou condições de equilíbrio.

O cálculo diferencial de funções de várias variáveis fornece o arcabouço formal para este estudo.
Dentro deste arcabouço, as derivadas parciais caracterizam a sensibilidade da função a variações em cada argumento individual, mantendo os demais constantes.
Geometricamente, elas medem taxas de variação ao longo de direções paralelas aos eixos coordenados.
Contudo, para capturar o ajuste simultâneo de variáveis interdependentes, é necessário estudar o comportamento da função ao longo de curvas parametrizadas arbitrárias em seu domínio.

O objetivo deste texto é construir, com rigor matemático, a ponte entre esses conceitos.
Primeiramente, definimos formalmente curvas parametrizadas, vetores tangentes e o conceito de regularidade.
Em seguida, demonstramos como a regra da cadeia pode ser elegantemente expressa como um produto escalar entre o gradiente da função e o vetor tangente à curva, fornecendo a taxa de variação da função ao longo de qualquer trajetória diferenciável.
Para ilustrar a aplicação econômica deste formalismo, desenvolvemos um exemplo completo utilizando uma função de produção Cobb-Douglas, onde os insumos capital e trabalho são modelados como funções da taxa de juros e do tempo.
A simplicidade algébrica do exemplo permite um tratamento manual claro, enquanto sua estrutura revela a decomposição de efeitos totais em contribuições marginais.
Finalmente, posicionamos este instrumental como fundamento para técnicas analíticas mais avançadas, com destaque para o teorema da função implícita, essencial para a análise de estática comparativa em sistemas de equações que surgem em modelos microeconômicos, macroeconômicos e de equilíbrio geral.

*** Curvas parametrizadas, vetor tangente e curvas regulares

Para estabelecer uma base rigorosa, partimos da definição central.
Uma curva parametrizada em \(\mathbb{R}^n\) é uma função vetorial \(\gamma : I \to \mathbb{R}^n\), definida em um intervalo aberto \(I \subseteq \mathbb{R}\), dada por \(\gamma(t) = ( \gamma_1(t), \gamma_2(t), \dots, \gamma_n(t) )\), onde cada componente \(\gamma_j : I \to \mathbb{R}\) é uma função real.
O parâmetro \(t \in I\) é frequentemente interpretado como tempo.

A noção de diferenciabilidade da curva é herdada da diferenciabilidade de suas componentes.
Diz-se que a curva \(\gamma\) é diferenciável no ponto \(t_0 \in I\) se cada função componente \(\gamma_j\) é diferenciável em \(t_0\).
Nesse caso, o vetor tangente a \(\gamma\) em \(t_0\) é definido por \(\gamma'(t_0) = ( \gamma_1'(t_0), \gamma_2'(t_0), \dots, \gamma_n'(t_0) ) \in \mathbb{R}^n\).

A interpretação geométrica do vetor tangente surge do limite do vetor secante.
Para \(h\) suficientemente pequeno, a razão \((\gamma(t_0 + h) - \gamma(t_0))/h\) aproxima-se de \(\gamma'(t_0)\), e a aproximação torna-se exata no limite quando \(h \to 0\).
A reta que passa por \(\gamma(t_0)\) com direção dada por \(\gamma'(t_0)\) é a reta tangente à trajetória naquele ponto.

Para evitar comportamentos que possam comprometer a análise, como pontos de canto ou pontos estacionários onde a velocidade escalar é nula, impõe-se uma condição de suavidade e não-degeneração.
Uma curva parametrizada \(\gamma: I \to \mathbb{R}^n\) é dita regular (de classe \(C^1\)) se cada componente \(\gamma_j\) possui derivada primeira contínua em \(I\) e se \(\gamma'(t) \neq \vec{0}\) para todo \(t \in I\).
A condição de regularidade garante que a curva possui uma direção tangente única e não nula em todos os pontos, assegurando que a trajetória não possui segmentos estacionários.
Por essas razões, consideraremos apenas curvas regulares.



*** Regra da cadeia e derivação ao longo de uma curva

Com o conceito de curva parametrizada estabelecido, podemos apresentar a regra da cadeia e suas aplicações.
Dada uma função escalar definida em \(\mathbb{R}^n\), a regra da cadeia permite calcular sua taxa de variação ao longo de uma trajetória específica.
Sejam \(D \subset \mathbb{R}^n\) um conjunto aberto, \(f : D \to \mathbb{R}\) uma função diferenciável, e \(\gamma : I \to D\) uma curva parametrizada regular.
A função composta \(g : I \to \mathbb{R}\) definida por \(g(t) = f(\gamma(t))\) descreve os valores de \(f\) restritos ao caminho \(\gamma\).

A regra da cadeia fornece a estrutura para diferenciar \(g\).
Se \(f\) é diferenciável em \(\gamma(t)\) e \(\gamma\) é diferenciável em \(t\), então a função composta \(g\) é diferenciável em \(t\) e sua derivada é dada por
\[
g'(t) = \sum_{j=1}^{n} \frac{\partial f}{\partial x_j}(\gamma(t)) \cdot \gamma_j'(t).
\]
Esta soma pode ser reconhecida como o produto escalar entre dois vetores específicos.
O primeiro é o gradiente de \(f\), denotado \(\nabla f(\gamma(t)) = \left( \frac{\partial f}{\partial x_1}(\gamma(t)), \dots, \frac{\partial f}{\partial x_n}(\gamma(t)) \right)\).
O segundo é o vetor tangente à curva, \(\gamma'(t) = (\gamma_1'(t), \dots, \gamma_n'(t))\).
Portanto, a regra da cadeia admite uma formulação vetorial geometricamente interpretável:
\[
g'(t) = \nabla f(\gamma(t)) \cdot \gamma'(t).
\]
Esta identidade afirma que a taxa de variação de \(f\) ao longo da curva \(\gamma\) no instante \(t\) é a projeção do vetor de maior crescimento de \(f\) (o gradiente) sobre a direção instantânea de movimento \(\gamma'(t)\).
O produto escalar pondera cada derivada parcial de \(f\) pela velocidade de variação da respectiva coordenada ao longo da trajetória.
Assim, a análise de sensibilidade deixa de estar confinada aos eixos coordenados e passa a ser válida para qualquer direção de deslocamento economicamente relevante.

No caso particular de duas variáveis, onde \(f\) depende de \(x\) e \(y\), e estas são funções diferenciáveis de \(t\), a expressão se reduz a
\[\frac{d}{dt} f(x(t), y(t)) = \frac{\partial f}{\partial x} \frac{dx}{dt} + \frac{\partial f}{\partial y} \frac{dy}{dt}, \]
tornando explícita a decomposição da taxa de variação total na contribuição de cada canal marginal.


*** Exemplo econômico: Cobb-Douglas com insumos dependentes de juros e tempo


Para ilustrar a aplicação econômica do formalismo, consideremos uma função de produção Cobb-Douglas com retornos constantes à escala, \(Y = F(K, L) = \sqrt{K L}\).
Suponha que os insumos capital e trabalho não sejam variáveis exógenas primitivas, mas sim funções de um parâmetro de política, a taxa de juros nominal \(r\), e do tempo \(t\).
Esta estrutura captura, de forma reduzida, a ideia de que os insumos evoluem sob influência conjunta das condições financeiras e de um processo autônomo de expansão.
Especificamos formas funcionais simples que garantem positividade e tratabilidade analítica:
\[K(r, t) = 4 + t^2 - r, \quad L(r, t) = 8 + 2t - r, \]
com domínios restritos para que \(K > 0\) e \(L > 0\).
O termo \(t^2\) em \(K\) pode representar um processo de acumulação de capital acelerado, enquanto o termo \(2t\) em \(L\) modela um ajuste linear do emprego ao longo do tempo.
A dependência negativa comum em \(r\) reflete o efeito inibidor de uma taxa de juros mais alta sobre ambos os insumos.

A produção agregada torna-se, assim, uma função composta de \(r\) e \(t\):
\[Y(r, t) = F(K(r,t), L(r,t)) = \sqrt{(4 + t^2 - r)(8 + 2t - r)}\]

Diversos exercícios de política econômica e de previsão exigem o cálculo das sensibilidades \(\partial Y / \partial r\) e \(\partial Y / \partial t\).
Para tanto, aplica-se a regra da cadeia.
As derivadas parciais da função de produção são
\[F_K(K, L) = \frac{1}{2} \sqrt{\frac{L}{K}} \quad \text{e} \quad F_L(K, L) = \frac{1}{2} \sqrt{\frac{K}{L}}. \]
As derivadas parciais dos insumos são, por construção,
\[\frac{\partial K}{\partial r} = -1, \; \frac{\partial K}{\partial t} = 2t; \quad \frac{\partial L}{\partial r} = -1, \; \frac{\partial L}{\partial t} = 2. \]

Portanto, as derivadas parciais de \(Y\) são dadas por:
\[\frac{\partial Y}{\partial r}(r, t) = F_K(K(r,t), L(r,t)) \cdot (-1) + F_L(K(r,t), L(r,t)) \cdot (-1) = -F_K - F_L, \]
\[\frac{\partial Y}{\partial t}(r, t) = F_K(K(r,t), L(r,t)) \cdot (2t) + F_L(K(r,t), L(r,t)) \cdot 2 = 2t F_K + 2 F_L. \]

Considere um ponto de referência arbitrário \((r_0, t_0) = (1, 1)\).
Neste ponto, temos \(K_0 = 4\), \(L_0 = 9\), e \(Y_0 = \sqrt{4 \cdot 9} = 6\).
Os produtos marginais avaliados são
\[F_K(4,9) = \frac{1}{2} \sqrt{\frac{9}{4}} = \frac{3}{4}, \quad F_L(4,9) = \frac{1}{2} \sqrt{\frac{4}{9}} = \frac{1}{3}. \]
Substituindo na regra da cadeia:
\[\frac{\partial Y}{\partial r}(1,1) = -\frac{3}{4} - \frac{1}{3} = -\frac{13}{12}, \]
\[\frac{\partial Y}{\partial t}(1,1) = 2 \cdot \frac{3}{4} + 2 \cdot \frac{1}{3} = \frac{3}{2} + \frac{2}{3} = \frac{13}{6} \]

A interpretação econômica é direta.
Um aumento marginal na taxa de juros, mantido o tempo constante, reduz a produção a uma taxa de \(13/12\) unidades por unidade de \(r\).
Esta queda total decompõe-se em um efeito via redução do capital (\(-3/4\)) e um efeito via redução do trabalho (\(-1/3\)).
Um aumento marginal no tempo, mantida a taxa de juros fixa, aumenta a produção a uma taxa de \(13/6\) unidades por unidade de \(t\), composta pelo efeito da expansão do capital (\(3/2\)) e do trabalho (\(2/3\)).

Geometricamente, no espaço \((K, L)\), os vetores \((-1, -1)\) e \((2, 2)\) são os vetores tangentes às curvas definidas pela variação de \(r\) e \(t\), respectivamente, no ponto \((4,9)\).
As derivadas calculadas são precisamente os produtos escalares destes vetores tangentes com o gradiente \(\nabla F(4,9) = (3/4, 1/3)\).
A regra da cadeia, portanto, traduz a sensibilidade em relação aos parâmetros primários para uma análise no espaço dos insumos, decompondo o efeito total na contribuição de cada canal produtivo marginal.


*** Extensões e menção a funções implícitas

O formalismo apresentado ao longo desta resposta é fundação para técnicas analíticas centrais na modelagem econômica.
Esse formalismo é central tanto em modelos de equilíbrio geral computável quanto em modelos SFC que fazem uso de análise de sensibilidade paramétrica em torno dos pontos de equilíbrio (por exemplo, estados estacionários).
Em modelos SFC, em particular, os estados estacionários são determinados simultaneamente por identidades contábeis e relações comportamentais, de modo que a análise de sensibilidade pode ser avaliada ao longo de curvas que explicitam o rigor contábil desta modelagem.
Em tais modelos, o equilíbrio é caracterizado por um sistema de equações da forma \(F(\mathbf{x}, \boldsymbol{\alpha}) = \mathbf{0}\), onde \(\mathbf{x}\) é um vetor de variáveis endógenas e \(\boldsymbol{\alpha}\) um vetor de parâmetros exógenos.
A análise de sensibilidade paramétrica, que busca quantificar derivadas locais do tipo \(\partial x_i / \partial \alpha_j\), é formalmente realizada através da aplicação sistemática da regra da cadeia combinada com o teorema da função implícita.
Este procedimento generaliza a ideia de derivação ao longo de uma curva para um contexto multidimensional, onde a curva é uma "superfície" definida implicitamente pelas condições de equilíbrio econômico e contábil.

Em síntese, a articulação entre derivadas parciais, curvas parametrizadas, vetores tangentes e regra da cadeia oferece um quadro conceitual unificado para estudar como funções de várias variáveis se comportam ao longo de trajetórias economicamente relevantes.
A regra da cadeia, por sua vez, foi apresentada não apenas como uma fórmula algébrica, mas como a operação geométrica fundamental de tomar o produto escalar entre o gradiente da função e o vetor tangente à curva, \(\nabla f \cdot \gamma'\).
O exemplo com a função de produção Cobb-Douglas em que capital e trabalho dependem de juros e tempo ilustra como esse instrumental permite decompor a sensibilidade do produto em contribuições associadas a diferentes canais de propagação de choques, ao mesmo tempo em que prepara o terreno para extensões mais gerais envolvendo funções implícitas e sistemas de equações em macroeconomia teórica e aplicada.






* Derivadas direcionais e gradientes

** Informações :noexport:

Materiais:
- Simon and Blume Ch 14.6
- Stewart 14.6
- Guidorizzi Ch 13 e Ch 11.5
- Apêndice matemático Petri
- Ostaszewski Ch 13

Tópicos:
- Derivadas Direcionais
- Vetor Gradiente
- Aplicações à Economia

** Tópicos discutidos :noexport:

- Derivada direcional
  - Uma forma de introduzir a derivada direcional é a partir da regra da cadeia
    - Paremetrizar a direção das variáveis como \(\vec{x} = \vec{x}_{0} + t\cdot \vec{u}\)
    - Em seguida, utilizar a regra da cadeia para calcular a derivada parcial em termos de \(t\)
    - Avaliar a derivada parcial no ponto \(t = 0\)
    - Isso fornece a derivada direcional da função F na direção \(vec{u}\)
  - Considere:
    - Uma função f(x,y)
    - Um ponto P (x0,y0) no domínio de f
    - Um vetor *unitário* u = (a,b)
    - Dadas essas condições
      - Existe um r > 0  tal que |t| < r
      - Os pontos da reta que passam por P na direção de u (x0 + at, y0 + bt)
        - Esses pontos pertencem ao domínio de f
      - Isso permite definir a *taxa média* de variação da função f na direção u entre os pontos P e o ponto dado pela reta: f(P + deslocamento(t)) - f(P)/t
        - Quando o limite \(t \to 0\) existe, é possível denominar a derivada direcional da função f no ponto P e na direção de u, com u sendo unitário
        - As derivadas parciais de f são um caso particular de derivada direcional, sendo estas paralelas aos eixos (seja na direção (x0 + t, y0) ou (x0, y0 + t)) avaliada no ponto P
          - São derivadas na direção dos vetores canônicos i = (1,0) e j = (0,1)
        - Em termos de notação, melhor apresentar o limite como de (x0 + ha, y0 + hb), com \(h\to 0\)
          - Para o caso de mais variáveis, utilizar (a,b,c)
          - Usando a notação vetorial: \(D_{{\mathbf{u}}} = \lim_{h\to 0} \frac{f(\vec{x}_{0} + h\cdot \vec{u}) - f(\vec{x}_{0})}{h}\)
            - \(f(\vec{x}_{0} + h\cdot \vec{u})\) é o valor da função da reta direcional
      - Notação: \(\frac{\partial f}{\partial \vec{u}}\)
    - Se f é diferenciável de x e de y, então f tem derivada direcional na direção u para qualquer valor de (a,b)
      - Duf = fx(P)a + fy(P)b
        - Que é o equivalente de se utilizar a regra da cadeia em que x e y são parametrizadas em termos de h (x = x0 + ah; dx/dh = a)
      - O vetor direcional pode ser definito apenas em termos de um ângulo \(\theta\) em relaço ao eixo x positivo
        - Então \(\vec{u} = (\cos\theta, \sin\theta\)
  - Interpretação geométrica
    - A derivada direcional é a tangente do ângulo entre o vetor (da direção) e a reta tangente no ponto (checar)
      - O vetor é tangente a curva de nível no ponto P à curva de nível em f(x,y) = c
      - Isso ocorre dado que \(\vec{u}\) é unitário
  - A derivada direcional assumirá o valor máximo na direção do versor do vetor gradiente no ponto
  - Observação: Uma função pode ser contínua em um ponto, ter derivadas em todas as direções neste ponto e, mesmo assim, não ser diferenciável neste ponto
    - Exemplo uma função com não-linearidades de modo que assume outro valor em um ponto específico
- Vetor gradiente
  - O vetor gradiente pode ser apresentado como função linear que aproxima a função F em torno de um ponto
  - O gradiente de uma função é uma *função vetorial* definida como o produto (?) entre as derivadas parciais e os componentes canônicos:
    - \(\nabla f(x,y) = f_{x}\cdot \vec{i} + f_{y}\cdot \vec{j}\)
      - Em termos de notação, é melhor expor o vetor gradiente em termos das bases canônicas
  - Interpretação geométrica do vetor gradiente
    - Considerar a função composta como da classe C1 e um ponto (x,y) que associa uma curva de nível f(x,y) = c
    - Suponha que o gradiente não é o vetor nulo
    - Dadas essas hipóteses
      - O vetor gradiente é *perpendicular* à curva paramétrica no ponto que é avaliado
      - Imagem da curva parametrizada está contida na curva de nível
      - Considerando que a função está sendo avaliada ao longo da curva de nível, ao diferenciar os dois lados de f(x,y) = c; o produto escalar entre o gradiente e o vetor tangente é zero
        - Isso mostra que o vetor gradiente é perpendicular a curva de nível no ponto em questão
          - De forma equivalente, o gradiente é *normal* a curva de nível
          - O vetor gradiente pode fornecer a equação da reta tangente: vetor gradiente \(\cdot\) ((x,y) - (x0, y0))
            - Isso permite encontrar o vetor tangente sem ter uma parametrização prévia
              - Depois é possível obter a equação vetorial da reta:
                - Dado um vetor normal (gradiente), é possível encontrar um vetor paralelo à reta que, somado ao ponto inicial, fornece a equação vetorial
      - Ao generalizar para n variáveis, o vetor gradiente é perpendicular à superfície de nível e ao plano tangente
        - A equação do plano tangente pode ser obtido fazendo o produto escalar do vetor gradiente por ((x, y, z) - P0) e igualando a zero
        - Alternativamente, basta fazer o produto entre o vetor gradiente e a derivada da curva paramétrica
    - Memo: vetor gradiente é utilizado para computar o plano tangente à superficie
      - Mencionar isso de forma muito breve na resposta
      - A taxa de variação da função na direção do vetor tangente é nula (não muda de curva de nível)
        - Lembrar que possuindo uma reta e um vetor paralelo a essa reta (gradiante), é possível expressar a equação do plano nesse ponto
- Relação entre derivada direcional e vetor gradiente
  - Considerações:
    - Se a função for diferenciávell em um ponto P, então ela admite derivadas direcionais em todas as direções neste ponto
  - Se f for diferenciável e u for um vetor unitário,
    - Pode-se calcular a derivada direcional como sendo o produto escalar entre o vetor gradiente e o vetor \(\vec{u}\)
    - Se f *não* for diferenciável, a relação anterior não é válida necessariamente
      - Por essa razão, mencionar que serão trabalhadas funções diferenciáveis
  - A derivada direcional é a projeção escalar do vetor gradiente na direção de \(\vec{u}\)
  - Seja \(\theta\) o ângulo entre dois vetores \(\vec{w}\) e \(\vec{u}\), então a lei dos cossenos permite calcular o produto escalar entre eles como sendo a multiplicação das normas desses vetores e do cosseno de \(\theta\)
    - Como \(\vec{u}\) é unitário: \(|\vec{w}|\cdot \cos(\theta)\)
      - Esse valor é o componente escalar de \(\vec{w}\) na direção \(\vec{u}\)
      - Dito de outra forma, a derivada direcional (escalar) é a *componente escalar* do vetor gradiente na direção de \(\vec{u}^{}\)
      - Assumindo que o vetor gradiente não seja nulo
    - Sendo assim, a derivada direcional na direção de \(\vec{u}\) pode ser calculado como a multiplicação da norma do vetor gradiente pelo cosseno do ângulo entre o vetor gradiente e \(\vec{u}\)
      - Isso mostra que a derivada direcional é maxima na direção do vetor gradiente (\(cos(0) = 1\))
        - Dito de outra forma, \(\vec{u}\) é versor do vetor gradiente (unitário de mesma direção)
          - O valor da derivada neste ponto é a norma (não necessariamente unitária) do vetor gradiente
        - Outra forma de interpretar é que dado um ponto P, deve-se andar na direção do vetor gradiente para que a função cresça mais rápido
      - Isso mostra que a direção perpendicular ao vetor gradiente (\(\cos(90º) = 0\)) tem variação mínima
        - Derivada ao longo da curva de nível
      - Lembrando que a derivada direcional é um número e diz a taxa de variação média da função na direção \(\vec{u}\)
- Aplicações em economia
  - É possível utilizar uma função de produção do tipo Cobb-Douglas com \(P_{{0}}\) sendo pontos definidos por quadrados
    - Calcular a derivada direcional na direção de um vetor arbitrário
    - Lembrar de utilizar um vetor unitário
  - Em seguida, utiliza-se o vetor gradiente para dizer qual é a proproção de capital e trabalho que fariam a produção crescer mais rapidamente
    - A proporção é dada por x : y

** Resposta 04 :ignore:


A análise quantitativa em economia envolve frequentemente a investigação da sensibilidade de variáveis endógenas a variações em parâmetros e condições exógenas.
Em estruturas unidimensionais, a derivada ordinária fornece uma medida completa e unívoca desta relação.
Contudo, a modelagem de sistemas econômicos exige a consideração de espaços de estados multidimensionais, nos quais as relações funcionais dependem de múltiplos argumentos que se ajustam de forma simultânea.
A análise marginal, portanto, transcende o cálculo de efeitos isolados, capturados pelas derivadas parciais, para abarcar o estudo da resposta funcional a combinações lineares específicas de variações em seus argumentos.

Este é o domínio conceitual da derivada direcional, que generaliza o operador de diferenciação para qualquer direção no espaço de estados.
O vetor gradiente emerge como o objeto matemático que sintetiza toda a informação marginal local.
O rigor deste arcabouço fundamenta a análise de estática comparativa em modelos complexos e a caracterização de condições de otimalidade em problemas com restrições.
Para fins de notação, símbolos vetoriais serão distinguidos por uma seta, como em \(\vec{x}\), para diferenciá-los de escalares.

O objetivo desta exposição é triplo.
Primeiro, apresenta-se a definição de derivada direcional em \(\mathbb{R}^n\) via limite, estabelecendo-a como a generalização natural do conceito de derivada parcial e discutindo as condições para sua existência.
Segundo, introduz-se o vetor gradiente a partir da noção de diferenciabilidade, permitindo relacionar uma função a todas as derivadas direcionais possívies.
Terceiro, explorar-se a interpretação geométrica do gradiente, que o situa como vetor normal às superfícies de nível da função, revelando as direções de variação nula e máxima.
Quarto, ilustrar a operacionalidade deste instrumental mediante um exemplo econômico baseado numa função de produção Cobb-Douglas, onde será calculada a sensibilidade do produto a um perfil específico de ajustes marginais nos insumos.
A exposição concluirá posicionando estes conceitos como pilares para métodos numéricos e analíticos amplamente utilizados em economia.


Para formalizar matematicamente a intuição da variação em uma direção arbitrária, parte-se de uma função escalar \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}\) e de um ponto interior \(\vec{x}_0 \in D\) no qual se deseja analisar o comportamento local.
O interesse reside em medir a taxa de variação de \(f\) quando seu argumento se desloca a partir de \(\vec{x}_0\) não ao longo de um eixo coordenado, mas sim seguindo uma trajetória especificada por um vetor direção \(\vec{v} \in \mathbb{R}^n \setminus \{\vec{0}\}\).
Para que esta medida de taxa de variação seja independente da magnitude do vetor escolhido, adota-se a convenção de se trabalhar com a versão normalizada (unitária) deste vetor.
Define-se, portanto, o versor na direção de \(\vec{v}\) como \(\vec{u} = \vec{v}/\|\vec{v}\|\), satisfazendo por construção \(\|\vec{u}\| = 1\).
A trajetória pode ser parametrizada por \(\vec{x}(h) = \vec{x}_0 + h\vec{u}\), onde o parâmetro escalar \(h \in \mathbb{R}\) controla o deslocamento ao longo da reta.
A derivada direcional de \(f\) no ponto \(\vec{x}_0\), na direção do vetor unitário \(\vec{u}\), é definida como o limite – quando este existe – da taxa média de variação ao longo desta trajetória:
\[
D_{\vec{u}} f(\vec{x}_0) = \frac{\partial f}{\partial \vec{u}}(\vec{x}_0) = \lim_{h \to 0} \frac{f(\vec{x}_0 + h\vec{u}) - f(\vec{x}_0)}{h}.
\]
É crucial observar que a existência deste limite não é garantida para uma função arbitrária \(f\) e uma direção arbitrária \(\vec{u}\); a derivada direcional pode existir em algumas direções e não em outras, independentemente da existência das derivadas parciais.
Quando ela existe, seu valor quantifica a taxa instantânea de variação de \(f\) em \(\vec{x}_0\) quando o argumento se move na direção e sentido de \(\vec{u}\).
Vale pontuar que se \(\vec{u}\) é escolhido como o \(i\)-ésimo vetor da base canônica de \(\mathbb{R}^n\), denotado \(\vec{e}_i\), a definição é equivalente à derivada parcial, isto é, \(D_{\vec{e}_i} f(\vec{x}_0) = \frac{\partial f}{\partial x_i}(\vec{x}_0)\).
Deste modo, a derivada direcional constitui uma generalização da noção de derivada parcial, estendendo o âmbito da análise de sensibilidade para qualquer direção no espaço.

Por simplicidade, a resposta irá se restringir aos casos em que a função \(f\) é diferenciável ao longo de todo seu domínio.
A condição de diferenciabilidade garante que o comportamento local de \(f\) é suficientemente regular, de modo que ele pode ser aproximado de maneira ótima por uma transformação linear acrescida de um termo de erro, sendo este termo de erro assintaticamente zero.
Nos casos de uma função deferenciável, a variação em uma direção arbitrária \(\vec{u}\) pode ser expressa como sendo o produto escalar entre essa direção e o vetor gradiente.
Este vetor gradiente, denotado por \(\nabla f(\vec{x}_0)\), agrega todas as derivadas parciais de primeira ordem:
\[
\nabla f(\vec{x}_0) = \left( \frac{\partial f}{\partial x_1}(\vec{x}_0), \frac{\partial f}{\partial x_2}(\vec{x}_0), \dots, \frac{\partial f}{\partial x_n}(\vec{x}_0) \right).
\]
A expressão \(f(\vec{x}_0 + \vec{u}) \approx f(\vec{x}_0) + \nabla f(\vec{x}_0) \cdot \vec{u}\) constitui a melhor aproximação linear da função na vizinhança de \(\vec{x}_0\).
É esta propriedade de linearização local, intrínseca à diferenciabilidade, que fundamenta a ligação direta e computável entre o gradiente e as derivadas direcionais.
No entanto, vale notar que a derivada direcional pode existir em funções não diferenciáveis, mas o mesmo não vale para a relação entre gradiente e a direção da derivada direcional.

Considerando o caso particular de um incremento \(\vec{v}\) parametrizado como \(\vec{v} = h\cdot \vec{u}\), com \(h\) escalar, é possível calcular o seguinte limite quando \(h\to 0\):
\[
\lim_{h \to 0} \frac{f(\vec{x}_0 + h\vec{u}) - f(\vec{x}_0)}{h} = \nabla f(\vec{x}_0) \cdot \vec{u} + \lim_{h \to 0} \frac{o(|h|)}{h}.
\]
em que \(o(|h|)\) é o erro da aproximação linear, sendo assintoticamente igual à zero.
O lado esquerdo é, por definição, a derivada direcional \(D_{\vec{v}} f(\vec{x}_0)\):
\[
D_{\vec{v}} f(\vec{x}_0) = \nabla f(\vec{x}_0) \cdot \vec{v}.
\]
Desse modo, para uma função diferenciável, a derivada direcional em qualquer direção \(\vec{u}\) não apenas existe, mas pode ser calculada como o produto escalar entre o gradiente no ponto e o versor da direção.
A complexidade inerente ao cálculo de um limite é encapsulada no gradiente, que uma vez determinado, permite obter a sensibilidade da função em infinitas direções com uma operação algébrica trivial.

Além da simplicidade algébrica, a derivada parcial possui uma interpretação geométrica bastante importante.
Recordando a identidade do produto escalar, \(\vec{a} \cdot \vec{b} = \|\vec{a}\| \|\vec{b}\| \cos \theta\), onde \(\theta\) é o ângulo entre os vetores, e notando que \(\|\vec{v}\|=1\), tem-se:
\[
D_{\vec{v}} f(\vec{x}_0) = \|\nabla f(\vec{x}_0)\| \cos \theta.
\]
Desta forma, a derivada direcional é a projeção escalar do vetor gradiente sobre a direção \(\vec{v}\).
Sendo assim, o valor máximo possível para a derivada direcional é \(\|\nabla f(\vec{x}_0)\|\), e este máximo é atingido exatamente quando \(\cos \theta = 1\), ou seja, quando \(\theta = 0\) e o vetor direção \(\vec{v}\) aponta na mesma direção e sentido do gradiente.
Portanto, o vetor gradiente \(\nabla f(\vec{x}_0)\) aponta na direção de maior crescimento local da função \(f\), e sua norma fornece a taxa máxima desse crescimento.

Além disso, a derivada direcional é nula quando \(\cos \theta = 0\), isto é, quando \(\theta = \pi/2\) e o vetor \(\vec{v}\) é ortogonal ao gradiente.
O conjunto de todas as direções ortogonais a \(\nabla f(\vec{x}_0)\) define o plano tangente à superfície de nível que passa por \(\vec{x}_0\), definida por \(f(\vec{x}) = f(\vec{x}_0)\).
Conclui-se que o vetor gradiente é normal (perpendicular) a estas superfícies de nível.
Em termos econômicos, se \(f\) representa uma função objetivo (como utilidade ou lucro), mover-se na direção do gradiente significa seguir o caminho de mais íngreme ascensão, enquanto mover-se em uma direção ortogonal ao gradiente significa permanecer, em primeira ordem, no mesmo nível da função (por exemplo, ao longo de uma isoquanta ou curva de indiferença).


Para ilustrar a aplicação e a interpretação econômica deste instrumento, considera-se um exemplo com uma função de produção Cobb-Douglas com retornos constantes à escala.
Especificamente, seja \(Y = F(K, L) = K^{\alpha}L^{1-\alpha}\).
Por simplicidade, fixa-se \(\alpha = 1/2\), resultando em \(F(K, L) = \sqrt{KL}\).
Os produtos marginais do capital e do trabalho são, respectivamente:
\[
F_K(K, L) = \frac{1}{2} K^{-1/2} L^{1/2} = \frac{1}{2}\sqrt{\frac{L}{K}}, \quad
F_L(K, L) = \frac{1}{2} K^{1/2} L^{-1/2} = \frac{1}{2}\sqrt{\frac{K}{L}}.
\]
O vetor gradiente da função de produção é, portanto,
\[
\nabla F(K, L) = \left( \frac{1}{2}\sqrt{\frac{L}{K}},\; \frac{1}{2}\sqrt{\frac{K}{L}} \right).
\]
Seleciona-se para análise um ponto factível e simétrico no espaço dos insumos, \((K_0, L_0) = (4, 4)\).
Nesta combinação, o nível de produção é \(Y_0 = F(4,4) = \sqrt{4 \times 4} = 4\).
O gradiente avaliado neste ponto é:
\[
\nabla F(4,4) = \left( \frac{1}{2}\sqrt{\frac{4}{4}},\; \frac{1}{2}\sqrt{\frac{4}{4}} \right) = \left( \frac{1}{2} \cdot 1,\; \frac{1}{2} \cdot 1 \right) = \left( \frac{1}{2},\; \frac{1}{2} \right).
\]
A norma deste gradiente, que fornece a máxima taxa de crescimento local do produto, é:
\[
\|\nabla F(4,4)\| = \sqrt{ \left(\frac{1}{2}\right)^2 + \left(\frac{1}{2}\right)^2 } = \sqrt{ \frac{1}{4} + \frac{1}{4} } = \sqrt{ \frac{1}{2} } = \frac{\sqrt{2}}{2}.
\]

Suponha agora um cenário de política ou uma conjuntura na qual os insumos capital e trabalho não evoluem de forma isolada, mas sofrem ajustes marginais conjuntos.
Por exemplo, imagine uma política que induza, na margem, uma variação no estoque de capital três unidades para cada quatro unidades de variação no nível de emprego.
Este perfil de ajuste é representado pelo vetor de deslocamento \(\vec{v} = (3, 4)\).
Para utilizar a fórmula da derivada direcional, é necessário trabalhar com o versor unitário correspondente.
A norma de \(\vec{v}\) é \(\|\vec{v}\| = \sqrt{3^2 + 4^2} = \sqrt{25} = 5\), logo o versor é \(\vec{u} = \vec{v}/\|\vec{v}\| = (3/5, 4/5)\).
A sensibilidade direcional do produto a este choque composto é calculada como:
\[
D_{\vec{u}} F(4,4) = \nabla F(4,4) \cdot \vec{u} = \left( \frac{1}{2}, \frac{1}{2} \right) \cdot \left( \frac{3}{5}, \frac{4}{5} \right) = \frac{1}{2} \cdot \frac{3}{5} + \frac{1}{2} \cdot \frac{4}{5}.
\]
\[
\frac{3}{10} + \frac{4}{10} = \frac{7}{10}.
\]
Portanto,
\[
D_{\vec{u}} F(4,4) = \frac{7}{10}.
\]
O valor positivo e finito desta derivada direcional, \(0.7\), indica que um deslocamento infinitesimal a partir da cesta \((K,L)=(4,4)\) na direção definida por \(\vec{u}\) gera um aumento no produto.
Sua magnitude quantifica a taxa instantânea desta resposta: para cada unidade de deslocamento na direção \(\vec{u}\) no espaço dos insumos, o produto aumenta, em primeira ordem, \(0.7\) unidades.
É instrutivo contrastar este resultado com a direção de crescimento máximo, dada pelo versor do gradiente \(\vec{u}_{\text{max}} = \nabla F / \|\nabla F\| = (1/2, 1/2) / (\sqrt{2}/2) = (1/\sqrt{2}, 1/\sqrt{2})\).
A derivada direcional nesta direção é exatamente \(\|\nabla F(4,4)\| = \sqrt{2}/2\).
Comparando os valores, observa-se que a derivada direcional na direção da política \((7/10 = 0.7)\) é ligeiramente superior à taxa máxima teórica.
O cálculo confirma que a direção da política \((3,4)\) é quase, mas não exatamente, a direção de crescimento mais íngreme, e que seu efeito marginal sobre o produto é quantitativamente próximo do máximo possível.

Em contrapartida, é possível identificar direções que, localmente, não alteram o nível de produção.
Estas são as direções tangentes à isoquanta que passa pelo ponto \((4,4)\).
Para encontrar uma tal direção, basta encontrar um vetor \(\vec{w} = (w_1, w_2)\) ortogonal ao gradiente, ou seja, que satisfaça \(\nabla F(4,4) \cdot \vec{w} = 0\).
Dado \(\nabla F(4,4) = (1/2, 1/2)\), a condição é \((1/2)w_1 + (1/2)w_2 = 0\), que simplifica para \(w_1 + w_2 = 0\).
Uma escolha simples e intuitiva é \(\vec{w} = (1, -1)\).
Um deslocamento na direção de \(\vec{w}\) representa um movimento ao longo da isoquanta, mantendo o produto constante em uma aproximação linear.

Esta análise explicita como o instrumental de derivada direcional e gradiente permite decompor um choque vetorial qualquer em uma componente que afeta o valor da função (projetada na direção do gradiente) e uma componente que a deixa inalterada (na direção ortogonal).
Este exemplo mostra como, a partir dos produtos marginais (o gradiente), podemos avaliar quantitativamente o impacto de qualquer política que afete os insumos de forma combinada, separando a componente que altera o produto daquela que apenas realoca os insumos ao longo de uma isoquanta.

Para fins de conclusão, vale destacar que a relevância operacional dos instrumentos aqui descritos em economia é substancial.
Na estática comparativa teórica, o vetor gradiente é central na formulação das condições de primeira ordem em problemas de otimização com restrições, conforme estabelecido pelo método dos multiplicadores de Lagrange.
Em métodos computacionais, a noção de gradiente generaliza-se para a matriz Jacobiana, que é o componente fundamental de algoritmos como o de Newton-Raphson, utilizado para encontrar soluções de equilíbrio em sistemas de equações não-lineares.
Desta forma, o domínio dos conceitos de derivada direcional e vetor gradiente fornece a linguagem analítica precisa para investigar sensibilidade e otimização em espaços multidimensionais, constituindo um pilar metodológico para os métodos quantitativos em economia.

* Funções explícitas

** Informações :noexport:

Materiais:
- Simon and Blume Ch 14.7
- Guidorizzi Ch 7?
- Guidorizzi Ch 06?
- Apêndice matemático Petri

Temas:
- Aproximação por diferenciais
- Regra da cadeia
- Aplicações à economia

** Tópicos discutidos :noexport:

- Contextualização:
  - Frequentemente os problemas econômicos envolvem mais de uma variável endógena (diga-se \(m\))
    - Isso implica em \(m\) equações, com \(n\) variáveis exógenas (em que \(m \neq n\) recorrentemente)
      - Exemplo: Uma firma que produz \(m\) produtos utilizando \(n\) insumos
    - Essas \(m\) equações podem ser representadas por um função \(F\) única
      - Cada componente de \(F\) pode ser vista como uma função de Rn a R1
        - Isso permite reutilizar todo o ferramenttal de Rn->R1 e combiná-lo em um vetor m
- Aproximação por diferenciais:
  - Estudando a função \(F\) em um ponto específico \(\vec{x}\), é possível avaliar a aproximação por diferenciais \(\Delta \vec{x}\) aplicado a cada componente
  - Em seguida, utiliza-se a notação vetorial e matricial para combinar esses resultados
    - Denotado como \(DF(\vec{x}^{\star} = DF_x\)
    - Isso fornece a matriz jacobiana derivativa \(m\times n\)
  - Vale notar que não é apenas um agrupamento de informações
    - O diferencial é uma aplicação linear na qual a matriz jacobiana representa uma aproximação linear de \(F\) em torno de \(\vec{x}^{{\star}}\)
- Regra da cadeia:
  - Regra da cadeia é extendida para várias variáveis endógenas a partir de um teorema
    - Seja \(F: Rn -> Rm\), seja \(a: R1 -> Rn\) da classe \(C1\)
      - Então, a função composta \(g(t) = F(a(t))\) é da classe C1 de \(R1 -> Rm\)
      - Logo, \(g'(t) = Df_{i}(a(t))\cdot a'(t)\)
      - Esse resultado gera uma equação vetorial
    - Em seguinda, estende a regra da cadeia para os casos em que a curva é (\(Rs \to Rn\))
      - Mantendo \(s-1\) coordenadas *fixas* e diferencia em termos de uma delas (\(t_{h}\)), então a regra da cadeia torna-se:
        - \[\frac{\partial g}{\partial t_h} = \sum_{j} \frac{\partial f_i}{\partial x_j}(\vec{a}(t))\cdot \frac{\partial a_j}{\partial t_h}\]
        - Depois, generaliza-se para \(1, \ldots, m\) como sendo a multiplicação da matrix Jacobiana de \(\vec{x}\) no ponto \(a(t)\) pela matriz de derivadas parciais de \(\vec{a}\) em termos de \(\vec{t}\)
          - Em outras palavras, a matriz resultante da regra da cadeia é dado pelo produto as matrizes jacobianas de \(F\) em \(\vec{x}\) e da matriz \(A\) em \(\vec{s}\)
            - \(DH(\vec{s}) = DF(\vec{x}) \cdot DA(\vec{s})\)
    - A derivativa de uma aplicação linear composta é a composição das derivativas das aplicações lineares avaliada em cada ponto
- Aplicações à economia:
  - Aproximação por diferenciais: No texto é apresentada duas mercadorias com funções demanda com elasticidade constante na vizinhança dos preços correntes
    - Computa-se o diferencial no ponto de cada uma das funções
    - Computa-se o efeito do aumento de preço e queda da renda
    - Em seguida, rearruma essa informação em termos da matrix Jacobiana
  - Regra da cadeia: Apresenta preços (\(p_{1}, p_{2}\) e renda (\(y\)) do exemplo anterior como dependentes do tempo (\(t\))
    - Em seguida, calcula a matriz Jacobiana e derivada das funções intermediárias em um ponto específico (\(t = t0\))
- Outros pontos:
  - A essência do cálculo pode ser dita como o estudo de aproximações lineares
    - Utilizar derivativas para ter uma aproximação linear
    - Utilizar teoria linear para estudar o comportamento dessa aplicação linear
    - Utilizar cálculo para traduzir a informação da transformação linetar para obter informações da função *não-linear* em torno do ponto do equilíbrio


** Resposta 05 :ignore:

A análise quantitativa em economia dedica-se frequentemente a estudar como variáveis de interesse respondem a mudanças em suas condições determinantes.
Quando há uma única variável endógena, a derivada univariada fornece uma medida completa e local dessa sensibilidade.
No entanto, os problemas econômicos típicos são inerentemente multidimensionais, envolvendo um conjunto de variáveis endógenas que dependem de múltiplos fatores explicativos.
Modelos macroeconômicos microfundamentados, como os de equilíbrio geral ou os baseados em agentes, ilustram essa complexidade.
De forma não excludente, funções de produção com múltiplos produtos também se enquadram nessa categoria.

Nesses contextos, a relação funcional é descrita por uma aplicação que mapeia um vetor de argumentos para outro de resultados.
Formalmente, considere uma aplicação \(\vec{F} : D \subseteq \mathbb{R}^n \to \mathbb{R}^m\).
Ela associa a cada vetor de argumentos \(\vec{x} = (x_1, \dots, x_n)\) um vetor de resultados \(\vec{y} = (F_1(\vec{x}), \dots, F_m(\vec{x}))\).
O estudo da variação local de \(\vec{y}\) em resposta a um pequeno deslocamento em \(\vec{x}\) a partir de um ponto de referência \(\vec{x}_0\) constitui o cerne da análise marginal multivariada.
Esta análise é fundamental para a estática comparativa, que busca prever a direção e a magnitude das mudanças nas variáveis endógenas após um choque exógeno.

Esta exposição apresenta de forma sistemática esse instrumental, integrando a teoria matemática à aplicação econômica.
Inicialmente, são apresentados os fundamentos teóricos, incluindo as definições de diferenciabilidade e da matriz jacobiana.
É discutido como a Jacobiana representa a melhor aproximação linear do sistema não linear original em uma vizinhança de um ponto.
Na sequência, a operacionalidade do diferencial total é demonstrada por meio de um exemplo econômico.
O exemplo considera uma firma com tecnologia multiproduto, o que permite calcular como um choque nos insumos de produção se propaga, em primeira ordem, aos níveis de produção de diferentes bens.
Posteriormente, o formalismo é integrado à regra da cadeia, ampliando seu alcance analítico.
Tal integração é fundamental para modelar situações em que os argumentos diretos da função são determinados por outras variáveis, como ocorre quando insumos evoluem ao longo do tempo em resposta a variáveis primitivas.
Por fim, o arcabouço é situado no contexto mais amplo dos métodos quantitativos em economia.
Para fins de notação, símbolos vetoriais serão distinguidos por uma seta, como em \(\vec{x}\), para diferenciá-los dos símbolos escalares.

A base teórica para todo este desenvolvimento repousa na noção de diferenciabilidade, que formaliza a ideia de suavidade local necessária a uma boa aproximação linear.
Diz-se que uma função vetorial \(\vec{F} : \mathbb{R}^n \to \mathbb{R}^m\) é diferenciável em um ponto \(\vec{x}_0\) se existe uma transformação linear \(L : \mathbb{R}^n \to \mathbb{R}^m\) tal que a variação da função satisfaça
\[
\lim_{\vec{h} \to \vec{0}} \frac{\|\vec{F}(\vec{x}_0 + \vec{h}) - \vec{F}(\vec{x}_0) - L(\vec{h})\|}{\|\vec{h}\|} = 0.
\]
Quando esta condição é válida, o termo \(\vec{F}(\vec{x}_0 + \vec{h}) - \vec{F}(\vec{x}_0) - L(\vec{h})\) é denotado por \(o(\|\vec{h}\|)\), indicando que ele tende a zero mais rapidamente do que \(\|\vec{h}\|\).
Uma consequência fundamental deste conceito é que, se \(\vec{F}\) é diferenciável em \(\vec{x}_0\), então cada uma das \(m\) funções componentes de \(\vec{F}\), \(F_i\), é individualmente diferenciável.
A transformação linear \(L\) pode então ser representada de forma única por uma matriz quando expressa nas bases canônicas dos espaços \(\mathbb{R}^n\) e \(\mathbb{R}^m\).

Esta representação matricial é a matriz jacobiana, denotada por \(D\vec{F}(\vec{x}_0)\).
A matriz resultante é de ordem \(m \times n\) cuja entrada na linha \(i\) e na coluna \(j\) é precisamente a derivada parcial \(\partial F_i / \partial x_j\) avaliada no ponto \(\vec{x}_0\).
Assim, a Jacobiana agrega todos os efeitos marginais do sistema, organizando os gradientes de cada função componente em suas linhas.
\begin{equation*}
D\vec{F}(\vec{x}_0) =
\begin{pmatrix}
\dfrac{\partial F_1}{\partial x_1}(\vec{x}_0) & \cdots & \dfrac{\partial F_1}{\partial x_n}(\vec{x}_0) \\
\vdots & \ddots & \vdots \\
\dfrac{\partial F_m}{\partial x_1}(\vec{x}_0) & \cdots & \dfrac{\partial F_m}{\partial x_n}(\vec{x}_0)
\end{pmatrix}.
\end{equation*}

Para um vetor de perturbação \(\vec{h} = (\Delta x_1, \dots, \Delta x_n)\) suficientemente pequeno, a propriedade de diferenciabilidade garante que a variação no vetor de resultados é bem aproximada pela aplicação linear da matriz jacobiana sobre este incremento.
Esta aproximação linear, cujo valor é dado pela aplicação do diferencial total ao incremento \(\vec{h}\), é expressa por
\[
\vec{F}(\vec{x}_0 + \vec{h}) - \vec{F}(\vec{x}_0) \approx D\vec{F}(\vec{x}_0) \, \vec{h}.
\]
O lado direito, \(D\vec{F}(\vec{x}_0) \, \vec{h}\), fornece uma aproximação de primeira ordem para a variação conjunta de todas as variáveis \(F_i\) em resposta a um vetor genérico de choques \(\vec{h}\) aplicado aos argumentos.

Para ilustrar a aplicação econômica e operacional deste arcabouço, passamos a um exemplo numérico.
Considere uma firma que utiliza dois insumos primários, capital físico \(K\) e trabalho \(L\), para produzir dois bens finais distintos.
As tecnologias de produção para cada bem são representadas por funções Cobb-Douglas com retornos constantes à escala, porém com intensidades de fatores distintas.
Especificamente, as funções são dadas por
\[Y_1 = F_1(K,L) = K^{\frac{1}{2}} L^{\frac{1}{2}} \quad \text{e} \quad Y_2 = F_2(K,L) = K^{\frac{1}{3}} L^{\frac{2}{3}}. \]
O vetor de produção é \(\vec{Y} = \vec{F}(K,L) = (F_1(K,L), F_2(K,L))\).
A matriz jacobiana deste sistema de produção, que consolida todos os produtos marginais, é calculada diretamente das derivadas parciais:
\begin{equation*}
D\vec{F}(K,L) =
\begin{pmatrix}
\dfrac{1}{2} K^{-\frac{1}{2}} L^{\frac{1}{2}} & \dfrac{1}{2} K^{\frac{1}{2}} L^{-\frac{1}{2}} \\
\dfrac{1}{3} K^{-\frac{2}{3}} L^{\frac{2}{3}} & \dfrac{2}{3} K^{\frac{1}{3}} L^{-\frac{1}{3}}
\end{pmatrix}.
\end{equation*}

Selecionamos o ponto \((K_0,L_0)=(1,1)\) para análise.
Neste ponto, os níveis de produção são \(Y_1^0=1\) e \(Y_2^0=1\), e a Jacobiana avaliada assume a forma particularmente simples:
\begin{equation*}
D\vec{F}(1,1)=
\begin{pmatrix}
\dfrac{1}{2} & \dfrac{1}{2} \\
\dfrac{1}{3} & \dfrac{2}{3}
\end{pmatrix}.
\end{equation*}

Considere agora um choque pequeno e assimétrico nos insumos, representado pelo vetor
\[\Delta \vec{I} = (\Delta K,\Delta L)=\left(\dfrac{1}{2},\dfrac{1}{4}\right)\]
Trata-se de um deslocamento local em torno do ponto de referência, com variações proporcionais distintas entre capital e trabalho.
O diferencial total fornece uma aproximação linear para o impacto desse choque combinado sobre o vetor de produção:
\begin{equation*}
\Delta \vec{Y} \approx
= D\vec{F}(1,1)\,\Delta \vec{I}
=
\begin{pmatrix}
\dfrac{1}{2} & \dfrac{1}{2} \\
\dfrac{1}{3} & \dfrac{2}{3}
\end{pmatrix}
\begin{pmatrix}
\dfrac{1}{2} \\
\dfrac{1}{4}
\end{pmatrix}
=
\begin{pmatrix}
\dfrac{1}{4}+\dfrac{1}{8} \\
\dfrac{1}{6}+\dfrac{1}{6}
\end{pmatrix}
=
\begin{pmatrix}
\dfrac{3}{8} \\
\dfrac{1}{3}
\end{pmatrix}.
\end{equation*}
Assim, obtemos \(\Delta Y_1 \approx 3/8\) e \(\Delta Y_2 \approx 1/3\).
Cada componente do diferencial total corresponde à soma ponderada dos produtos marginais, em que os pesos refletem os incrementos efetivos de cada insumo.
Este cálculo ilustra como a estática comparativa multivariada decompõe a variação total de cada variável endógena em contribuições marginais associadas a diferentes fatores.

Além disso, a estrutura da Jacobiana fornece informações sobre as possibilidades locais de transformação entre os dois bens.
A Taxa Marginal de Transformação (TMT) entre os produtos, que mede o /trade-off/ produtivo, não é constante e depende da direção específica em que os insumos são ajustados.
Fixados o ponto \(\vec{I}_0=(1,1)\) e um vetor direcional \(\vec{d}\), considere a curva parametrizada \(\gamma(t)=\vec{I}_0+t\vec{d}\), que descreve uma trajetória específica de variação conjunta dos insumos.
A variação local dos produtos ao longo dessa trajetória é dada por
\[\frac{dF_i}{dt}\Big|_{t=0}=\nabla F_i(\vec{I}_0)\cdot\vec{d}, \quad i=1,2. \]
A razão
\[\text{TMT}_{\vec{d}}(\vec{I}_0) = -\frac{\nabla F_2(\vec{I}_0)\cdot\vec{d}}{\nabla F_1(\vec{I}_0)\cdot\vec{d}} \]
define uma taxa marginal de transformação local e direcional, válida apenas no entorno de \(\vec{I}_0\) e condicionada à trajetória considerada.

Por fim, considere que os insumos evoluem ao longo do tempo segundo trajetórias lineares
\[K(t)=1+\dfrac{1}{2}t, \quad L(t)=1+\dfrac{1}{4}t, \]
de modo que \(K(0)=L(0)=1\).
As taxas de variação instantâneas são \(K'(0)=1/2\) e \(L'(0)=1/4\).
Aplicando a regra da cadeia em sua forma matricial, obtemos:
\begin{equation*}
\frac{d\vec{Y}}{dt}(0)
= D\vec{F}(1,1)\,\frac{d\vec{I}}{dt}(0)
=
\begin{pmatrix}
\dfrac{1}{2} & \dfrac{1}{2} \\
\dfrac{1}{3} & \dfrac{2}{3}
\end{pmatrix}
\begin{pmatrix}
\dfrac{1}{2} \\
\dfrac{1}{4}
\end{pmatrix}
=
\begin{pmatrix}
\dfrac{3}{8} \\
\dfrac{1}{3}
\end{pmatrix}
\end{equation*}
Portanto, no instante \(t=0\), a produção do bem 1 cresce a uma taxa de \(3/8\), enquanto a do bem 2 cresce a uma taxa de \(1/3\).
Este resultado evidencia como a regra da cadeia combina a sensibilidade tecnológica capturada pela Jacobiana com a dinâmica assimétrica dos insumos.


O diferencial total e a matriz jacobiana, portanto, constituem a base analítica fundamental para a investigação de sistemas econômicos multivariados.
Sua relevância manifesta-se em três níveis operacionais principais.
O primeiro é a linearização local de sistemas não-lineares, procedimento cujo centro está na construção e interpretação da matriz jacobiana.
O segundo é a execução da análise de estática comparativa, realizada por meio do cálculo do diferencial total \(D\vec{F}(\vec{x}_0) \, \Delta \vec{x}\).
O terceiro é o rastreamento da propagação de choques em modelos com estrutura hierárquica, formalizado pela regra da cadeia matricial \(D(\vec{F} \circ \vec{A}) = (D\vec{F}) (D\vec{A})\), que permite decompor os efeitos totais em canais intermediários.
Em conjunto, este instrumental fornece a linguagem para modelar a propagação de distúrbios em redes de interdependência econômica e para calcular medidas de sensibilidade multidirecionais.
Ele também estabelece os fundamentos para métodos numéricos iterativos, como o algoritmo de Newton-Raphson, essenciais para a solução computacional de sistemas de equações de equilíbrio não-lineares.
Dominar a transição da análise univariada para este quadro multivariado é, portanto, uma competência metodológica central para a construção e interpretação de modelos econômicos.

* Derivadas de ordens superiores

** Informações :noexport:
Materiais:
- Simon and Blume Ch 14.7
- Guidorizzi Ch 14
- Chiang 09
- Retomar Guidorizzi para continuamente diferenciáveis
- [[https://www.youtube.com/watch?v=wCZ1VEmVjVo&pp=2AbDBw%3D%3D][Jacobiano]]
- Apêndice matemático Petri

Tópicos:
- Funções Continuamente Diferenciáveis
- Derivadas de segunda ordem e matriz Hessiana
- Aplicações à Economia

** Temas discutidos :noexport:
:PROPERTIES:
:ID:       a85eebfe-b3d0-4eaf-a70f-16029cb7f145
:END:

- Derivadas parciais de ordems superiores:
  - A igualdade entre derivadas parciais mistas nem sempre se aplica
    - Para se aplicar, a função deve ser continuamente diferenciável
  - Apresentada definição da classe \(C^{n}\)
    - Uma função é dita desta classe se admitir todas as derivadas parciais de ordem \(n\)
    - Se a função for da classe \(C^{2}\), então o teorema de Schwarz é válido
      - Este teorema afirma que as derivadas parciais mistas são idênticas
        - Isso implica que a ordem da diferenciação não é relevante
      - No entanto, se for apenas diferenciável (não continuamente diferenciável), podem existir situações que esse teorema não se aplique
      - Também conhecido como Schwarz-Young
        - O Teorema de Young generaliza para além de derivadas segundas em que a ordem de diferenciação não importa para ordems superiores
      - Este teorema implica que a matriz Hessiana é uma matriz *simétrica*
  - Lembrar que uma função de \(n\) variáveis terá \(n^{2}\) derivadas parciais segundas
- Funções continuamente diferenciáveis
  - Primeiro apresenta a noção de continuamente diferenciável para uma variável e depois extende para ser continuamente diferenciável para várias variáveis
  - Se for as derivadas forem diferenciávels, é possível calcular as derivadas de ordem superior
- Matriz Hessiana:
  - É a matriz que coleta as derivadas parciais de segunda ordem de modo que as derivadas segundas puras estão na diagonal principal
    - Denotada como \(D^2f(\vec{x})\)
- Aplicação da regra da cadeia para derivadas parciais de ordens superiores:
  - Seja a seguinte função \(f(x,y)\), \(x = x(t)\) e \(y = y(t)\)
    - Suponha que \(f\) seja \(C^{2}\)
      - Isso permite que a derivada parcial de ordem 1 tenha seu próprio gradiente
      - Utilizando a regra da cadeia:
        - A derivada de segunda ordem em termos de x, por exemplo, é dada pela derivada segunda pura de x e x derivado em função de t; derivada mista em termos de y e y derivado em função de t
    - Ao expressar a derivada de segunda ordem por meio da regra da cadeia, tem-se:
      - \(g''(t) = \frac{\partial^{2} f}{\partial x^2}\frac{dx}{dt} + 2\cdot \frac{\partial^{2} f}{\partial x \partial y} (\frac{dx}{dt} + \frac{dy}{dt}) + \frac{\partial^{2} f}{\partial y^2} \frac{dy}{dt}\)
- Aplicação em economia:
  - Calculada a derivada segunda de uma função de produção Cobb-Douglas
    - A derivada mista não é negativa
    - As derivadas parciais puras são estritamente negativas para qualquer combinação de fatores
- Outros tópicos:
  - Ao discutir derivada de segunda ordem em uma função Cobb-Douglas, mencionar rendimentos marginais decrescentes
    - Importante lembrar que os rendimentos marginais decrescentes ocorrem a partir de um ponto, e não para todos os pontos
      - Pode ser interessante discutir que este ponto equivale ao limite em que a firma pode aplicar a técnica produtiva dominante
  - A função é dita continuamente duplamente diferenciável se a derivada segunda for contínua
    - Dito de outro modo, não é suficiente que a derivada segunda exista
    - Existe uma diferença entre ser n-mente diferenciável e continuamente diferenciável
      - A segunda exige que a derivada seja contínua enquanto a primeira exige apenas que a derivada exista
  - Comumente, as funções mais utilizadas em economia são continuamente diferenciáveis
  - Em termos de interpretação, a derivada segunda é comumente associada à aceleração (variação da variação)
    - Se a derivada segunda é positiva, a inclinação tende a aumentar
    - Está associada a curvatura do gráfico
      - Associações com funções estritamente côncavas e estritamente convexas
        - Estritamente côncava :: Definindo dois pontos M e N; o segmento de reta desta ficar *abaixo* dessa curva
          - Derivada segunda é negativa para todo o intervalo
        - Estritamente convexa :: Definindo dois pontos M e N; o segmento de reta desta ficar *acima* dessa curva
          - Derivada segunda é positiva para todo o intervalo
      - Esta discussão de convexidade/concavidade pode ser associada preferências por risco
    - Os pontos em que a derivada muda de sinal são pontos de inflexão


** Resposta 06 :ignore:
:PROPERTIES:
:ID:       781223d9-04e7-4d0e-86d4-c1ff2ce7b300
:END:

A análise em economia, sobretudo a análise marginal, frequentemente estende-se para além dos efeitos de primeira ordem.
Decisões de produção, consumo e investimento dependem não apenas da direção da variação (capturada pelo gradiente), mas também da sua curvatura.
É a análise de segunda ordem que permite discriminar entre um máximo e um mínimo, formalizar a lei dos rendimentos marginais decrescentes e compreender a natureza das interações entre variáveis, como a complementaridade ou substitutibilidade entre fatores de produção, por exemplo.
Em sistemas multivariados, que são o lugar-comum na modelagem econômica, este avanço analítico exige a compreensão das condições de diferenciabilidade contínua e o domínio da matriz Hessiana, objeto matricial que organiza as derivadas segundas.


Considerando esses pontos, a exposição está organizada em quatro partes principais.
Primeiramente, apresentam-se as classes de funções continuamente diferenciáveis, com destaque para a condição que assegura a simetria das derivadas mistas segundo o Teorema de Schwarz e sua generalização, o Teorema de Young.
Em seguida, introduz-se a matriz Hessiana como o objeto que reúne todas as derivadas parciais de segunda ordem de uma função escalar e discute suas propriedades algébricas.
Em terceiro lugar, aplica-se esse instrumental à análise de uma função de produção Cobb-Douglas com retornos constantes à escala, com o cálculo explícito de sua Hessiana e a interpretação de seus elementos.
Por fim, destaca-se de forma sucinta a relação da Hessiana com problemas de otimização, concavidade e convexidade.
Neste texto, vetores são indicados por uma seta sobrescrita, como em \(\vec{x}\), para distingui-los de escalares.


A transição do cálculo de primeira ordem para o de segunda ordem exige a imposição de condições de regularidade mais fortes sobre a função.
Uma função escalar \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}\) é dita de classe \(C^1\) em um conjunto aberto \(U  \subseteq D\) se todas as suas derivadas parciais de primeira ordem são funções contínuas em \(U\).
Esta condição é mais forte do que a mera existência das derivadas parciais.
Para o estudo das derivadas segundas, a condição de regularidade é pertencer à classe \(C^2\).
Uma função \(f\) é de classe \(C^2\) em \(U\) se todas as suas derivadas parciais de segunda ordem existem e são contínuas em \(U\).
Esta condição implica, por sua vez, que todas as derivadas parciais de primeira ordem são diferenciáveis.

Uma consequência imediata da condição de continuidade descrita anteriormente é a possibilidade de comutação na ordem de diferenciação para derivadas mistas.
Este resultado é formalizado pelo Teorema de Schwarz.
Especificamente, para uma função \(f\) de classe \(C^2\) e para quaisquer índices \(i\) e \(j\), tem-se a igualdade
\[\frac{\partial^2 f}{\partial x_i \partial x_j} = \frac{\partial^2 f}{\partial x_j \partial x_i}\]
em todo ponto de \(U\).
Este teorema é um caso particular do Teorema de Young.
O Teorema de Young, por sua vez, garante a independência da ordem de diferenciação das derivadas mistas de qualquer ordem \(k\), desde que a função seja de classe \(C^k\).
Sendo assim, sob condições de suavidade típicas dos modelos econômicos, a ordem de avaliação dos efeitos cruzados entre variáveis é irrelevante.
Esta propriedade permite organizar as derivadas segundas de forma simétrica e estruturada em uma matriz.

A simetria das derivadas mistas permite organizar as derivadas segundas em uma estrutura matricial conveniente.
Para uma função escalar \(f: \mathbb{R}^n \to \mathbb{R}\) de classe \(C^2\), as \(n^2\) derivadas parciais de segunda ordem podem ser dispostas em uma matriz \(n \times n\).
Esta matriz é a matriz Hessiana de \(f\) no ponto \(\vec{x}\), denotada por \(D^2 f(\vec{x})\) ou \(H_f(\vec{x})\).
Por força do Teorema de Schwarz, esta matriz é simétrica.
A Hessiana pode ser interpretada de duas formas complementares.
Uma delas é tratá-la como um operador que agrega as derivadas parciais segundas de uma função escalar multivariada; outra é apresentá-la como a jacobiana do operador gradiente, sob a condição de diferenciabilidade contínua de segunda ordem.
Sua estrutura genérica é dada por:
\begin{equation*}
D^2 f(\vec{x}) =
\begin{pmatrix}
\dfrac{\partial^2 f}{\partial x_1^2}(\vec{x}) & \cdots & \dfrac{\partial^2 f}{\partial x_1 \partial x_n}(\vec{x}) \\
\vdots & \ddots & \vdots \\
\dfrac{\partial^2 f}{\partial x_n \partial x_1}(\vec{x}) & \cdots & \dfrac{\partial^2 f}{\partial x_n^2}(\vec{x})
\end{pmatrix}.
\end{equation*}
Os elementos da diagonal principal, as derivadas segundas puras, medem a taxa marginal de variação da função em relação à própria variável.
Os elementos fora da diagonal, as derivadas mistas, quantificam as interações cruzadas.
Coletivamente, a Hessiana desempenha um papel central na caracterização da curvatura local de uma função multivariada.
De forma mais simplificada, a Hessiana generaliza a noção de derivada segunda para o caso multivariado.

Uma aplicação relevante da Hessiana surge na análise da variação de uma função ao longo de trajetórias.
A regra da cadeia para derivadas segundas revela que a segunda variação da função composta depende tanto da curvatura intrínseca da superfície quanto da curvatura da própria trajetória no espaço de domínio.
Fixada uma parametrização linear no domínio, a Hessiana induz uma forma quadrática que associa a cada vetor direcional uma medida da aceleração local da função nessa direção.
Já do ponto de vista da aproximação por diferenciais, a Hessiana é o objeto que codifica o termo de segunda ordem na expansão de Taylor multivariada.
Mais precisamente, para \(\vec{h}\) pequeno, pode-se escrever,
\begin{equation*}
f(\vec{x}_0 + \vec{h})
\approx
f(\vec{x}_0)
+
\nabla f(\vec{x}_0) \cdot \vec{h}
+
\frac{1}{2}\, \vec{h}^{\mathsf{T}} D^2 f(\vec{x}_0)\, \vec{h},
\end{equation*}
em que o termo de segunda ordem é o responsável pela curvatura local da função em torno de \(\vec{x}_0\) e está na base da análise de concavidade e convexidade, bem como da classificação de pontos críticos.
Esta representação formaliza, em termos operacionais, a informação de curvatura sintetizada pela Hessiana.


Para concretizar a interpretação econômica deste instrumental abstrato, considere a função de produção Cobb-Douglas com retornos constantes à escala, \(Y = F(K, L) = A K^{\alpha} L^{1-\alpha}\), com \(A > 0\) e \(0 < \alpha < 1\).
Esta função é de classe \(C^{\infty}\) em seu domínio \((K,L) \in \mathbb{R}_{++}^2\).
Como consequência, suas derivadas segundas são contínuas e o Teorema de Schwarz se aplica.
Os produtos marginais, as derivadas primeiras, são
\[F_K(K,L) = \alpha A K^{\alpha-1} L^{1-\alpha}, \quad F_L(K,L) = (1-\alpha) A K^{\alpha} L^{-\alpha}. \]
As derivadas parciais de segunda ordem são obtidas pela diferenciação destas expressões.
Calcula-se a Hessiana \(D^2 F(K,L)\) como:
\begin{equation*}
\frac{\partial^2 F}{\partial K^2} = \alpha (\alpha - 1) A K^{\alpha-2} L^{1-\alpha},
\quad
\frac{\partial^2 F}{\partial L^2} = -\alpha (1-\alpha) A K^{\alpha} L^{-\alpha-1},
\end{equation*}
\begin{equation*}
\frac{\partial^2 F}{\partial K \partial L} = \alpha (1-\alpha) A K^{\alpha-1} L^{-\alpha},
\quad
\frac{\partial^2 F}{\partial L \partial K} = \alpha (1-\alpha) A K^{\alpha-1} L^{-\alpha}.
\end{equation*}
A igualdade das derivadas mistas é imediatamente verificada, o que confirma a simetria da Hessiana.
Portanto,
\begin{equation*}
D^2 F(K,L) = A K^{\alpha-2} L^{-\alpha-1}
\begin{pmatrix}
\alpha(\alpha-1) L^2 & \alpha(1-\alpha) K L \\
\alpha(1-\alpha) K L & -\alpha(1-\alpha) K^2
\end{pmatrix}.
\end{equation*}

A interpretação econômica de cada elemento da Hessiana ilumina as hipóteses subjacentes à tecnologia de produção.
As derivadas segundas puras são negativas para todos os valores de \(K, L > 0\), dado que \(\alpha (\alpha - 1) < 0\) e \(-\alpha (1-\alpha) < 0\).
Esta negatividade formaliza o princípio dos rendimentos marginais decrescentes para cada fator, mantendo o outro constante.
Esta hipótese implica que cada unidade adicional de um insumo gera um acréscimo menor na produção, mantidos os demais fatores constantes.


O sinal da derivada mista também é crucial para classificar a relação técnica entre os fatores.
Na função Cobb-Douglas, a derivada mista \(\partial^2 F / \partial K \partial L\) é estritamente positiva.
Economicamente, isso significa que o produto marginal do capital, \(F_K\), é uma função crescente da quantidade de trabalho \(L\).
Simetricamente, o produto marginal do trabalho, \(F_L\), é uma função crescente da quantidade de capital \(K\).
Esta é a definição analítica de complementaridade local entre os fatores de produção.
Um aumento na dotação de um insumo eleva a produtividade marginal do outro.
A Cobb-Douglas, portanto, descreve uma tecnologia em que capital e trabalho são complementares na margem.

Uma das relações mais importantes da Hessiana com a teoria econômica ocorre nos problemas de otimização.
A condição de primeira ordem (gradiente nulo) identifica pontos candidatos a extremos.
É a condição de segunda ordem que discrimina sua natureza, e esta condição é inteiramente governada pela matriz Hessiana no ponto crítico.
Se a Hessiana for positiva definida, a forma quadrática associada é positiva em todas as direções, indicando curvatura convexa local e caracterizando um mínimo local.
Se for negativa definida, a curvatura é côncava e o ponto é um máximo local.
Se a matriz for indefinida, o ponto é uma sela.
Em termos globais, a concavidade (convexidade) da função objetivo, verificada pela semidefinição negativa (positiva) da Hessiana em todo o domínio, garante que qualquer ponto crítico é um máximo (mínimo) global.
Em economia, funções objetivo côncavas, associadas a Hessianas negativas semidefinidas, são particularmente importantes por simplificarem a análise de modelos de otimização.

Em síntese, a análise de derivadas de ordem superior constitui um avanço necessário para além da análise marginal de primeira ordem ao capturar a curvatura e as interações de uma função multivariada.
Sua aplicação requer a introdução das classes de funções \(C^1\) e \(C^2\), que exigem a continuidade das derivadas.
O Teorema de Schwarz, garantido por essas condições de regularidade, assegura a simetria da matriz Hessiana.
A Hessiana é o objeto central que reúne toda a informação sobre a curvatura de uma função escalar multivariada.
Sua aplicação a uma função de produção Cobb-Douglas explicita formalmente a hipótese de rendimentos marginais decrescentes e revela a natureza complementar dos fatores produtivos nessa tecnologia.
Por fim, a Hessiana fornece o critério definitivo de segunda ordem para a classificação dos pontos críticos em problemas de otimização.
O domínio deste instrumental é, portanto, indispensável para uma compreensão rigorosa do comportamento, local e global, das funções que fundamentam a modelagem econômica quantitativa.

* Funções implícitas

** Informações :noexport:

Materiais:
- Simon and Blume Ch 15
- Guidorizzi 12.2
- Apêndice matemático Petri

Temas:
- Teorema da Função Implícita
- Aplicações em estática comparativa

** Temas discutidos :noexport:
:PROPERTIES:
:ID:       a48632db-b353-4cfd-8936-a8f1ade16462
:END:

- Contextualização ao tema:
  - Em problemas econômicos, nem sempre é possível que as variáveis endógenas e exógenas estejam separadas
    - \(G(x_{1}, \ldots, x_{n}, y) = 0\); neste caso, \(y\) é uma função implícita das demais variáveis
    - Mesmo não sendo possível separar as variáveis endógenas das exógenas, as principais questões ecômicas continuam existindo: Como a mudança de uma variável exógena afeta a variável endógena? [Não incluir na resposta na forma de pergunta retórica]
    - Também pode ser o caso em que trabalhar com a equação na forma explícita seja mais difícil do que utilizá-la na forma implícita
  - Situação-problema: Considerar uma função de lucro em termos do nível nominal de produção (\(p\cdot f(x)\)) e custo variável (\(w\cdot x\))
    - Neste exemplo, preço e salário são variáveis exógenas
    - Como a firma é racional, ela escolherá o nível de produção \(x\) que satisfaça a condição de primeira ordem
    - Não existe nenhuma razão para que a firma se restrinja para funções de produção que possam ser expressas de forma explícita
    - Por esta razão, trabalha-se com a função de produção como uma função implícita de \(p\) e \(w\)
- Introdução do instrumento:
  - Diz-se que uma função \(F(x,y)\) define \(y\) implicitamente em termos de \(x\) quando \(F(x, g(x)) = 0\)
    - Em seguida, toma-se a derivada em função de \(x\) em ambos os termos da equação
      - Aplica-se a regra da cadeia em cada termo
  - O mesmo pode ser dito se \(F(h(y), y) = 0\)
  - A regra da cadeia pode ser utilizada para expressar uma relação explícita entre duas variáveis que definem implicitamente uma outra função \(F(x,y) = 0\)
    - \(F(x, f(x)) = 0\)
    - Para aplicar, \(F\) precisa ser diferenciável
      - \(\frac{\partial F}{\partial x}\frac{dx}{dx} + \frac{\partial F}{\partial y}\frac{dy}{dx} = 0\)
      - \(\frac{\partial F}{\partial x} + \frac{\partial F}{\partial y}\frac{dy}{dx} = 0\)
      - \(\frac{dy}{dx} = - \frac{\frac{\partial F}{\partial x}}{\frac\frac{\partial F}{\partial y}}\)
      - \(\frac{\partial F}{\partial y} \neq 0\)
      - \(\frac{dy}{dx} = - \frac{F_{x}}{F_{y}}\)
- Condições para que o Teorema da Função Implícita seja válido
  - \(F\) definida em uma bola aberta em torno de \((a,b)\);
  - \(F(a,b) = 0\)
    - Deve existir um ponto de tal modo que essa igualdade seja válida
    - As derivadas serão avaliadas em torno deste ponto
  - \(F\) é diferenciável (\(F_{x}\) e \(F_{y}\)) são diferenciáveis com \(F_{y} \neq 0\)
  - Antendidas essas condições, \(F(x,y) = 0\) define uma função implícita de \(y\) em termos de \(x\) perto do ponto \((a,b)\)
    - Basicamente, existe uma função \(y(x)\) que tanto satisfaz \(F(x,y(x)) = 0\) em determinado ponto e é também diferenciável neste ponto
  - A condição suficiente parace estar relacionada com o denominador ser diferente de zero
    - A condição da existência de \(y(x)\) que resolve \(F = 0\) e né diference de zero neste ponto é uma condição suficiente para poder expressar implicitamente \(y\) em função de \(x\)
    - De forma equivalente: \(y(x_0) = y_0\)
  - Importante ressaltar que expressar \(F(x, y) = c\) não garante que esta função admite função implícita
    - Normalmente, parte-se de um ponto que satisfassa essa igualdade e avalia as condições de pequenas variações das variáveis exógenas em termos da variável endógena definida implicitamente
- Funções implícitas de mais de duas variáveis implícitas:
  - Seja \(F(x, y, z) = 0\) diferenciável
  - Pela regra da cadeia:
    - \(\frac{\partial F}{\partial x}\frac{dx}{dx} + \frac{\partial F}{\partial y}\frac{dy}{dx} + \frac{\partial F}{\partial z}\frac{dz}{dx} = 0\)
      - \(\frac{dx}{dx} = 1\)
      - \(\frac{dy}{dx} = 0\)
    - \(\frac{\partial z}{\partial x} = - \frac{F_{x}}{F_{z}}\)
    - \(\frac{\partial z}{\partial y} = - \frac{F_{y}}{F_{z}}\)
    - Anteção para a notação com \(\partial\)
  - De forma equivalente, \(F(x, y, g(x,y)) = 0\)
  - Alternativa: Funções implícitas de mais variáveis exógenas:
    - Neste caso, \(F(\vec{x}, y) = 0\)
      - Sendo assim, para avaliar o efeito de um \(x_{i}\) qualquer, parta utilizar o teorema da função implícita com os demais termos mantidos constantes
- Interpretação geométrica do teorema da função implícita:
  - Uma vez que os pontos satisfazem \(F(x,y) = c\), isto é, pertencem a determinada curva de nível, esta função \(F\) pode ser considerada implicitamente como o gráfico de uma variável \(y = f(x)\) na vizinhança do ponto
    - A derivada dessa função (\(y'(x)\)) indica a inclinação da reta tangente neste ponto
  - Caso a derivada de \(F(x,y)\) em termos de \(y\) (denominador) seja zero, mas a do numerador não; então tem-se \(x = x(y)\)
    - Nesse caso particular, a reta tangente à curva de nível é paralela ao eixo \(y\)
  - O pontos cuja a derivada parcial é não-nula são chamados de pontos regulares em \(C^{1}\)
    - Se todos os pontos são regulares, então a curva de nível é uma curva regular (/manifold/ univariado)
      - Sendo esses os casos, cada variável pode ser implicitamente expressa em termos das demais
      - Neste caso, é uma função bem comportada e implica que a função possui uma reta tangente
      - Para o caso de várias variáveis, chama-se de superfície regular em que o /manifold/ é \(n-1\)-variado
- Relação entre o teorema da função implícita e gradiente:
  - Memo: gradiente sempre aponta para a direção de maior variação
  - Memo: gradiente é perpendicular à curva de nível
    - Melhor dizendo, é perpendicular a reta tangente ao conto pertencente à curva de nível
  - Para estabelecer esta relação, é preciso garantir que a função tenha uma reta tangente
    - O Teorema da Função Implícita fornece a informação de que basta que um ponto (\(x_{0}, y_{0}\)) seja um ponto regular
    - Se este ponto for regular, então o gradiente será perpendicular a reta tangente neste ponto
    - A prova envolve mostrar que o vetor gradiente é não-nulo
      - Isso é consequência direta das derivadas parciais não serem nulas neste ponto
    - A derivada calculada por meio do Teorema da Função Implícita computa a inclinação da reta tangete neste ponto
      - O vetor comporto por (1, derivada do Teorema da Função Implícita) é perpendicular ao vetor gradiante
        - O produto escalar do gradiente e deste vetor é zero
    - A interpretação geométrica fornece a intuição de que a função implícita pode ser escrita se a curva não é vertical neste ponto
- Relação entre plano tangente e direrenciais:
  - Recaptulando, a derivada calculada pelo Teorema da Função Implícita fornece a inclinação da curva de nível no ponto que é avaliada
  - Utilizando a aprocimação por diferenciais, é possível encontrar o plano tangente a este ponto
    - Para isso, basta encontrar a combinação linear dos diferenciais que não altera a curva de nível em questão:
      - \(\frac{\partial F}{\partial x}(x_{0}, y_{0}) \Delta x + \frac{\partial F}{\partial y} (x_{0}, y_{0}) \Delta y = 0\)
      - Em seguida, resolve-se para \(\Delta y/\Delta x\)
  - Seja \(v\) o vetor que aponta para a não manter a mesma curva de nível, então o produto escalar entre este vetor e o vetor gradiente é zero
    - Este vetor aponta para direção paralela a reta tangente no ponto desta função
    - Este vetor é o espaço nulo neste ponto (/nullspace/)
  - O mesmo raciocínio pode ser aplicado para mais dimensões
    - A superfície de nível de uma função \(F(\vec{x})\) pode ser considerado um gráfico da função \(x_{i}\) em termos das demais variáveis ao redor de determinado ponto
    - Tal como antes, o vetor gradiente é perpendicular ao hiperplano tangete desta superfície de nível
    - Generalização:
      - Seja uma função escalar de \(n\) variáveis e um ponto a ser avaliado, dado ao menos um ponto regular
        - Então a função neste ponto apresenta a superfície de nível e ela pode ser considerada como uma função de \((n-1)\) variáveis na vizinhança deste ponto
        - O vetor gradiente avaliado neste ponto é perpendicular a hiperplano tangente neste mesmo ponto
        - Um vetor \(\vec{v}\) é tangente à curva de nível neste ponto se, e somente se, é um espaço nulo; implica que o produto escalar entre \(\vec{v}\) e o vetor gradiente resulta no vetor nulo
- Sistemas de funções implícitas [Não consta no edital]:
  - Para o caso em que \(F(x, y(x), z(x) = 0\) e \(G(x, y(x), z(x))\); para obter as derivadas parciais em termos de \(x\)
    - É preciso montar um sistema de equações a partir da regra da cadeia
    - Em seguida utiliza-se a regra de Cramer (ou qualquer outra forma de resolução) para obter a relação funcional de \(dy/dx\) e \(dz/dx\)
      - Isso porque quando ambos as funções são iguais a zero, elas se interseccionam
      - Nota-se que o sinal negativo é preservado
      - A notação é a partir do determinante jacobiano: \(\frac{\partial (F, G)}{\partial (y, z)}\) para denotar a matriz
  - Generalizando:
    - \(\frac{dy}{dx} = - \frac{\frac{\partial (F, G)}{\partial (x, z)}}{\frac{\partial (F,G)}{\partial (y,z)}}\)
      - Mnemônica: troca-se apenas o numerador, alternando apenas a variável de interesse por x
    - Também é possível simplemente resolver o sistema de forma direta
  - Recaptulação para sistemas lineares:
    - Para que o sistema admita uma solução única:
      - O número de equações seja igual ao número de variáveis endógenas E
      - A matrix dos coeficientes  associados às variáveis endógenas seja não-singular
        - Se esse for o caso, é possível inverter a matriz e calcular as variáveis endógenas em termos das variáveis exógenas de forma explícita
    - O número de variáveis exógena passa a ser determinado residualmente
    - As variáveis exógenas são tratadas de forma similar à constantes (RHS)
    - Importante notar que o particionamento entre variáveis endógenas e exógenas pode não ter solução
  - Sistemas não-lineares:
    - Nestes casos, aplica-se o paradigma do cálculo:
      - lineariza o sistema por meio das derivadas,
      - aplica o teorema linear neste sistema linearizado
      - mapeia os resultados de volta para o sistema não-linear
    - Sejam as variáveis endógenas denotadas por \(\vec{y}\) e as exógenas por \(\vec{x}\)
      - O número de variáveis endógenas deve ser o mesmo que o número de equações independentes (\(m\))
      - Lineariza-se o sistema em torno de um ponto \((\vec{y}^{\star}, \vec{x}^{\star})\)
        - Esta linearização é dada pelo somatório das derivadas parciais multiplicada pela variação (aproximação por diferenciais), avaliadas no ponto em questão
      - O Teorema da Função Implícita permite resolver o sistema ao computar os diferenciais das variáveis endógenas em termos das variáveis exógenas
        - A existência da solução requer que a matriz das derivadas parciais em termos das variáveis endógenas (matriz de coeficientes) seja não-singular
          - Dado que este é um sistema linearizado, é possível inverter a matriz dos coeficientes e obter o valor dos diferenciais das variáveis endógenas em termos de variações das variáveis exógenas
      - Decorrência desta solução é que o sistema não-linear pode ser expresso como um sistema de funções implícitas, ao menos na vizinhança do ponto analizado
      - Também decorrência do resultado anterior, é possível computar as derivadas das equações endógenas em termos de uma variável exógena específica (\(x_{h}\))
        - Para fazer isso, basta atribuir zero para todos os outros \(dx_{s}\) que não \(d_{h}\) e resolver o sistema em termos dos \(dy_{s}\)
          - Alternativamente, pode-se aplicar a regra de Crammer
    - Generalização:
      - Seja um sistema de funções \(C^{1}\)
      - Considere a possibilidade de que \(\vec{y}\) possam ser funções implícitas de \(\vec{x}\)
      - Suponha que exista um ponto que seja solução do sistema
      - Se o determinante da matriz dos coeficientes for não-singular avaliada neste mesmo ponto
      - Então, existem funções \(C^{1}\) que podem ser expressas implicitamente por essas variáveis exógenas definidas em uma bola em torno de \(\vec{x}^{\star}\), de modo que:
        - \(F_{k}(f_1(x), \ldots, f_m(x), x_1, \ldots, x_n) = c_k\) de \(1, \ldots, k, \ldots, m\) para todo \(\vec{x}\) nesta bola
          - Cada função avaliada neste ponto em termos das variáveis exógenas terá o valor esperado
      - Consequência do resultado anterior é que é possível calcular as derivadas parciais em termos de uma variável exógena específica ao tornar todas os demais diferenciais iguais a zero e resolver o sistema em termos dos diferenciais das variáveis endógenas
- Aplicações em economia:
  - Apresentar a TMS a partir de uma função de produção para trazer a intuição da utilização do Teorema da Função Implícita
  - O Teorema da Função Implícita pode ser utilizado para calcular a inclinação de curvas de indiferenças em determinados pontos ou de uma isoquanta em uma função de produção
    - Lembrando que mostra a movimentação na direção que se mantem na mesma curva
    - No caso de uma função de produção, mede-se a taxa marginal de substituição técnica
      - Mede o quanto de um produto deve ser produzido para compensar a perda de uma unidade do outro insumo enquanto o nível de produção é mantido constante
  - Uma aplicação de sistemas de funções implícitas é dado pelo modelo IS-LM [Não incluir este exemplo pois não consta no edital]
    - Consumo, investimento, e quantidade de moeda dependem da renda;
- Aplicações em estática comparativa:
  - O exemplo utilizado é em um modelo de equilíbrio geral de trocas puras
    - Dois consumidores (A e B) com dois bens (x e y)
    - De forma simples, consumidor \(A\) possui apenas o bem \(x\) \(e_{A} = (x,0)\); consumidor \(B\) tem apenas o bem \(y\), \(e_{B} = (0, y)\)
    - Considere funções utilidade Cobb-Douglas para ambos
      - Talvez simplificaria e diferenciaria do livro-texto se utilizar ao mesmo uma função quase-linear
    - Considere os preços \(p_{x}\) e \(p_{y}\)
    - Suponha que o consumidor queira consumir outra cesta que maximize a utilidade dada a restrição orçamentária
    - Memo: em equilíbrio, as taxas marginais de substituição (avaliação interna do consumidor) deve ser igual aos preços relativos (dado pelo mercado, expressando escassez relativa)
    - Dado que é uma economia de trocas puras, demanda em cada mercado deve ser igual à dotação (física)
    - Organizando esse modelo em termos de um sistema, obtém-se seis variáveis e seis equações
      - Defini-se um numerário
      - Uma equação pode ser expressa em termos das demais (não é independente)
      - Resulta-se em um sistema com 5 equações e 5 variáveis
    - Definindo um valor inicial para a dotação, o sistema possui solução única
    - Objetivo: mostrar o que acontece com as cestas se os consumidores possuirem outras dotações
      - Mantendo a dotação do consumidor \(A\), qual seria o efeitos sobre alocação e preços relativos se a alocação do consumidor \(B\) fosse alterada marginamente
      - Para isso, lineariza-se o sistema
      - De acordo com o Teorema da Função Implícita, se este sistema linearizado pode ser resolvido em termos dos diferenciais, então é possível calcular as derivadas parciais das variáveis endógenas em termos das variáveis exógenas, neste caso, as dotações
      - Em seguida, o sistema é rearrumado em termos de expressões de aversão relativa ao risco
      - Depois, o sistema é resolvido por Cramer
      - Em seguida, computa-se as derivadas parciais em termos da dotação que variou
    - Conclusões para o exemplo específico do livro-texto:
      - O aumento da dotação de um dos consumidores que, particularmente, significa aumentar a disponibilidade unicamente de um dos bens aumenta o preço relativo do outro bem
        - Basicamente, o bem cuja dotação foi mantida constante, tornou-se relativamente mais escasso na margem
      - Levou-se a um aumento do consumo do bem y pelo consumidor \(A\)
    - OBS: Ajustar notação para incluir superescritos
- Outros temas:
  - Uma vez computada a relação implícita entre as variáveis, algumas expressões permitem apresentar a forma explícita entre elas
    - Em alguns casos requer alguns algebrismos
  - Em algumas situações, a função implícita de outra função não terá significado (isto é, \(dy/dx\) depende de \(y\))
    - O Teorema da função implícita garante que este não será o caso
  - Exemplos em que o Teorema da Função Implícita não se aplica
    - Formas fechadas (como é o caso do círculo unitário)
      - Em torno do limite de \(y = 0\), a derivada em relação a \(x\) seria vertical, tentendo ao infinito
    - As derivadas parciais avaliadas em pontos que tornam a função nula geram um denominador nulo
      - Devem existir valores dos argumentos que tornam \(F(x_0, y_0, z_0) = 0\) em que a derivada do denominador avaliada em \((x_0, y_0, z_0)\) seja diferente de zero
  - Uma vez encontrada a derivada implícita, é possível utilizar a proximação por diferenciais para calcular o efeito sob a variável endógena:
    - \(y_1 \approx y_0 + \frac{dy}{dx}(x_0)\Delta x\)
  - Seria bom apresentar a relação entre plano tangente, aproximação por diferenciais e teorema da função implícita
- Teorema da função inversa (opcional) [Não incluir na resposta]

** Rascunho :noexport:

Mais profundamente, este instrumental é a pedra angular do teorema da função implícita, ferramenta indispensável para a estática comparativa. Considere uma relação definida implicitamente por \(F(x, y) = 0\). Sob condições adequadas (principalmente \(F_y \neq 0\)), o teorema garante a existência local de uma função \(y = \phi(x)\) satisfazendo \(F(x, \phi(x)) = 0\). Para encontrar a derivada \(\phi'(x)\), aplica-se a regra da cadeia ao longo da curva \(x \mapsto (x, \phi(x))\), que reside no conjunto de nível zero de \(F\). Diferenciando a identidade \(F(x, \phi(x)) = 0\), obtém-se
\[
\frac{d}{dx} F(x, \phi(x)) = F_x(x, \phi(x)) + F_y(x, \phi(x)) \cdot \phi'(x) = 0,
\]
e, portanto,
\[
\phi'(x) = - \frac{F_x(x, \phi(x))}{F_y(x, \phi(x))}.
\]

Este resultado, derivado diretamente da regra da cadeia, generaliza-se para sistemas de equações e fornece o método para analisar como variáveis endógenas de equilíbrio respondem a choques exógenos em uma vasta gama de contextos, desde a derivação de curvas de oferta e demanda em microeconomia até o cálculo de multiplicadores em modelos macroeconômicos IS-LM ou de crescimento.

** Resposta 07 :ignore:


Muitos problemas econômicos definem relações entre variáveis endógenas e exógenas por meio de equações implícitas, nas quais a separação analítica entre essas categorias não é possível.
Esta situação é típica em condições de equilíbrio, em que as variáveis endógenas são determinadas como soluções de um conjunto de restrições comportamentais, tecnológicas e de mercado.
O Teorema da Função Implícita garante a existência, a unicidade local e a diferenciabilidade, permitindo expressar, localmente,  um subconjunto de variáveis como funções diferenciáveis de outras.
A capacidade de calcular as derivadas dessas funções implícitas constitui o núcleo operacional da análise de estática comparativa. Essa análise investiga sistematicamente como alterações em parâmetros ou variáveis exógenas afetam a posição de equilíbrio de um sistema econômico.
No contexto específico de um modelo de equilíbrio geral, o Teorema da Função Implícita permite avaliar como pequenas variações nas dotações exógenas geram respostas diferenciáveis nas variáveis endógenas.

A análise está dividida em três partes principais.
Inicialmente, apresenta-se a formulação geral do Teorema da Função Implícita (TFI), fornecendo a base para o restante da análise.
Em seguida, para aprofundar a compreensão, discute-se a interpretação geométrica do teorema, relacionando-o aos conceitos de superfícies de nível, gradientes e taxas marginais de substituição, o que fornece a intuição necessária à sua aplicação em economia.
Posteriormente, a análise é estendida para sistemas multivariados. Nessa etapa, enfatiza-se a condição de invertibilidade local do sistema, fundamentada na não-singularidade da matriz Jacobiana associada às variáveis endógenas, o que mostra a transição do caso univariado ao geral.
Por fim, aplica-se o aparato teórico a um exemplo numérico simplificado que representa um modelo de equilíbrio geral de trocas puras.
A partir deste exemplo, realiza-se uma análise de estática comparativa, derivando o efeito de uma variação marginal na dotação inicial sobre o preço relativo de equilíbrio e a alocação final dos bens.
Neste texto, vetores são representados por uma seta sobrescrita, como em \(\vec{x}\), para distingui-los de escalares.


Para formalizar matematicamente a intuição do Teorema da Função Implícita, parte-se de uma função escalar \(F: U \subset \mathbb{R}^{2} \to \mathbb{R}\) de classe \(C^{1}\) em um conjunto aberto \(U\).
A equação \(F(x, y) = 0\) define uma relação implícita entre as variáveis \(x\) e \(y\).
Suponha que exista um ponto \((x_0, y_0) \in U\) tal que \(F(x_0, y_0) = 0\).
O Teorema da Função Implícita estabelece que, se a derivada parcial de \(F\) em relação a \(y\) for não nula nesse ponto, isto é, se \(F_y(x_0, y_0) \neq 0\), então existem vizinhanças abertas \(V\) de \(x_0\) e \(W\) de \(y_0\) e uma função única \(\phi: V \to W\) de classe \(C^{1}\) tal que \(\phi(x_0) = y_0\) e \(F(x, \phi(x)) = 0\) para todo \(x \in V\).
A diferenciabilidade de \(\phi\) permite calcular sua derivada.
Diferenciando totalmente a identidade \(F(x, \phi(x)) = 0\) em relação a \(x\) e aplicando a regra da cadeia, obtém-se
\[F_x(x, \phi(x)) + F_y(x, \phi(x)) \phi'(x) = 0.\]
Portanto, a derivada da função implícita é dada por
\[\phi'(x) = \frac{dy}{dx} = -\frac{F_x(x, y)}{F_y(x, y)}, \]
avaliada no ponto \((x_0, y_0)\).
A condição \(F_y \neq 0\) é essencial para garantir que o denominador não se anule, assegurando que a curva de nível \(F(x,y)=0\) não possui uma tangente vertical no ponto, permitindo que \(y\) seja expresso como uma função diferenciável de \(x\) localmente.

A interpretação geométrica deste resultado liga-se diretamente ao gradiente de \(F\).
A equação \(F(x, y) = 0\) define uma curva de nível no plano.
O vetor gradiente \(\nabla F(x_0, y_0) = (F_x, F_y)\) é normal à curva de nível no ponto \((x_0, y_0)\).
O vetor tangente à curva tem componentes \((1, dy/dx)\), e a condição de ortogonalidade \(\nabla F \cdot (1, dy/dx) = 0\) recupera exatamente a fórmula \(dy/dx = -F_x/F_y\).
A não-nulidade de \(F_{y}\) permite resolver localmente para \(dy\) em termos de \(dx\), produzindo exatamente a inclinação local dada pelo teorema.
Em economia, esta relação fundamenta o cálculo das taxas marginais de substituição técnica.
Por exemplo, para uma função de produção definida por \(Y(K,L) = \bar{Y}\), a taxa marginal de substituição técnica é \(dL/dK = -(\partial Y/\partial K)/(\partial Y/\partial L)\), desde que \(\partial Y/\partial L \neq 0\).


A generalização para uma única equação com \(n+1\) variáveis é direta.
Seja \(F: U \subset \mathbb{R}^{n+1} \to \mathbb{R}\) de classe \(C^{1}\) e \(\vec{x} = (x_1, \dots, x_n)^\top\).
A equação \(F(\vec{x}, y) = 0\) define \(y\) implicitamente em função de \(\vec{x}\) nas proximidades de um ponto \((\vec{x}_0, y_0)\) que satisfaz a equação, desde que \(F_y(\vec{x}_0, y_0) \neq 0\).
Neste caso, existem vizinhanças abertas \(V\) de \(\vec{x}_0\) e \(W\) de \(y_0\), e uma função \(y = \phi(\vec{x})\) de classe \(C^{1}\) de \(V\) em \(W\), cujas derivadas parciais são dadas por
\[\frac{\partial y}{\partial x_i} = -\frac{F_{x_i}(\vec{x}, y)}{F_y(\vec{x}, y)}, \quad i = 1, \dots, n.\]


A extensão mais relevante para a modelagem econômica é a dos sistemas de equações.
Considere agora um sistema de \(m\) equações definido por uma função \(F: U \subset \mathbb{R}^{n} \times \mathbb{R}^{m} \to \mathbb{R}^{m}\) de classe \(C^{1}\) em um aberto \(U\).
O sistema é dado por \(F(\vec{x}, \vec{y}) = \vec{0}\), onde \(\vec{x} = (x_1, \dots, x_n)^\top\) denota o vetor de variáveis exógenas e \(\vec{y} = (y_1, \dots, y_m)^\top\) o vetor de variáveis endógenas.
Assume-se a existência de um ponto \((\vec{x}_0, \vec{y}_0) \in U\) tal que \(F(\vec{x}_0, \vec{y}_0) = \vec{0}\).
A condição análoga à \(F_y \neq 0\), e que é necessária e suficiente para a aplicação do TFI localmente, envolve a matriz Jacobiana de \(F\) em relação às variáveis endógenas, avaliada nesse ponto.
Esta matriz, que contém as derivadas parciais das \(m\) equações em relação às \(m\) variáveis endógenas, é dada por
\[
J_{\vec{y}}F(\vec{x}_0, \vec{y}_0) = \left[ \frac{\partial F_i}{\partial y_j}(\vec{x}_0, \vec{y}_0) \right]_{m \times m}
\]
Se esta matriz for não-singular, ou seja, se \(\det(J_{\vec{y}}F(\vec{x}_0, \vec{y}_0)) \neq 0\), então existe uma função única \(\vec{\phi}\), definida e de classe \(C^{1}\) em torno de \(\vec{x}_0\), tal que \(\vec{\phi}(\vec{x}_0) = \vec{y}_0\) e \(F(\vec{x}, \vec{\phi}(\vec{x})) = \vec{0}\) para todo \(\vec{x}\) suficientemente próximo de \(\vec{x}_0\).
A diferenciabilidade da função implícita \(\vec{\phi}\) permite calcular suas derivadas parciais.

A derivada total da identidade \(F(\vec{x}, \vec{\phi}(\vec{x})) = \vec{0}\) fornece a relação fundamental para estática comparativa:
\[
\frac{\partial F}{\partial \vec{x}} d\vec{x} + \frac{\partial F}{\partial \vec{y}} d\vec{y} = \vec{0},
\]
onde as matrizes Jacobianas \(\frac{\partial F}{\partial \vec{x}}\) (de ordem \(m \times n\)) e \(\frac{\partial F}{\partial \vec{y}}\) (de ordem \(m \times m\)) são avaliadas no ponto de equilíbrio.
Sob a condição de não-singularidade de \(\frac{\partial F}{\partial \vec{y}}\), pode-se resolver para o diferencial das variáveis endógenas:
\[
d\vec{y} = - \left[ \frac{\partial F}{\partial \vec{y}} \right]^{-1} \cdot \frac{\partial F}{\partial \vec{x}} \, d\vec{x}.
\]
Esta expressão matricial encapsula todos os efeitos de estática comparativa.
O impacto marginal da variável exógena \(x_k\) sobre a variável endógena \(y_j\) é dado pelo elemento \((j,k)\) da matriz
\[- \left[ \frac{\partial F}{\partial \vec{y}} \right]^{-1} \frac{\partial F}{\partial \vec{x}}\]
A condição de não-singularidade da Jacobiana endógena é a generalização multidimensional da exigência de que o sistema possa ser resolvido localmente em termos de \(\vec{x}\) para as variáveis \(\vec{y}\).

Para concretizar esses conceitos, aplica-se o TFI a um modelo de equilíbrio geral de trocas puras com dois bens, \(X\) e \(Y\), e dois consumidores, \(A\) e \(B\).
Embora o sistema completo de equilíbrio envolva múltiplas equações para as condições de otimalidade e de mercado, foca-se, primeiramente, na equação reduzida do preço de equilíbrio $p$, obtida por substituir as demandas marshallianas.
Esta abordagem é matematicamente e localmente equivalente, sob as hipóteses do TFI, ao tratamento do sistema completo $F(\vec{x}, \vec{y}) = \vec{0}$, pois a regularidade da Jacobiana endógena garante que a solução reduzida conserve as propriedades diferenciáveis previstas pelo teorema.
Feita esta ressalva, as dotações iniciais são \(\vec{e}^A = (e_X^A, 0)\) e \(\vec{e}^B = (0, e_Y^B)\), com \(e_X^A, e_Y^B > 0\).
As preferências são representadas por funções de utilidade Cobb-Douglas \(u^A(x_A, y_A) = x_A^{\alpha} y_A^{1-\alpha}\) e \(u^B(x_B, y_B) = x_B^{\beta} y_B^{1-\beta}\), com \(0 < \alpha, \beta < 1\).
Toma-se o bem \(Y\) como numerário, definindo o preço relativo \(p = p_X / p_Y = p_X\).
Neste contexto,  as variáveis endógenas são o preço relativo \(p = p_X\) e as cestas finais de cada agente.
A restrição orçamentária de cada consumidor \(i\) é \(p e_X^{i} + e_Y^{i}\).

A maximização da utilidade sob a restrição orçamentária, calculada utilizando o método dos multiplicadores de Lagrange, fornece as funções demanda:
\[x_A^d = \alpha \frac{p\cdot e_X^A}{p}, \quad y_A^d = (1-\alpha) p e_X^A; \quad x_B^d = \frac{\beta e_Y^B}{p}, \quad y_B^d = (1-\beta) e_Y^B. \]
A condição de equilíbrio de mercado para o bem \(X\) é \(x_A^d + x_B^d = e_X^A\), que, após substituição, resulta em:
\[\alpha e_X^A + \frac{\beta e_Y^B}{p} = e_X^A \]
Esta equação define implicitamente o preço de equilíbrio \(p\) em função das dotações exógenas \(e_X^A\) e \(e_Y^B\).
Pode-se escrevê-la como:
\[F(e_X^A, e_Y^B, p) \equiv \alpha e_X^A + \frac{\beta e_Y^B}{p} - e_X^A = 0\]
A função \(F\) é de classe \(C^1\) para \(p > 0\).
Suas derivadas parciais são
\[ \frac{\partial F}{\partial p} = -\frac{\beta e_Y^B}{p^2}\]
\[\frac{\partial F}{\partial e_Y^B} = \frac{\beta}{p}\]
No ponto de equilíbrio, \(\frac{\partial F}{\partial p} \neq 0\).
Portanto, o TFI assegura que \(p\) é uma função diferenciável de \(e_Y^B\) numa vizinhança do equilíbrio, com derivada:
\[
\frac{\partial p}{\partial e_Y^B} = -\frac{\frac{\partial F}{\partial e_Y^B}}{\frac{\partial F}{\partial p}} = -\frac{\frac{\beta}{p}}{-\frac{\beta e_Y^B}{p^2}} = \frac{p}{e_Y^B} > 0.
\]
O sinal positivo indica que um aumento na dotação total do bem \(Y\) eleva o preço relativo do bem \(X\).
A intuição econômica é que um maior \(e_Y^B\) aumenta a renda do consumidor \(B\), que demanda o bem \(X\).
Para restaurar o equilíbrio no mercado do bem \(X\), cuja oferta total \(e_X^A\) é fixa, o preço relativo de \(X\) deve aumentar para conter a demanda.

O mesmo tipo de análise pode ser estendido ao caso em que aumenta-se marginalmente a dotação inicial do bem $X$ associado ao consumidor $A$.
Pela definição de $F(e_X^A, e_Y^B, p) = \alpha e_X^A + \frac{\beta e_Y^B}{p} - e_X^A = 0$, temos
\[
\frac{\partial F}{\partial e_X^A} = \alpha - 1 = -(1-\alpha).
\]
Aplicando o teorema da função implícita,
\[
\frac{\partial p}{\partial e_X^A} = -\frac{\frac{\partial F}{\partial e_X^A}}{\frac{\partial F}{\partial p}} = -\frac{-(1-\alpha)}{-\frac{\beta e_Y^B}{p^2}} = -\frac{(1-\alpha) p^2}{\beta e_Y^B}.
\]
Dado que $(1-\alpha) > 0$, $p^2 > 0$, $\beta > 0$, e $e_Y^B > 0$, o sinal desta derivada é estritamente negativo:
\[
\frac{\partial p}{\partial e_X^A} = -\frac{(1-\alpha) p^2}{\beta e_Y^B} < 0.
\]
O sinal negativo indica que um aumento na dotação inicial do bem \(X\) (\(e_X^A\)) reduz o seu preço relativo \(p = p_X/p_Y\).
A intuição econômica está diretamente associada à escassez relativa dos bens.
Um aumento na oferta total do bem \(X\), mantida constante a dotação do bem \(Y\), torna o bem \(X\) relativamente mais abundante, pressionando seu preço relativo para baixo.

De outro modo, as hipóteses simplificadoras aqui adotadas fazem com que a função do preço de equilíbrio admita uma função explícita
\[p = \frac{\beta e_Y^B}{(1-\alpha) e_X^A}.\]
Sendo assim, é possível contrastar os resultados obtidos anteriormente
\[\frac{\partial p}{\partial e_X^A} = -\frac{\beta e_Y^B}{(1-\alpha) (e_X^A)^2} < 0.\]
Tal como antes, a sensibilidade dos preços relativos a um incremento na oferta do bem \(X\) é estritamente negativa.
Para coincidir com o resultado do teorema da função implícita, basta substituir a relação do preço relativo de equilíbrio no numerador e no denominador da expressão anterior.
A mesma equivalência de resultados pode ser obtida em função da dotação do bem \(Y\)
\[\frac{\partial p}{\partial e_Y^B} = \frac{\beta}{(1-\alpha) e_X^A} > 0.\]


Vale destacar que é possível sofisticar esta análise, formalizando esta situação-problema no quadro mais geral do Teorema da Função Implícita para sistemas
Como já mencionado, as variáveis endógenas completas são o preço relativo e as quatro equações das quantidades consumidas, ou seja, \(\vec{y} = (p, x_A, y_A, x_B, y_B)\).
O equilíbrio é descrito por um sistema de cinco equações, agrupando as condições de primeira ordem para as funções de utilidade, duas restrições orçamentárias e o equilíbrio dos mercados.
A segunda condição de equilíbrio de mercado torna-se redundante por força da Lei de Walras e, como consequência, pode ser desconsiderada uma vez que não é linearmente independente das demais equações.
Este sistema define uma função implícita \(F(\vec{x}, \vec{y}) = \vec{0}\), em que \(\vec{x} = (e_X^A, e_Y^B)\) e \(\vec{y} = (p, x_A, y_A, x_B, y_B)\).
A aplicação do TFI requer verificar que a matriz Jacobiana das derivadas de \(F\) em relação a \(\vec{y}\), que captura a estabilidade local, não seja singular no equilíbrio.
Excetuando-se das soluções de canto, como é o caso deste exemplo, esta condição é tipicamente satisfeita.
Uma vez verificado, o teorema garante a existência local de funções de equilíbrio diferenciáveis \(\vec{\phi}(e_X^A, e_Y^B)\) para todas as cinco variáveis endógenas.
A relação diferencial \(d\vec{y} = - [\partial F/\partial \vec{y}]^{-1} (\partial F/\partial \vec{x}) d\vec{x}\) permite, então, calcular não apenas \(\partial p/\partial e_X^A\) e \(\partial p/\partial e_Y^B\), mas também os efeitos sobre as quantidades consumidas por cada agente.
A análise anterior, portanto, é um caso particular deste sistema mais geral, no qual a equação reduzida para \(p\) foi obtida por substituir as demais relações de equilíbrio.
Sendo assim, o exemplo numérico mais simplificado permite discutir os conceitos aqui apresentados sem perda de generalidade ou de clareza.

Ao longo desta exposição, foi demonstrado como o Teorema da Função Implícita estrutura a análise local de sistemas econômicos definidos implicitamente.
Resumidamente, o TFI é a base matemática da estática comparativa em economia.
Sua condição central, a não-singularidade da matriz Jacobiana, garante a estabilidade local do sistema.
Em outras palavras, o sistema de equações de equilíbrio deve definir localmente as variáveis endógenas de maneira única e diferenciável em função dos parâmetros exógenos.
O exemplo numérico de um modelo de equilíbrio geral de trocas puras ilustra como pequenas alterações nas dotações propagam-se às variáveis endógenas definidas implicitamente.
O domínio deste instrumental é, portanto, essencial para a modelagem e interpretação de fenômenos econômicos, sobretudo para a análise comparativa.




* Formas quadráticas e matrizes definidas

** Informações :noexport:

Materiais:
- Simon and Blume Ch 16
- Chiang 11.3
- Stewart 14.7
- Apêndice matemático Petri

Conteúdo:
- Matrizes Simétricas Definidas
- Restrições Lineares e Matrizes Orladas

** Tópicos discutidos :noexport:
:PROPERTIES:
:ID:       4774ed65-e55a-428b-aa62-6d9582ad638f
:END:
:LOGBOOK:
CLOCK: [2026-01-23 Fri 15:39]--[2026-01-23 Fri 16:04] =>  0:25
CLOCK: [2026-01-23 Fri 14:47]--[2026-01-23 Fri 15:12] =>  0:25
:END:

- Contexto:
  - Este tema abre a discussão sobre otimização
    - A otimização de uma forma quadrática é a mais simples
    - Reduz-se em estudar as propriedades matemáticas de uma matriz siméstrica
  - As condições de segunda ordem são formas quadráticas
- Formas quadráticas:
  - \(Q(\vec{x}) = \sum_{i \leq j}a_{ij}x_{i}x_{j}\)
  - \(Q(\vec{x}) = \vec{x}^{T}\cdot A\cdot\vec{x}\) como representação a partir de uma matriz simétrica \(A\)
  - Exemplo:
    - \(a_{11}x_{1}^{2} + a_{12}x_1x_2 + a_{22}x_2^2\)
    - \((x_{1} x_{2}) \begin{pmatrix} a_{11} & 0.5 a_{12} \\ 0.5 a_{12} & a_{22} \end{pmatrix} (x_{1} x_{2})^{T} \)
      - Obs: Escrevi como sendo vetor linha por ser mais rápido, mas deve ser expresso como vetor coluna
      - O mesmo vale para uma função com três variáveis
- Definição (/definiteness/) de formas quadráticas:
  - Sempre assume zero no vetor nulo
  - Suas características principais é quando o vetor de variáveis é não-nulo
  - A discussão será sobre se o ponto associado ao vetor nulo é um ponto de máximo ou de mínimo
  - Definições/classificações:
    - Se uma forma quadrática sempre assume valores positivos, é dita definida positiva
      - Em R2, tem uma forma similar a uma tigela com a abertura para cima
    - Se sempre assume valores negativos, definida negativa
      - Em R2, tem uma forma similar a uma tigela com a abertura para baixo
    - Quando pode assumir ambos os valores, é dita indefinida
      - Em R2, tem uma forma similar a uma sela
    - Caso a função possa assumir o valor zero em um ponto diferente da origem, disse-se semi-definida positiva/negativa
      - Em R2, tem uma forma similar a uma "telha invertida" sem semi-definida positiva; "telha" se semi-definida negativa
      - Exemplo: Um quadrado perfeito é sempre positivo, mas pode assumir o valor zero quando \(x_{1} = a, x_{2} = -a\)
- Matrizes simétricas definidas:
  - A classificação de uma matrix simétrica será de acordo com a definição dessa matriz em sua forma quadrática \(A\)
    - Positiva definida :: \(\vec{x}^{T}\cdot A\cdot\vec{x} > 0 \forall \vec{x} \neq 0\)
    - Positiva semi-definida :: \(\vec{x}^{T}\cdot A\cdot\vec{x} \geq 0 \forall \vec{x} \neq 0\)
    - Negativa definida :: \(\vec{x}^{T}\cdot A\cdot\vec{x} < 0 \forall \vec{x} \neq 0\)
    - Negativa semi-definida :: \(\vec{x}^{T}\cdot A\cdot\vec{x} \leq 0 \forall \vec{x} \neq 0\)
    - Indefinida :: se os sinais se alternam
- Aplicação: Condições de segunda ordem de convexidade
  - A forma de qualificar se um ponto crítico é máximo, mínimo ou ponto de sela, envolve avaliar a definição da matriz Hessiana neste ponto
  - Extendendo esta ideia para concavidade, a função é dita côncava se a matriz Hessiana é negativa semi-definida em determinada região
- Menores principais:
  - Estão associados para o teste/algorítimo de avaliar a qualificação de uma forma quadrática
  - Definição:
    - Seja uma submatriz de \(A\) da ordem de \(k\times k\) em que removem-se \(k\) linhas e colunas. Essa matriz é denominada submatriz principal de \(A\)
    - O determinante dessa matriz é denominado menor principal líder
  - Obs: Uma matriz quadrada tem \(2^{n} - 1\) menores principais
- Menores principais líderes:
  - Submatrix principal líder de \(A)\): São um caso especial de menores principais em que removem-se sempre as últimas \(k\) linhas e colunas
  - Os menores principais líderes de ordem \(k\) são os determinantes dessas submatrizes
    - Serão denominados por \(A_{k}\) e \(|A_{k}|\) respectivamente (matriz e determinante desta submatriz)
  - Uma matriz \(n\times n\) tem \(n\) menores principais líderes
  - Relação com definitude das matrizes:
    - Definida positiva :: Os sinais dos menores principais líderes são estritamente positivos
    - Definida negativa :: Os sinais dos menores principais líderes seguem o padrão \((-1)^{k}\), excluindo-se o zero
    - Indefinida :: Excluindo-se o zero, caso os menores principais líderes não se encaixem em nenhum desses padrões
    - Casos especiais :: Caso os menores principais líderes possuam zero, não necessariamente torna-se semi-definida
      - Em outras palavras, pode ser que seja indefinida
      - Sendo este o caso, é preciso avaliar o sinal de todos os menores principais (não apenas dos líderes) e identificar se encaixam em:
        - Semi-definida positiva :: Se todos os menores principais de \(A\) são não negativos
        - Semi-definida negativa :: Se os menores principais de \(A\) ímpares são negativos; se os pares são positivos
    - Exemplo para fixação: caso de uma matriz diagonal
- Restrições lineares e matrizes orladas
  - Relembrando que fazer a classificação de formas quadrátricas é o equivalente de determinar se o ponto crítico é um ponto máximo ou mínimo
    - No entanto, o algoritimo de classificação só é válido se não existirem restrições
      - Exemplo: Uma retrição pode tornar uma forma quadrática indefinida em definida
  - Contexto: tendo em vista que a maioria das aplicações econômicas envolvem algum tipo de restrição, faz sentido analisar formas quadráticas nesse contexto
  - Uma forma de resolver problemas desse tipo é substituir a restrição na forma quadrática e rearranjar
    - Isso pode envolver deixar uma variável em termos da outra
  - Uma forma mais geral é criar a matriz orlada
    - Esta matriz é a matriz dos coeficientes envolta nas restrições lineares (adicionadas às linhas e às colunas) e preenchida por zeros
    - Formalizando:
      - Seja a forma matricial dada por: \(Q(\vec{x}) = \vec{x}^{T}A\vec{x}\)
      - Em que se aplica a restrição linear \(B\), sendo uma matriz \(m\times n\) (\(B\vec{x} = 0\)), forma-se a seguinte matriz orlada \(H\):
      - \(H \begin{pmatrix} 0_{m,m} & | & B_{m,n} \\\hline B^{T}_{m,n} & | & A_{n,n} \end{pmatrix}\)
      - Neste caso, é um problema de \(n - m\) dimensões uma vez que são \(m\) equações (restrições) e \(n\) variáveis
      - Para qualificar esta matriz, checa-se os últimos \(n - m\) menores principais líderes de \(H\), incluindo o \(det(H)\)
        - Definida negativa: Se o sinal do determinante for dado por \((-1)^{n}\), e os sinais se alternam. O ponto \(\vec{x} = 0\) é um máximo global dada a restrição
        - Definida positiva: Se o sinal dos determinante e de todos os últimos menores principais líderes tem o sinal de \((-1)^{m}\), sem alternância, então trata-se de um ponto de mínimo global, dada a restrição
        - Indefinida: Se as condições anteriores são violadas por menores principais líderes não-nulos
  - Entendido o escopo geral, segui-se para a discussão com uma restrição linear
    - Vale pontuar que situações com uma restrição apenas podem ser comuns em economia (ex: soma de variáveis é zero)
    - Por se tratar de um caso específico, é possível ter uma forma particular de tratar essa situação
      - Se os \(n\) últimos principais líderes tem o mesmo sinal, é uma matriz definda positiva sob a restrição e o ponto é um mínimo restrito
      - Se os \(n\) últimos principais líderes alternam o sinal, então é uma matriz definida negativa sob a restrição e o ponto é um máximo (dada a restrição)
- Outros tópicos:
  - A caracterização da matriz \(A\) pode ser utilizada para avaliar seções cônicas
    - Dada a forma quadrátrica associada a uma curva de nível fixada
      - Positiva definida: Elipse ou círculo
      - Indefinida: Hipérbola
      - Estritamente semi-definida positiva: linhas paralelas
  - Forma é um caso específico em que todos os termos do polinômio tem o mesmo expoente (lembrando que considera-se a soma dos expoentes das variáveis)
  - Para que a classificação da matriz seja informativa para discriminar os pontos críticos como mínimos e máximos, é preciso considerar apenas os casos definidos positivo e negativo, excluindo-se os casos semi- e in-definidos
  - Outra forma de categorizar as matrizes é por meio das raízes características, encontradas a partir do autovalor (\(\lambda\)) e autovetor (\(\vec{u}\)): \(A\vec{u} = \lambda\vec{u}\)
    - Neste caso, a matriz deve ser singular (determinante deve ser nulo)
    - Encontra-se a equação característica da matriz \(A\)
      - O polinômio será de grau \(n\) na variável \(\lambda\)
      - Com a matriz \(A\) sendo simétrica, como é o caso da forma quadrática, as raízes características serão sempre valores reais
      - Memo: substituindo um autovalor \(\lambda_{i}\) permite encontrar o autovetor equivalente (um dentre infinitos, dado que o sistema é homogêneo)
        - Para encontrar o vetor, força-se uma normalização
          - Uma forma de normalização é impor que a soma das variáveis ao quadrado é um (estão no círculo unitário)
      - Encontrados os autovetores, pontua-se as seguintes propriedades
        - O produto escalar de um mesmo autovetor é a unidade (dada a normalização imposta)
        - O produto escalar de autovetores diferentes pode ser tomado como zero (são ortogonais)
        - Combinando essas propriedades, os autovetores são vetores ortonormais
      - Coletando os autovetores nas columas de uma matriz \(T\)
        - Após transformações, é possível expressas a forma quadrática em termos de \(\vec{x}\) em termos de \(\vec{y}\)
          - \(\vec{x}^{T}A\vec{x} = \vec{y}^{T}R\vec{y}\) em que \(R\) é a matriz diagonal dos autovalores
          - Resumidamente, utiliza-se o procedimento de diagonalização da matriz
            - Uma forma de ver o porquê se torna diagonal é que a multiplicação de um autovetor por ele mesmo é 1 (compondo a diagonal principal), enquanto a multiplicação cruzada é zero (elementos fora da diagonal principal sendo nulos)
        - Como consequência, reescreve-se a forma quadrática de modo que apenas termos ao quadrado aparecem
          - A condição de sinal se mantém preservada
    - Relação com o sinal da forma quadrática:
      - Definida positiva (negativa): Se todas as raízes características forem positivas (negativas)
      - Positiva (negativa) semidefinda: se todas as raízes características forem não-negativas (não-positivas)
      - Indefinida: se as raízes características tiverem sinais trocados
      - Desvantagem: encotrar as raízes características pode ser mais trabalhoso do que computar os determinantes do menores principais líderes

** Resposta :ignore:
:PROPERTIES:
:ID:       714a53f7-7e2e-4e56-bad9-de8605b66d65
:END:


Muitos problemas econômicos, sobretudo na abordagem marginal, envolvem a otimização de funções objetivo sujeitas a restrições.
As funções objetivo podem ser das mais variadas, como a maximização da utilidade, a minimização do custo e a escolha de portfólio.
O mesmo vale para as restrições, sejam físicas, monetárias ou institucionais/regulatórias.
O método padrão de otimização em economia envolve, primeiro, a identificação de pontos críticos, candidatos a ótimos locais, para, em seguida, qualificá-los analiticamente.
Para tanto, primeiro encontram-se as condições necessárias de primeira ordem que exigem que o gradiente da função objetivo em determinado ponto seja nulo, o que gera condições de estacionariedade.
Por mais que esta etapa permita vasculhar o domínio da função em pontos críticos, não é suficiente para distinguir máximos, mínimos e pontos de sela.
A qualificação do ponto crítico é fornecida pelas condições suficientes de segunda ordem, que exigem a análise local do comportamento da função na vizinhança desse ponto.
Essas condições de segunda ordem estão diretamente associadas às características de formas quadráticas e de matrizes definidas, tema da questão apresentada.


Considerando este contexto mais amplo, a exposição será organizada de forma progressiva.
Inicialmente, definem-se formalmente as formas quadráticas e os critérios de definitude para matrizes simétricas, estabelecendo sua ligação imediata com as condições de segunda ordem, a começar pela otimização irrestrita.
Em seguida, apresentam-se dois métodos de classificação, o espectral baseado em autovalores e o baseado em menores principais, elucidando suas condições de equivalência e aplicabilidade.
A terceira parte estende a teoria ao cenário de restrições lineares, introduzindo a noção de definitude restrita e desenvolvendo o teste completo para matrizes orladas.
Finalmente, todos esses elementos serão integrados em um exemplo numérico simplificado, envolvendo a minimização de uma função de custo quadrática sujeita a uma restrição tecnológica linear.
À luz deste exemplo, é possível avaliar a convexidade global da função de custo e a condição de segunda ordem para o ótimo restrito, interpretando os resultados à luz da teoria da produção.
Por fim, são indicadas direções pelas quais problemas de otimização em economia podem ser tratados utilizando outros métodos fundamentados nos desenvolvimentos apresentados.

Para fundamentar a análise, apresentam-se inicialmente as definições matemáticas centrais.
Uma forma quadrática \(Q: \mathbb{R}^n \to \mathbb{R}\) é uma função homogênea de grau dois que pode ser escrita como:
\[Q(\vec{x}) = \sum_{i=1}^n \sum_{j=1}^n a_{ij}\, x_i x_j\]
Vale notar que para toda forma quadrática existe uma representação única com matriz simétrica \(A\) de ordem \(n\times n\):
\[Q(\vec{x}) = \vec{x}^\top A \vec{x}\]
A simetria de \(A\) é feita via \(A = 0.5\left(B + B^{\top}\right)\) para qualquer matriz \(B\) que represente \(Q\).
Além disso, a simetria de \(A\) garante que todos os seus autovalores sejam reais.
A classificação da matriz \(A\) quanto à sua definitude é determinada pelo sinal da forma quadrática em relação a vetores não nulos.
Diz-se que \(A\) é positiva definida se \(\vec{x}^\top A \vec{x} > 0\) para todo \(\vec{x} \neq \vec{0}\).
É negativa definida se \(\vec{x}^\top A \vec{x} < 0\) para todo \(\vec{x} \neq \vec{0}\).
A matriz é positiva semidefinida se \(\vec{x}^\top A \vec{x} \geq 0\) para todo \(\vec{x}\) e se existe pelo menos um vetor não nulo \(\vec{v}\) tal que \(\vec{v}^\top A \vec{v} = 0\).
Analogamente, é negativa semidefinida se \(\vec{x}^\top A \vec{x} \leq 0\) para todo \(\vec{x}\) com igualdade para algum \(\vec{v} \neq \vec{0}\).
Finalmente, \(A\) é indefinida se existem vetores \(\vec{u}\) e \(\vec{w}\) tais que \(\vec{u}^\top A \vec{u} > 0\) e \(\vec{w}^\top A \vec{w} < 0\).

A relevância das formas quadráticas na otimização pode ser melhor compreendida a partir da expansão de Taylor de segunda ordem.
Para uma função \(f: \mathbb{R}^n \to \mathbb{R}\) duas vezes continuamente diferenciável em uma vizinhança de um ponto \(\vec{x}_{0}\), a aproximação quadrática é dada por:
\[f(\vec{x}_0 + \vec{h}) \approx f(\vec{x}_0) + \nabla f(\vec{x}_0)^{\top}\vec{h} + \frac{1}{2} \vec{h}^\top H_f(\vec{x}_0) \vec{h}, \]

em que a função é avaliada na direção \(\vec{h}\) próxima do ponto \(\vec{x}_{0}\) (\(\vec{h} = (\vec{x} - \vec{x}_{0})\)) e \(H_f(\vec{x}_0)\) é a matriz Hessiana de \(f\) avaliada em \(\vec{x}_{0}\).
Para o caso específico em que o ponto de análise é um ponto crítico (onde \(\nabla f(\vec{x}_0) = \vec{0}\)), a aproximação se torna:
\[f(\vec{x}_0 + \vec{h}) \approx f(\vec{x}_0) + \frac{1}{2} \vec{h}^\top H_f(\vec{x}_0) \vec{h}, \]
Neste caso, o termo dominante na variação \(f(\vec{x}_0 + \vec{h}) - f(\vec{x}_0)\) é, portanto, a forma quadrática \(Q(\vec{h}) = \vec{h}^\top H_f(\vec{x}_0) \vec{h}\).
O sinal desta forma quadrática, para todas as direções possíveis \(\vec{h}\), determina se \(f\) atinge um valor localmente menor, maior ou ambos em \(\vec{x}_0\).
Se \(Q(\vec{h}) > 0\) para todo \(\vec{h} \neq \vec{0}\), então \(f(\vec{x}_0 + \vec{h}) > f(\vec{x}_0)\) e \(\vec{x}_0\) é um mínimo local estrito.
Se \(Q(\vec{h}) < 0\) para todo \(\vec{h} \neq \vec{0}\), então \(\vec{x}_0\) é um máximo local estrito.
Se \(Q(\vec{h})\) assume valores positivos e negativos, então \(\vec{x}_0\) é um ponto de sela.
A definitude da forma quadrática \(Q\) é, assim, o análogo multivariado da condição de segunda derivada positiva (para mínimo) ou negativa (para máximo) do cálculo univariado.

No contexto de otimização, as categorias de definitude correspondem diretamente às possíveis configurações de ótimos locais.
Em aplicações econômicas mais gerais, nada garante que a função objetivo tenha forma quadrática, mas isso será o caso para a matriz Hessiana avaliada neste ponto crítico.
Uma vez que situações econômicas envolvem funções continuamente diferenciáveis, a respectiva Hessiana será simétrica pelo Teorema de Schwarz para funções da classe \(C^{2}\).
Vale pontuar que a condição de simetria garante que todos os autovalores de \(A\) são números reais, propriedade fundamental para a análise de seu sinal.
Portanto, classificar a natureza de um ponto crítico reduz-se a determinar a definitude da matriz Hessiana.
Como consequência, um ponto crítico \(\vec{x}_0\) de \(f\) é um mínimo local estrito se a Hessiana \(H_f(\vec{x}_0)\) for positiva definida; é um máximo local estrito se \(H_f(\vec{x}_0)\) for negativa definida; e é um ponto de sela se \(H_f(\vec{x}_0)\) for indefinida.
Os casos de semidefinitude correspondem a situações em que o teste de segunda ordem é inconclusivo, e o ponto pode ser um ótimo não estrito ou um ponto de inflexão de ordem superior.


Dois conjuntos principais de critérios permitem classificar a definitude de uma matriz simétrica \(A\).
O primeiro baseia-se nos autovalores.
Como \(A\) é simétrica, ela é diagonalizável por uma matriz ortogonal.
Existe uma matriz \(P\) com \(P^{-1} = P^\top\) e uma matriz diagonal \(\Lambda = \text{diag}(\lambda_1, \dots, \lambda_n)\) tais que \(A = P \Lambda P^\top\).
Os elementos diagonais \(\lambda_i\) são os autovalores reais de \(A\) e \(P\) é a matriz cujas colunas são os autovetores ortonormais.
Desta representação canônica, a caracterização da definitude por meio de autovalores é direta.
A matriz \(A\) é positiva definida se \(\lambda_i > 0\) para todo \(i\); é negativa definida se \(\lambda_i < 0\) para todo \(i\); é positiva semidefinida se \(\lambda_i \geq 0\) para todo \(i\) e existe \(j\) com \(\lambda_j = 0\); é negativa semidefinida se \(\lambda_i \leq 0\) para todo \(i\) e existe \(j\) com \(\lambda_j = 0\); e é indefinida se existem índices \(i, j\) com \(\lambda_i > 0\) e \(\lambda_j < 0\).

O segundo critério baseia-se nos menores principais da matriz.
Seja \(A_k\) a submatriz principal líder de ordem \(k\), formada pelas primeiras \(k\) linhas e \(k\) colunas de \(A\), e seja \(D_k = \det(A_k)\).
Partindo dos menores principais líderes, a matriz \(A\) é positiva definida se e somente se \(D_k > 0\) para todo \(k = 1, \dots, n\).
Estas são condições necessárias e suficientes para definitude estrita.
Como contrapartida, é negativa definida se e somente se \((-1)^k D_k > 0\) para todo \(k\).
Para a semidefinitude, o critério dos menores líderes é insuficiente; é necessário e suficiente que todos os menores principais (de todas as ordens) satisfaçam as condições de não-negatividade (ou de não-positividade com alternância de sinais).
A matriz é positiva semidefinida se e somente se todos os seus menores principais são não negativos.
É negativa semidefinida se e somente se todos os seus menores principais de ordem ímpar são não positivos e todos os de ordem par são não negativos.

Uma vez entendidas as condições para qualificar um ponto crítico como máximo, mínimo ou de sela, pode-se seguir para situações com restrições, típicas de problemas econômicos.
Ao longo dessa resposta, serão abordadas apenas restrições lineares e serão realizados os ajustes necessários para discriminar os pontos críticos nesses casos.
Dito de outro modo, a qualificação de um ponto crítico deve considerar apenas as direções de variação viáveis, ou seja, que respeitam as restrições.
Dadas \(m\) restrições lineares homogêneas e independentes, escritas como \(B\vec{x} = \vec{0}\), com \(B\) uma matriz \(m \times n\) de posto \(m\), o comportamento relevante da forma quadrática \(Q(\vec{x}) = \vec{x}^\top A \vec{x}\) é aquele restrito ao subespaço definido pelas restrições.
Diz-se que \(A\) é positiva definida sob a restrição \(B\vec{x} = \vec{0}\) se \(\vec{x}^\top A \vec{x} > 0\) para todo \(\vec{x} \neq \vec{0}\) que satisfaça \(B\vec{x} = \vec{0}\), com definições análogas para as outras categorias.
Este é o teste de segunda ordem para um problema de otimização com restrições lineares de igualdade.

A ferramenta analítica para implementar esta verificação é a matriz orlada (ou bordada), projetando a forma quadrática no subespaço viável.
Dadas a matriz \(A\) \((n \times n)\) e a matriz de restrições \(B\) \((m \times n)\), constrói-se a matriz simétrica aumentada \(H\) de ordem \((m+n)\):
\[
H = \begin{pmatrix} \mathbf{0}_{m \times m} & B \\ B^{\top} & A \end{pmatrix}.
\]
A definitude restrita de \(A\) é determinada pelos últimos \(n-m\) menores principais líderes da matriz \(H\).
Seja \(H_k\) a submatriz principal líder de ordem \(k\) de \(H\).
Para uma definitude positiva restrita, os determinantes de ordem \(2m+1_{}\) até \(n+m\) devem ter o sinal de \((-1)^m\).
Para uma definitude negativa restrita, estes mesmos determinantes devem alternar de sinal, começando por \((-1)^{m+1}\).
O caso particular de uma única restrição (\(m=1\)) é comum em aplicações econômicas e, por essa razão, será descrito em detalhes.
Com \(B = \vec{b}^\top\) (um vetor linha), a matriz orlada é
\[H = \begin{pmatrix} 0 & \vec{b}^\top \\ \vec{b} & A \end{pmatrix}\]
Neste caso, \(A\) é positiva definida sob \(\vec{b}^\top\vec{x}=0\) se os \(n\) menores principais líderes de \(H\) tiverem o sinal \((-1)^{m} = -1\), ou seja, se forem negativos.
É negativa definida sob a restrição de que, se esses menores principais líderes alternarem, começando pelo sinal  positivo.

Com base nesse instrumental matemático, pode-se explorar uma situação-problema econômica para consolidar esses conceitos.
Em seguida, analisa-se o caso de um modelo de minimização de custos de produção.
Considere uma firma que utiliza dois insumos, trabalho (\(L\)) e capital (\(K\)), para produzir um único bem, sujeita a uma restrição tecnológica.
A função de custo, que captura a despesa total com os fatores, é especificada como uma forma quadrática:
\[C(L, K) = \frac{1}{2}L^2 + \frac{1}{2}K^2 + \frac{1}{4} LK\]
Trata-se, portanto, de uma forma quadrática pura, cuja matriz Hessiana \(H_{C}\) é constante e independe do ponto \((L,K)\).
Consequentemente, a análise de sua definitude é válida em todo o domínio, simplificando a exposição sem perda de rigor conceitual.


Para fins didáticos e sem perda de generalidade, impõe-se uma restrição tecnológica linear:
\[2L + K = \bar{Q}\]
onde \(\bar{Q} > 0\) representa um nível de produção meta (físico), gerando uma isoquanta linear.
O objetivo da firma é escolher \((L, K)\) para minimizar \(C(L, K)\) sujeito a essa restrição.


A análise de segunda ordem começa por investigar a convexidade global da função de custo, que é determinada pela sua Hessiana.
Calculando as derivadas parciais de segunda ordem, obtemos:
\[
H_C = \begin{pmatrix} \frac{\partial^2 C}{\partial L^2} & \frac{\partial^2 C}{\partial L \partial K} \\ \frac{\partial^2 C}{\partial K \partial L} & \frac{\partial^2 C}{\partial K^2} \end{pmatrix} = \begin{pmatrix} 1 & \frac{1}{4} \\ \frac{1}{4} & 1 \end{pmatrix}.
\]
Antes de considerar a restrição, aplica-se o critério dos menores principais líderes para classificar \(H_C\).
Neste caso, \(D_1 = 1 > 0\) e \(D_2 = \det(H_C) = 1 \cdot 1 - (\frac{1}{4})^2 = \frac{15}{16} > 0\).
Como todos os menores principais líderes são estritamente positivos, \(H_C\) é positiva definida.
Isto significa que a função \(C\) é estritamente convexa em todo o \(\mathbb{R}^2\).
A análise espectral, via autovalores, corrobora este resultado.
Os autovalores são as raízes de:
\begin{align*}
\det(H_C - \lambda I)
&= (1-\lambda)^2 - \left(\tfrac{1}{4}\right)^2 = 0\\
&= 1 - 2\lambda + \lambda^2 - \tfrac{1}{16} = 0 \\
&= \lambda^2 - 2\lambda + \tfrac{15}{16} = 0\\
\lambda_{{1,2}} &= \frac{-(-1) \pm \sqrt{(-1)^2 - 1\cdot \tfrac{15}{16}}}{1} \\
&= 1 \pm \sqrt{1 - \tfrac{15}{16}} = 1 \pm \sqrt{\tfrac{1}{16}} \\
&= 1 \pm \tfrac{1}{4}
\end{align*}
que são \(\lambda_1 = \frac{3}{4}\) e \(\lambda_2 = \frac{5}{4}\).
Ambos são estritamente positivos, confirmando a definitude positiva.
Economicamente, a definitude positiva da Hessiana implica que a função tem custos marginais crescentes em qualquer direção no espaço dos insumos.

Como esperado, a presença da restrição tecnológica altera o conjunto de escolhas viáveis.
Para qualificar um ponto candidato a ótimo restrito, precisamos verificar a condição de segunda ordem no subespaço das variações viáveis, isto é, para vetores \((\Delta L, \Delta K)\) que satisfaçam a equação \(2\Delta L + \Delta K = 0\).
Isto equivale a testar se \(H_C\) é positiva definida sob a restrição linear \(B = (2, 1)\).
Constrói-se a matriz orlada correspondente:
\[
H = \begin{pmatrix} 0 & 2 & 1 \\ 2 & 1 & \frac{1}{4} \\ 1 & \frac{1}{4} & 1 \end{pmatrix}.
\]
Para uma única restrição (\(m=1\)), a matriz orlada \(H\) tem ordem \(n+1\).
O critério para \(A\) ser positiva definida na restrição é que os últimos \(n - m = n - 1\) menores principais líderes de \(H\) tenham sinal \((-1)^{m}\).
No caso \(m=1\), isso significa examinar os menores principais líderes de ordem \(2m + 1, \ldots, n+1\), e todos devem ser negativos.
Para o caso específico de \(n = 2\), só há o determinante completo de \(H\) (ordem 3) a se verificar.
Aplicando o método de Sarrus:
\begin{align*}
\det(H) & = \left(0 \cdot 1 \cdot 1 + 2 \cdot \frac{1}{4} \cdot 1 + 1 \cdot 2 \cdot \frac{1}{4}\right) - \left(1 \cdot 1 \cdot 1 + 2 \cdot 2 \cdot 1 + 0 \cdot \frac{1}{4} \cdot \frac{1}{4}\right) \\
 & = \left(0 + \frac{1}{2} + \frac{1}{2}\right) - (1 + 4 + 0) \\
 & = -4
\end{align*}
Obtém-se \(\det(H) = -4\), que possui o sinal \((-1)^m = (-1)^1 = -1\).
Portanto, pelo critério da matriz orlada, a Hessiana \(H_C\) é positiva definida sob a restrição \(2L + K = \bar{Q}\).
Conclui-se que qualquer ponto crítico que satisfaça a restrição será um mínimo local estrito para o problema de minimização de custo definido por esta restrição linear.
A intuição econômica é que, mesmo quando forçada a operar ao longo de uma trajetória específica no espaço de insumos, a firma ainda enfrenta custos convexos ao longo dessa trajetória.
O sinal negativo do determinante da matriz orlada é consistente com a curvatura positiva ("curvada para cima") da função de custo na direção viável.

Em resumo, o instrumental matemático que trata das formas quadráticas e da definitude de matrizes simétricas fornece as condições de segunda ordem para otimização, tanto irrestrita quanto com restrições lineares.
Essa relação entre a forma quadrática e a otimização fica evidenciada pela expansão de Taylor de segunda ordem, que destaca a Hessiana como o termo determinante para a classificação de pontos críticos.
Os critérios baseados em autovalores e em menores principais oferecem métodos complementares para a classificação, enquanto a construção de matrizes orladas estende a análise ao contexto restrito, essencial para a modelagem em situações-problema economicamente relevantes.
Neste texto, foi apresentada uma exemplificação numérica simplificada, contemplando os elementos essenciais para a compreensão dos conceitos discutidos.
Por fim, cabe destacar que a compreensão e a classificação de formas quadráticas desempenham um papel central em problemas de otimização, sejam eles condicionados ou não.
Este é o caso, por exemplo, do método dos multiplicadores de Lagrange, utilizado em otimizações com restrições.
Sendo assim, os conceitos e aplicações aqui descritos são fundamentais na área de métodos quantitativos aplicados à economia.


* NEXT Otimização não condicionada [0%]

Materiais:
- Simon and Blume Ch 17
- Guidorizzi Ch 16
- Chiang Ch 11
- Parte de Simon and Blume Ch 30
- [[https://ocw.uci.edu/lectures/math_4_lec_15_math_for_economists.html][Mathematical Review]]
- Apêndice matemático Petri

** TODO Condições de Primeira e Segunda Ordem

** TODO Máximo e Mínimos Globais

** TODO Aplicações à Economia

* TODO Otimização condicionada [0%]

Materiais:
- Simon and Blume Ch 18
- Simon and Blume Ch 19
- Chiang 12
- Chiang 13
- Apêndice matemático Petri
- Parte de Simon and Blume Ch 30
- Simon and Blume Ch 30.4
- Stewart 14.8
- Ostaszewski Ch 15

** TODO Restrições de Igualdade e de Desigualdade

** TODO Condições de Kuhn-Tucker

** TODO Multiplicador de Lagrange

Materiais:

- [[https://www.youtube.com/watch?v=Oc4p16QQ104&list=PLFU2umoZ7g9N9fKPz1ls_HGupvQh6RFyu&index=10][Lecture (Video)]]

** TODO Aplicações à Economia


* Funções de várias variáveis: Roteiro de resposta

1. Introdução e motivação econômica
   - Problemas econômicos relevantes dependem, em geral, de múltiplas variáveis independentes
     - Funções de produção com múltiplos insumos
     - Funções utilidade dependentes de vários bens
     - Funções de custo e de lucro envolvendo preços e quantidades
   - A variável econômica de interesse passa a ser modelada como função de um vetor de argumentos
   - O cálculo univariado é insuficiente para capturar interdependências e estruturas geométricas
   - Necessidade do aparato do cálculo multivariado
   - Delimitação metodológica
     - Uso da função Cobb-Douglas como exemplo didático
     - Abordagem marginalista adotada apenas por conveniência analítica
2. Funções entre espaços euclidianos
   - Definição geral
     - Uma função de várias variáveis é uma aplicação
       - $$ f : D \subseteq \mathbb{R}^n \to \mathbb{R}^m $$
   - Interpretação
     - Um ponto do domínio é um vetor
       - $$ x = (x_1,\dots,x_n) $$
     - A imagem é um vetor
       - $$ f(x) = (f_1(x),\dots,f_m(x)) $$
   - Caso típico em economia
     - Funções escalares com $m=1$
   - Estrutura euclidiana
     - Produto interno usual
     - Norma euclidiana $\|x\|$
3. Limite em várias variáveis
   - Conceito fundamental
     - A noção de limite exige controle da aproximação em todas as direções
   - Definição de bola aberta
     - Para $a \in \mathbb{R}^n$ e $\delta>0$
       - $$ B_\delta(a) = \{x \in \mathbb{R}^n : \|x-a\| < \delta\} $$
   - Definição de limite (função escalar)
     - Diz-se que
       - $$ \lim_{x \to a} f(x) = L $$
     - se, para todo $\varepsilon>0$, existe $\delta>0$ tal que
       - $$ 0 < \|x-a\| < \delta \Rightarrow |f(x)-L| < \varepsilon $$
   - Propriedade essencial
     - O limite deve ser independente do caminho de aproximação
     - Deve coincidir para toda sequência que converge para $a$
   - Extensão
     - Para funções vetoriais, substitui-se o valor absoluto pela norma em $\mathbb{R}^m$
4. Continuidade
   - Definição
     - Uma função $f$ é contínua em $a$ se
       - $$ \lim_{x \to a} f(x) = f(a) $$
   - Continuidade no domínio
     - Se a condição vale para todo $a \in D$, a função é contínua em $D$
   - Interpretação econômica
     - Pequenas variações nos argumentos geram pequenas variações no valor da função
     - Exclusão de saltos e descontinuidades locais
   - Exemplo: função Cobb-Douglas
     - $$ F(K,L) = A K^\alpha L^\beta $$
     - Com $A>0$ e $\alpha,\beta>0$
     - Função contínua em $\mathbb{R}^2_{++}$
     - Continuidade fundamenta o uso de derivadas parciais e otimização
5. Gráficos de funções de duas variáveis
   - Definição de gráfico
     - Para $f : \mathbb{R}^2 \to \mathbb{R}$
       - $$ \{(x,y,z) \in \mathbb{R}^3 : z = f(x,y)\} $$
   - Interpretação geométrica
     - Superfície no espaço tridimensional
   - Limitação analítica
     - Representação pouco prática para análise econômica aplicada
6. Curvas de nível
   - Definição
     - Para $c \in \mathbb{R}$
       - $$ C_c = \{(x,y) \in D : f(x,y) = c\} $$
   - Interpretação geométrica
     - Projeções das interseções da superfície com planos horizontais
   - Aplicação econômica
     - Curvas de nível de funções de produção correspondem a isoquantas
   - Exemplo: Cobb-Douglas
     - Isoquanta associada a $Y^\star$
       - $$ A K^\alpha L^\beta = Y^\star $$
     - Forma explícita
       - $$ L = \left(\frac{Y^\star}{A}\right)^{1/\beta} K^{-\alpha/\beta} $$
     - Propriedades
       - Curvas estritamente decrescentes
       - Substituição técnica entre fatores
       - Inclinação relacionada à TMST
   - Extensão
     - Superfícies de nível em $\mathbb{R}^3$
     - Hipersuperfícies de nível para $n>3$
7. Tipos especiais de funções
   - Funções lineares
     - Definição
       - $$ T(x+y)=T(x)+T(y) $$
       - $$ T(\lambda x)=\lambda T(x) $$
     - Representação matricial
       - $$ T(x)=Ax $$
     - Interpretação econômica
       - Substituição perfeita entre insumos
   - Funções afins
     - Definição
       - $$ f(x)=Ax+b $$
     - Aplicação
       - Funções de custo com componente fixo
   - Polinômios multivariados
     - Definição geral
       - Um polinômio multivariado em $n$ variáveis é uma soma finita de monômios com coeficientes reais
     - Representação formal
       - \(P(x_1,\dots,x_n) = \sum_{\alpha \in \mathbb{N}^n,\;|\alpha|\le d} c_{\alpha}\, x_1^{\alpha_1}\cdots x_n^{\alpha_n}\)
     - Interpretação dos termos
       - O vetor $\alpha=(\alpha_1,\dots,\alpha_n)$ indica os expoentes de cada variável
       - O grau total do monômio é dado por $|\alpha|=\alpha_1+\cdots+\alpha_n$
     - Grau do polinômio
       - O grau total é o maior $|\alpha|$ com $c_\alpha \neq 0$
     - Interpretação econômica
       - Aproximações locais de funções econômicas
       - Termos de interação capturam efeitos conjuntos entre variáveis
   - Formas quadráticas
     - Polinômios homogêneos de grau dois
     - Representação matricial
       - $$ Q(x)=x^\top A x $$
     - Aplicação econômica
       - Hessiano
       - Concavidade e convexidade
       - Análise local de otimização
8. A função Cobb-Douglas na hierarquia funcional
   - Não é linear, afim ou polinomial em geral
   - Caso especial
     - Expoentes inteiros não negativos
   - Propriedade central: homogeneidade
     - Definição
       - $$ f(tx)=t^r f(x), \quad t>0 $$
     - Para Cobb-Douglas
       - $$ r=\alpha+\beta $$
   - Interpretação econômica
     - Retornos à escala
       - $r=1$: constantes
       - $r>1$: crescentes
       - $r<1$: decrescentes
   - Implicação analítica
     - Aplicação do teorema de Euler
     - Continuidade global no domínio relevante
9. Exemplo numérico
   - Função considerada
     - $$ F(K,L)=K^{0.5}L^{0.5} $$
   - Avaliação em um ponto
     - $$ F(4,9)=6 $$
   - Escalonamento dos insumos
     - $$ F(8,18)=12 $$
     - Ilustração de retornos constantes à escala
   - Isoquanta
     - $$ L=\frac{Y^2}{K} $$
     - Para $Y=6$, $L=36/K$
     - Combinações equivalentes de insumos
10. Conclusão
    - Síntese conceitual
      - Funções entre espaços euclidianos
      - Limite e continuidade
      - Curvas e superfícies de nível
      - Classes funcionais e homogeneidade
    - Observação final
      - O aparato matemático é geral
      - Exemplos econômicos têm função ilustrativa



* Derivada total: Roteiro de resposta

- Introdução e motivação em estática comparativa
  - Análise de como variáveis endógenas de equilíbrio respondem a pequenas variações exógenas.
  - Limitações das derivadas univariadas em contextos com múltiplas variáveis interdependentes.
  - Distinção conceitual entre:
    - Derivadas parciais (efeitos marginais ceteris paribus).
    - Derivada total e diferencial total (efeitos conjuntos).
  - Justificativa do uso da função Cobb–Douglas como exemplo canônico.

- Derivadas parciais: definição e interpretação econômica
  - Definição formal da derivada parcial:
    \[f_{x_i}(a) = \lim_{h \to 0} \frac{f(a_1,\dots,a_i+h,\dots,a_n)-f(a)}{h} \]
  - Interpretação como taxa marginal de variação local.
  - Hipótese de admissibilidade ceteris paribus no modelo econômico.
  - Observação:
    - Existência de derivadas parciais não implica diferenciabilidade.
    - Funções com complementaridade perfeita (Leontief).

- Diferenciabilidade e derivada total
  - Funções de classe \(C^1\):
    - Derivadas parciais contínuas em uma vizinhança.
  - Definição de diferenciabilidade:
    \[f(a+h) = f(a) + L(h) + o(|h|) \]
    - Com \(o(|h|/|h| \to 0\) quando \(h \to 0\)
  - Aplicação linear associada:
    \[L(h) = \nabla f(a)\cdot h = \sum_{i=1}^n f_{x_i}(a)\,h_i \]
  - Definição do gradiente:
    \[\nabla f(a) = (f_{x_1}(a),\dots,f_{x_n}(a)) \]

- Diferencial total
  - Definição formal:
    \[df(a) = \sum_{i=1}^n f_{x_i}(a)\,dx_i \]
  - Aproximação de primeira ordem:
    \[f(a+h)-f(a) \approx df(a) \]
  - Interpretação econômica:
    - Efeito total de variações simultâneas nas variáveis exógenas.
  - Memo: Derivada total é um operador linear aplicado a uma direção genérica, equanto o diferencial associa a direção com uma variação exógena e incremental
    - Já a derivada direcial associa a direção a um vetor *unitário*

- Exemplo central: função de produção Cobb–Douglas
  - Definição geral:
    \[F(K,L) = A K^\alpha L^{1-\alpha}, \quad A>0,\ 0<\alpha<1 \]
  - Derivadas parciais:
    \[F_K = A\alpha K^{\alpha-1}L^{1-\alpha}, \quad F_L = A(1-\alpha)K^\alpha L^{-\alpha} \]
  - Interpretação como produtos marginais.
  - Diferencial total da produção:
    \[dY = F_K\,dK + F_L\,dL \]
  - Elasticidades constantes:
    - \(\alpha\) e \(1-\alpha\).
  - Homogeneidade de grau 1 e Teorema de Euler.
    - Contribuições marginais exaurem o valor do produto

- Interpretação geométrica: plano tangente
  - Gráfico de \(f : \mathbb{R}^2 \to \mathbb{R}\):
    \((x,y,z)\) com \(z=f(x,y)\).
  - Equação do plano tangente:
    \[z - f(x_0,y_0) = f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0) \]
  - Aproximação linear local:
    \[f(x,y) \approx f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0) \]
  - Condição essencial:
    - Diferenciabilidade garante qualidade da aproximação.

- Generalização para \(\mathbb{R}^n\)
  - Derivada total como operador linear:
    \[Df(a)[h] = \nabla f(a)\cdot h \]
  - Diferencial total:
    \[df(a) = \sum_{i=1}^n f_{x_i}(a)\,dx_i \]
  - Interpretação geométrica:
    - Existência de hiperplano tangente em \(\mathbb{R}^{n+1}\).
    \[z - f(a) = \sum_{i=1}^n f_{x_i}(a)(x_i-a_i) \]

- Exemplo numérico explícito
  - Função:
    \[F(K,L) = K^{1/2}L^{1/2} \]
  - Ponto de referência:
    \((K_0,L_0)=(9,16)\), \(Y_0=12\).
  - Produtos marginais:
    \[F_K(9,16)=\tfrac{2}{3}, \quad F_L(9,16)=\tfrac{3}{8} \]
  - Diferencial total:
    \[dY = \tfrac{2}{3}dK + \tfrac{3}{8}dL \]
  - Variações:
    \(\Delta K=1,\ \Delta L=1\).
  - Aproximação:
    \[\Delta Y \approx \tfrac{25}{24} \]
  - Comparação com o valor exato:
    \[F(10,17)=\sqrt{170} \]

- Síntese conceitual
  - Derivadas parciais: efeitos marginais isolados.
  - Derivada total: estrutura linear local de sensibilidade.
  - Diferencial total: operacionalização do efeito agregado.
  - Plano/hiperplano tangente: interpretação geométrica.
  - Aplicabilidade geral:
    - Equilíbrio geral.
    - Modelos SFC, ABM, Insumo–Produto.


* Regra da cadeia: roteiro de resposta


1. Contextualização do problema econômico:
   - Interesse em analisar como uma variável endógena responde a variações em parâmetros exógenos.
   - Em ambientes multivariados, variações relevantes ocorrem ao longo de trajetórias no espaço das variáveis, e não apenas ao longo de eixos coordenados.
   - Limitação do caso univariado: a derivada ordinária não captura ajustes coordenados.
   - Objetivo: conectar derivadas parciais, curvas parametrizadas, vetores tangentes e regra da cadeia, com aplicação econômica.

2. Definição de curva parametrizada:
   - Uma curva parametrizada em $\mathbb{R}^n$ é uma função
     \[\gamma : I \subset \mathbb{R} \to \mathbb{R}^n, \quad \gamma(t) = (\gamma_1(t), \ldots, \gamma_n(t)). \]
   - O parâmetro $t$ pode ser interpretado como tempo ou como um parâmetro abstrato.

3. Diferenciabilidade e vetor tangente:
   - A curva é diferenciável em $t_0$ se cada componente $\gamma_j(t)$ é diferenciável em $t_0$.
   - O vetor tangente é definido por
     \[\gamma'(t_0) = (\gamma_1'(t_0), \ldots, \gamma_n'(t_0)). \]
   - Interpretação geométrica via limite do vetor secante:
     \[\frac{\gamma(t_0 + h) - \gamma(t_0)}{h} \to \gamma'(t_0), \quad h \to 0. \]

4. Curvas regulares:
   - A curva $\gamma$ é regular (classe $C^1$) se:
     \[\gamma'(t) \neq \mathbf{0}, \quad \forall t \in I. \]
   - A regularidade garante a existência de uma direção tangente bem definida em todos os pontos.

5. Função composta ao longo de uma curva:
   - Seja $f : D \subset \mathbb{R}^n \to \mathbb{R}$ uma função diferenciável.
   - Seja $\gamma : I \to D$ uma curva regular.
   - Define-se a função composta
     \[g(t) = f(\gamma(t)). \]

6. Regra da cadeia (forma analítica):
   - A derivada de $g(t)$ é dada por
     \[g'(t) = \sum_{j=1}^n \frac{\partial f}{\partial x_j}(\gamma(t)) \cdot \gamma_j'(t). \]

7. Regra da cadeia (forma vetorial):
   - O gradiente de $f$ é
     \[\nabla f(\gamma(t)) = \left(\frac{\partial f}{\partial x_1}(\gamma(t)), \ldots, \frac{\partial f}{\partial x_n}(\gamma(t)) \right). \]
   - A derivada ao longo da curva é
     \[g'(t) = \nabla f(\gamma(t)) \cdot \gamma'(t). \]

8. Caso bidimensional:
   - Se $f = f(x,y)$, com $x = x(t)$ e $y = y(t)$, então
     \[\frac{d}{dt} f(x(t), y(t)) = \frac{\partial f}{\partial x} \frac{dx}{dt} + \frac{\partial f}{\partial y} \frac{dy}{dt}. \]

9. Definição da função de produção:
   - Tecnologia Cobb-Douglas com retornos constantes:
     \[F(K,L) = \sqrt{K L}. \]

10. Insumos como funções de parâmetros:
    - Taxa de juros $r$ e tempo $t$.
    - Funções dos insumos:
      \[K(r,t) = 4 + t^2 - r, \quad L(r,t) = 8 + 2t - r. \]

11. Função composta da produção:
    - Produção como função de $(r,t)$:
      \[Y(r,t) = \sqrt{(4 + t^2 - r)(8 + 2t - r)}. \]

12. Derivadas parciais da tecnologia:
    - Produtos marginais:
      \[F_K(K,L) = \frac{1}{2} \sqrt{\frac{L}{K}}, \quad F_L(K,L) = \frac{1}{2} \sqrt{\frac{K}{L}}. \]

13. Derivadas dos insumos:
    - Em relação a $r$:
      \[\frac{\partial K}{\partial r} = -1, \quad \frac{\partial L}{\partial r} = -1. \]
    - Em relação a $t$:
      \[\frac{\partial K}{\partial t} = 2t, \quad \frac{\partial L}{\partial t} = 2. \]

14. Regra da cadeia aplicada:
    - Sensibilidade em relação a $r$:
      \[\frac{\partial Y}{\partial r} = -F_K - F_L. \]
    - Sensibilidade em relação a $t$:
      \[\frac{\partial Y}{\partial t} = 2t F_K + 2 F_L. \]

15. Avaliação em um ponto de referência:
    - Escolha do ponto:
      \[(r_0, t_0) = (1,1). \]
    - Valores dos insumos:
      \[K_0 = 4, \quad L_0 = 9. \]
    - Produção:
      \[Y_0 = \sqrt{4 \cdot 9} = 6. \]

16. Produtos marginais no ponto:
    - Avaliações:
      \[F_K(4,9) = \frac{3}{4}, \quad F_L(4,9) = \frac{1}{3}. \]

17. Sensibilidades numéricas:
    - Em relação a $r$:
      \[\frac{\partial Y}{\partial r}(1,1) = -\frac{3}{4} - \frac{1}{3} = -\frac{13}{12}. \]
    - Em relação a $t$:
      \[\frac{\partial Y}{\partial t}(1,1) = 2 \cdot \frac{3}{4} + 2 \cdot \frac{1}{3} = \frac{13}{6}. \]

18. Interpretação econômica:
    - A variação em $r$ reduz $Y$ via contração simultânea de $K$ e $L$.
    - A variação em $t$ eleva $Y$ via expansão simultânea de $K$ e $L$.
    - Cada termo corresponde a um produto marginal ponderado pela variação do insumo.

19. Interpretação geométrica:
    - Vetores tangentes no espaço $(K,L)$:
      \[\gamma_r'(1,1) = (-1,-1), \quad \gamma_t'(1,1) = (2,2). \]
    - Gradiente da tecnologia:
      \[\nabla F(4,9) = \left(\frac{3}{4}, \frac{1}{3}\right). \]
    - Produtos escalares:
      \[\nabla F \cdot \gamma_r' = -\frac{13}{12}, \quad \nabla F \cdot \gamma_t' = \frac{13}{6}. \]

20. Extensão para funções implícitas:
    - Equilíbrio definido por:
      \[F(\mathbf{x}, \boldsymbol{\alpha}) = \mathbf{0}. \]
    - Análise local em torno de $(\mathbf{x}^*, \boldsymbol{\alpha}^*)$.
    - Sensibilidades locais:
      \[\frac{\partial x_i}{\partial \alpha_j}. \]
    - Instrumental: regra da cadeia + teorema da função implícita.
    - Aplicações em modelos SFC e de equilíbrio geral.


* Derivadas direcionais e vetor gradiente: roteiro de resposta

1. Delimitar a motivação econômica e o problema geral

   *Objetivo:* situar a análise de sensibilidade econômica em espaços multidimensionais e justificar a necessidade de derivadas direcionais.

   - Introduzir a análise quantitativa em economia como estudo de sensibilidade de variáveis endógenas a mudanças exógenas.
   - Comparar o caso unidimensional, no qual a derivada ordinária é suficiente, com o caso multidimensional.
   - Enfatizar que, em modelos econômicos realistas, múltiplos argumentos variam simultaneamente.
   - Destacar que derivadas parciais capturam apenas variações isoladas, mantendo os demais argumentos fixos.
   - Argumentar que políticas e choques econômicos relevantes envolvem combinações lineares de variações.
   - Concluir que a análise marginal requer instrumentos capazes de lidar com direções arbitrárias no espaço.

2. Formalizar o objeto matemático de análise

   *Objetivo:* definir rigorosamente o tipo de função e o espaço no qual a análise será conduzida.

   - Definir função escalar \(f : D \subseteq \mathbb{R}^n \to \mathbb{R}\).
   - Identificar \(\vec{x}\) como vetor de argumentos econômicos.
   - Fixar \(\vec{x}_0 \in D\) como ponto de referência da análise local.
   - Ressaltar que o interesse está no comportamento local da função.
   - Estabelecer notação vetorial com seta para evitar ambiguidades.

3. Enfatizar o caráter local da análise marginal

   *Objetivo:* explicitar que derivadas direcionais são conceitos estritamente locais.

   - Introduzir deslocamentos infinitesimais em torno de \(\vec{x}_0\).
   - Rejeitar interpretações globais da função.
   - Relacionar a análise à estática comparativa local.
   - Destacar que resultados dependem simultaneamente do ponto e da direção.

4. Definir formalmente a derivada direcional

   *Objetivo:* apresentar a definição matemática via limite e estabelecer seu escopo.

   - Introduzir vetor direção \(\vec{v} \in \mathbb{R}^n \setminus \{\vec{0}\}\).
   - Definir o versor associado \(\vec{u} = \vec{v}/\|\vec{v}\|\).
   - Parametrizar a trajetória como \(\vec{x}(h) = \vec{x}_0 + h\vec{u}\).
   - Definir a derivada direcional como:
     \[
     D_{\vec{u}} f(\vec{x}_0)
     =
     \lim_{h \to 0}
     \frac{f(\vec{x}_0 + h\vec{u}) - f(\vec{x}_0)}{h}.
     \]
   - Ressaltar que a existência do limite não é garantida.
   - Destacar que a derivada direcional pode existir sem diferenciabilidade.
   - Mostrar que derivadas parciais são casos particulares:
     \[
     D_{\vec{e}_i} f(\vec{x}_0) = \frac{\partial f}{\partial x_i}(\vec{x}_0).
     \]

5. Introduzir a hipótese de diferenciabilidade

   *Objetivo:* estabelecer a condição que garante regularidade suficiente da função.

   - Restringir a análise a funções diferenciáveis.
   - Definir diferenciabilidade como existência de uma aproximação linear ótima.
   - Escrever a expansão local:
     \[
     f(\vec{x}_0 + \vec{h})
     =
     f(\vec{x}_0) + L(\vec{h}) + o(\|\vec{h}\|).
     \]
   - Ressaltar que o termo de erro é assintoticamente nulo.
   - Destacar que diferenciabilidade é condição suficiente para derivadas direcionais bem comportadas.

6. Definir o vetor gradiente

   *Objetivo:* agregar toda a informação marginal local em um único objeto.

   - Definir o gradiente como:
     \[
     \nabla f(\vec{x}_0)
     =
     \left(
     \frac{\partial f}{\partial x_1}(\vec{x}_0),
     \dots,
     \frac{\partial f}{\partial x_n}(\vec{x}_0)
     \right).
     \]
   - Interpretar o gradiente como vetor de produtos marginais.
   - Ressaltar dependência do ponto \(\vec{x}_0\).

7. Relacionar derivada direcional e gradiente

   *Objetivo:* demonstrar a equivalência operacional sob diferenciabilidade.

   - Partir da definição de derivada direcional.
   - Substituir a expansão linear na definição do limite.
   - Obter:
     \[
     D_{\vec{u}} f(\vec{x}_0)
     =
     \nabla f(\vec{x}_0) \cdot \vec{u}.
     \]
   - Ressaltar que o cálculo do limite é encapsulado no gradiente.
   - Enfatizar que uma vez conhecido o gradiente, derivadas direcionais são triviais.

8. Interpretar geometricamente a derivada direcional

   *Objetivo:* conectar cálculo diferencial e geometria.

   - Recordar a identidade do produto escalar:
     \[
     \vec{a} \cdot \vec{b}
     =
     \|\vec{a}\| \|\vec{b}\| \cos \theta.
     \]
   - Obter:
     \[
     D_{\vec{u}} f(\vec{x}_0)
     =
     \|\nabla f(\vec{x}_0)\| \cos \theta.
     \]
   - Interpretar como projeção do gradiente na direção \(\vec{u}\).
   - Identificar o valor máximo como \(\|\nabla f(\vec{x}_0)\|\).

9. Identificar direções de crescimento máximo e nulo

   *Objetivo:* caracterizar propriedades fundamentais do gradiente.

   - Mostrar que o crescimento máximo ocorre quando \(\vec{u}\) é paralelo ao gradiente.
   - Mostrar que a derivada direcional é nula quando \(\vec{u}\) é ortogonal ao gradiente.
   - Definir superfícies de nível \(f(\vec{x}) = c\).
   - Concluir que o gradiente é normal às superfícies de nível.

10. Construir o exemplo econômico

    *Objetivo:* ilustrar os conceitos com uma tecnologia econômica concreta.

    - Definir função Cobb–Douglas:
      \[
      F(K,L) = K^{1/2}L^{1/2}.
      \]
    - Interpretar como tecnologia com retornos constantes à escala.

11. Calcular o gradiente da função de produção

    *Objetivo:* explicitar os produtos marginais.

    - Calcular:
      \[
      F_K = \frac{1}{2}\sqrt{\frac{L}{K}},
      \quad
      F_L = \frac{1}{2}\sqrt{\frac{K}{L}}.
      \]
    - Escrever:
      \[
      \nabla F(K,L)
      =
      \left(
      \frac{1}{2}\sqrt{\frac{L}{K}},
      \frac{1}{2}\sqrt{\frac{K}{L}}
      \right).
      \]

12. Fixar ponto de referência simples

    *Objetivo:* facilitar cálculo e interpretação.

    - Escolher \((K_0,L_0)=(4,4)\).
    - Calcular:
      \[
      F(4,4)=4,
      \quad
      \nabla F(4,4) = \left(\frac{1}{2},\frac{1}{2}\right).
      \]
    - Calcular a norma:
      \[
      \|\nabla F(4,4)\|=\frac{\sqrt{2}}{2}.
      \]

13. Introduzir um choque direcional composto

    *Objetivo:* representar ajustes conjuntos dos insumos.

    - Definir vetor de política \(\vec{v}=(3,4)\).
    - Calcular o versor:
      \[
      \vec{u}=\left(\frac{3}{5},\frac{4}{5}\right).
      \]

14. Calcular a derivada direcional

    *Objetivo:* executar a análise de sensibilidade direcional.

    - Calcular:
      \[
      D_{\vec{u}}F(4,4)
      =
      \left(\frac{1}{2},\frac{1}{2}\right)
      \cdot
      \left(\frac{3}{5},\frac{4}{5}\right)
      =
      \frac{7}{10}.
      \]
    - Interpretar como taxa marginal de crescimento do produto.
    - Comparar com a taxa máxima \(\sqrt{2}/2\).

15. Sintetizar o encadeamento lógico do método

    *Objetivo:* reconstruir a lógica analítica completa, evitando omissões conceituais.

    - Diferenciabilidade \(\Rightarrow\) existência de aproximação linear local.
      - Sem diferenciabilidade não há gradiente bem definido.
    - Diferenciabilidade \(\Rightarrow\) gradiente.
      - O gradiente agrega todas as derivadas parciais.
    - Gradiente \(\Rightarrow\) derivadas direcionais.
      - Derivadas direcionais são projeções do gradiente.
    - Direção \(\Rightarrow\) interpretação econômica.
      - Choques compostos são vetores no espaço de estados.
    - Ortogonalidade \(\Rightarrow\) variação nula.
      - Movimentos ao longo de isoquantas.
    - Gradiente \(\Rightarrow\) base da otimização.
      - Condições de primeira ordem e métodos numéricos.
    - Síntese final:
      - Toda análise é local.
      - Toda sensibilidade depende da direção.
      - O gradiente é o núcleo analítico da estática comparativa multivariada.


* Funções explícitas: roteiro de resposta

1. Delimitar a motivação econômica e o problema geral

    *Objetivo:* situar o problema econômico e justificar o uso de ferramentas multivariadas.

   - Introduzir a análise quantitativa em economia \(\Rightarrow\) estudo de respostas marginais.
   - Comparar caso univariado vs. multivariado.
   - Enfatizar que a análise é local e marginal.
   - Contextualizar em modelos macroeconômicos e tecnológicos.
   - Destacar que múltiplas endógenas exigem formalismo vetorial.

2. Formalizar o objeto matemático de análise

    *Objetivo:* definir rigorosamente o tipo de função analisada.

   - Definir aplicação vetorial \(\vec{F}: D \subseteq \mathbb{R}^n \to \mathbb{R}^m\).
   - Identificar \(\vec{x}\) como vetor de argumentos.
   - Identificar \(\vec{y}=\vec{F}(\vec{x})\) como vetor de resultados.
   - Ressaltar distinção entre dimensão do domínio e do contradomínio.
   - Fixar notação vetorial com seta.

3. Enfatizar o caráter local da análise marginal

    *Objetivo:* explicitar que toda análise ocorre em torno de um ponto de referência.

   - Introduzir ponto-base \(\vec{x}_0\).
   - Destacar deslocamentos pequenos \(\vec{h}\).
   - Evitar interpretação global da função.
   - Relacionar diretamente à estática comparativa.

4. Definir diferenciabilidade de forma rigorosa

    *Objetivo:* estabelecer a condição matemática central do método.

   - Definir diferenciabilidade pela existência de um operador linear \(L:\mathbb{R}^n\to\mathbb{R}^m\).
   - Exigir que
     \begin{equation*}
     \lim_{\|\vec{h}\|\to 0}
     \frac{\|\vec{F}(\vec{x}_0+\vec{h})-\vec{F}(\vec{x}_0)-L(\vec{h})\|}
          {\|\vec{h}\|}=0
     \end{equation*}
   - Escrever a expansão local como
     \begin{equation*}
     \vec{F}(\vec{x}_0+\vec{h})
     =
     \vec{F}(\vec{x}_0)+L(\vec{h})+o(\|\vec{h}\|)
     \end{equation*}
   - Ressaltar unicidade do operador linear.
   - Destacar que diferenciabilidade é mais forte que derivadas parciais isoladas.
   - Enfatizar caráter local da definição.

5. Relacionar diferenciabilidade à Jacobiana

    *Objetivo:* conectar suavidade local à representação matricial.

   - Mostrar que diferenciabilidade \(\Rightarrow\) existência da Jacobiana.
   - Identificar a Jacobiana como a matriz associada ao operador linear \(L\).
   - Ressaltar dependência da Jacobiana do ponto \(\vec{x}_0\).
   - Destacar interpretação como melhor aproximação linear.

6. Definir formalmente a matriz Jacobiana

    *Objetivo:* apresentar a estrutura e interpretação da Jacobiana.

   - Definir
     \begin{equation*}
     D\vec{F}(\vec{x}_0)
     =
     \begin{pmatrix}
     \partial F_1/\partial x_1 & \cdots & \partial F_1/\partial x_n \\
     \vdots & \ddots & \vdots \\
     \partial F_m/\partial x_1 & \cdots & \partial F_m/\partial x_n
     \end{pmatrix}_{\vec{x}=\vec{x}_0}
     \end{equation*}
   - Precisar que cada linha é o gradiente de \(F_i\).
   - Ressaltar papel organizador dos efeitos marginais.

7. Introduzir o diferencial total

    *Objetivo:* operacionalizar a aproximação linear.

   - Definir vetor de choques \(\vec{h}=\Delta\vec{x}\).
   - Escrever
     \begin{equation*}
     \vec{F}(\vec{x}_0+\vec{h})-\vec{F}(\vec{x}_0)
     \approx
     D\vec{F}(\vec{x}_0)\vec{h}
     \end{equation*}
   - Enfatizar aproximação de primeira ordem.
   - Destacar necessidade de \(\|\vec{h}\|\) pequeno.

8. Interpretar economicamente o diferencial total

    *Objetivo:* conectar matemática e estática comparativa.

   - Interpretar cada linha como resposta de uma endógena.
   - Interpretar entradas de \(\vec{h}\) como magnitudes dos choques.
   - Enfatizar decomposição marginal dos efeitos.
   - Evitar interpretação causal global.

9. Construir o exemplo econômico multiproduto

    *Objetivo:* ilustrar o formalismo com tecnologia econômica concreta.

   - Definir firma com dois insumos \(K,L\).
   - Definir dois bens finais.
   - Especificar tecnologias Cobb–Douglas:
     \begin{equation*}
     F_1(K,L)=K^{1/2}L^{1/2},
     \quad
     F_2(K,L)=K^{1/2}L^{1/2}
     \end{equation*}
   - Destacar retornos constantes à escala.

10. Calcular a Jacobiana da tecnologia

    *Objetivo:* mostrar cálculo explícito das derivadas parciais.

    - Calcular produtos marginais:
      \begin{equation*}
      \frac{\partial F_i}{\partial K}
      =
      \frac{1}{2}\frac{\sqrt{L}}{\sqrt{K}},
      \quad
      \frac{\partial F_i}{\partial L}
      =
      \frac{1}{2}\frac{\sqrt{K}}{\sqrt{L}},
      \quad i=1,2
      \end{equation*}
    - Organizar resultados na Jacobiana simbólica.

11. Fixar ponto de referência simples

    *Objetivo:* facilitar cálculo manual e interpretação local.

    - Escolher \((K_0,L_0)=(1,1)\).
    - Calcular
      \begin{equation*}
      F_i(1,1)=1,
      \quad
      \nabla F_i(1,1)=\left(\frac{1}{2},\frac{1}{2}\right)
      \end{equation*}
    - Avaliar a Jacobiana no ponto.

12. Introduzir choque pequeno e assimétrico

    *Objetivo:* respeitar hipótese de localidade.

    - Definir
      \begin{equation*}
      \Delta\vec{I}=
      \left(\frac{1}{2},\frac{1}{4}\right)
      \end{equation*}
    - Interpretar como deslocamento local.

13. Aplicar o diferencial total

    *Objetivo:* executar a estática comparativa multivariada.

    - Calcular
      \begin{equation*}
      D\vec{F}(1,1)\Delta\vec{I}
      =
      \begin{pmatrix}
      1/2 & 1/2 \\
      1/2 & 1/2
      \end{pmatrix}
      \begin{pmatrix}
      1/2 \\ 1/4
      \end{pmatrix}
      =
      \begin{pmatrix}
      3/8 \\ 3/8
      \end{pmatrix}
      \end{equation*}
    - Interpretar cada variação como efeito marginal aproximado.

14. Definir a TMT de forma direcional

    *Objetivo:* evitar interpretações incorretas da TMT.

    - Introduzir vetor direcional \(\vec{d}\).
    - Definir curva \(\gamma(t)=\vec{I}_0+t\vec{d}\).
    - Definir derivadas direcionais
      \begin{equation*}
      \frac{dF_i}{dt}\Big|_{t=0}
      =
      \nabla F_i(\vec{I}_0)\cdot\vec{d}
      \end{equation*}
    - Definir
      \begin{equation*}
      \text{TMT}_{\vec{d}}(\vec{I}_0)
      =
      -\frac{\nabla F_2(\vec{I}_0)\cdot\vec{d}}
            {\nabla F_1(\vec{I}_0)\cdot\vec{d}}
      \end{equation*}
    - Ressaltar dependência de ponto e direção.
    - Negar interpretação como FPP global.

15. Sintetizar o encadeamento lógico do método

    *Objetivo:* reconstruir a lógica matemática e econômica completa, evitando omissões conceituais.

    - Diferenciabilidade \(\Rightarrow\) aproximação linear local.
      - Diferenciabilidade em \(\vec{x}_0\) \(\Rightarrow\) existência de uma aproximação linear única
        - Destacar que continuidade de derivadas é condição suficiente, mas não necessária.
        - Ressaltar que sem diferenciabilidade não existe Jacobiana bem definida.
        - Enfatizar o caráter estritamente local da aproximação.
    - Aproximação linear \(\Rightarrow\) Jacobiana.
      - Aproximação linear \(\Rightarrow\) definição da matriz Jacobiana \(D\vec{F}(\vec{x}_0)\).
        - Lembrar que a Jacobiana representa um operador linear, não apenas uma coleção de derivadas.
        - Precisar que cada linha é o gradiente de uma função componente.
        - Notar que a Jacobiana depende do ponto de avaliação.
    - Jacobiana \(\Rightarrow\) diferencial total.
      - Jacobiana \(\Rightarrow\) diferencial total como aproximação de primeira ordem.
        - Escrever explicitamente: \(\Delta\vec{Y} \approx D\vec{F}(\vec{x}_0)\Delta\vec{x}\).
        - Ressaltar que termos de ordem superior são desprezados.
        - Indicar que a validade depende de \(\|\Delta\vec{x}\|\) pequeno.
    - Diferencial total \(\Rightarrow\) estática comparativa.
      - Diferencial total \(\Rightarrow\) estática comparativa multivariada.
        - Interpretar como resposta conjunta das endógenas a choques vetoriais.
        - Enfatizar que os efeitos marginais são avaliados mantendo o ponto-base fixo.
        - Evitar interpretação global ou válida para grandes variações.
    - Vetores direcionais \(\Rightarrow\) derivadas ao longo de trajetórias específicas.
      - Introduzir explicitamente curvas \(\gamma(t)=\vec{x}_0+t\vec{d}\).
      - Interpretar \(\nabla F_i(\vec{x}_0)\cdot\vec{d}\) como variação direcional.
      - Ressaltar dependência da direção \(\vec{d}\).
    - Vetores direcionais \(\Rightarrow\) TMT local.
      - Derivadas direcionais \(\Rightarrow\) definição rigorosa da TMT local.
        - Precisar que a TMT é uma razão entre variações direcionais, não entre níveis.
        - Destacar que a TMT não é uma propriedade global da tecnologia.
        - Condicionar a TMT simultaneamente ao ponto e à direção considerada.
    - Regra da cadeia \(\Rightarrow\) propagação hierárquica.
      - Escrever formalmente: \(D(\vec{F}\circ\vec{A}) = D\vec{F}\,D\vec{A}\).
      - Interpretar como decomposição de efeitos diretos e indiretos.
      - Destacar a compatibilidade dimensional das matrizes envolvidas.
    - Jacobiana \(\Rightarrow\) base dos métodos iterativos.
      - Relacionar a linearização local ao método de Newton–Raphson.
      - Lembrar que o método atualiza soluções usando a inversa da Jacobiana.
      - Enfatizar que convergência depende de propriedades locais do sistema.
    - Síntese final:
      - Toda a análise é local, condicional ao ponto de referência.
      - Toda interpretação econômica depende da direção do choque.
      - O formalismo conecta teoria analítica, estática comparativa, dinâmica e métodos numéricos.

* Derivadas de ordens superiores: roteiro de resposta

1. Motivacao economica da analise de segunda ordem
   - Analise marginal de primeira ordem identifica apenas a direcao local de variacao.
   - Em problemas economicos, isso e insuficiente para:
     - Classificar extremos (maximo \(\rightarrow\) minimo).
     - Avaliar estabilidade de solucoes.
     - Formalizar rendimentos marginais decrescentes.
     - Caracterizar interacoes tecnicas entre variaveis.
   - A informacao adicional necessaria esta contida nas derivadas de segunda ordem.
   - *Refinamento de rigor:* deixar claro que a analise de segunda ordem envolve *curvatura local da funcao*

2. Condicoes de regularidade
   - Seja \( f : D \subseteq \mathbb{R}^n \rightarrow \mathbb{R} \).
   - \( f \in C^1(U) \):
     - As derivadas parciais de primeira ordem existem e sao continuas em \( U \).
   - \( f \in C^2(U) \):
     - Todas as derivadas parciais de segunda ordem existem e sao continuas em \( U \).
     - Implica diferenciabilidade das derivadas de primeira ordem.
   - *Refinamento de rigor:* explicitar que classe \(C^2\) e condicao suficiente para curvatura local consistente.

3. Comutatividade das derivadas mistas
   - Teorema de Schwarz:
     - Se \( f \in C^2(U) \), entao
       \[
       \frac{\partial^2 f}{\partial x_i \partial x_j}
       =
       \frac{\partial^2 f}{\partial x_j \partial x_i}.
       \]
   - Interpretacao economica:
     - Efeitos cruzados independe da ordem de avaliacao.
   - Teorema de Young:
     - Generaliza a comutatividade para derivadas de ordem \(k\), se \( f \in C^k \).
   - *Refinamento de rigor:* explicitar que Young garante simetria sistematica para ordens de derivacao arbitrarias.

4. Definicao da matriz Hessiana
   - Para \( f \in C^2 \), define-se:
     \[
     D^2 f(\vec{x}) =
     \begin{pmatrix}
     \frac{\partial^2 f}{\partial x_1^2}(\vec{x}) & \cdots & \frac{\partial^2 f}{\partial x_1 \partial x_n}(\vec{x}) \\
     \vdots & \ddots & \vdots \\
     \frac{\partial^2 f}{\partial x_n \partial x_1}(\vec{x}) & \cdots & \frac{\partial^2 f}{\partial x_n^2}(\vec{x})
     \end{pmatrix}.
     \]
   - Propriedades:
     - Matriz \(n \times n\).
     - Simetrica pelo Teorema de Schwarz.
   - Leituras equivalentes:
     - Agregador das derivadas segundas.
     - Jacobiana do operador gradiente.
   - *Refinamento de rigor:* explicitar que a Hessiana representa a **segunda variacao** do mapeamento.

5. Interpretacao economica dos elementos
   - Derivadas puras (diagonal):
     - Medem como o efeito marginal de \(x_i\) varia com \(x_i\).
     - Sinal negativo \(\rightarrow\) rendimentos marginais decrescentes.
   - Derivadas mistas (fora da diagonal):
     - Medem interacao entre variaveis.
     - Sinal positivo \(\rightarrow\) complementaridade local.
     - Sinal negativo \(\rightarrow\) substitutibilidade local.
   - *Refinamento de rigor:* separar sinais de derivadas puras e mistas com leitura economica distinta.

6. Hessiana como forma quadratica
   - Para uma variacao linear \( \vec{h} \):
     \[
     Q(\vec{h}) = \vec{h}^{\mathsf T} D^2 f(\vec{x}_0) \vec{h}.
     \]
   - Esta forma mede a curvatura local de \(f\) na direcao \(\vec{h}\).
   - *Refinamento de rigor:* validade condicionada a parametrizacao linear da trajetoria.

7. Exemplo economico: funcao de producao Cobb-Douglas
   - Funcao:
     \[
     F(K,L) = A K^{\alpha} L^{1-\alpha},
     \quad A>0,\; 0<\alpha<1.
     \]
   - Dominio: \(\mathbb{R}_{++}^2\).
   - \(F \in C^{\infty}\) \(\rightarrow\) Schwarz aplicavel.

8. Derivadas de primeira ordem (produtos marginais)
   - \(F_K = \alpha A K^{\alpha-1} L^{1-\alpha} \)
   - \(F_L = (1-\alpha) A K^{\alpha} L^{-\alpha} \)

9. Derivadas de segunda ordem
   - Puras:
     \[
     F_{KK} = \alpha(\alpha-1) A K^{\alpha-2} L^{1-\alpha},
     \quad
     F_{LL} = -\alpha(1-\alpha) A K^{\alpha} L^{-\alpha-1}
     \]
   - Mistas:
     \[
     F_{KL} = F_{LK}
     = \alpha(1-\alpha) A K^{\alpha-1} L^{-\alpha}
     \]

10. Propriedades economicas
    - \(F_{KK}<0, F_{LL}<0\) \(\rightarrow\) rendimentos marginais decrescentes.
    - \(F_{KL}>0\) \(\rightarrow\) complementaridade local entre fatores.

11. Hessiana em forma matricial:
    \[D^2F(K,L) = A K^{\alpha-2} L^{-\alpha-1} \begin{pmatrix} \alpha(\alpha-1)L^2 & \alpha(1-\alpha)KL \\ \alpha(1-\alpha)KL & -\alpha(1-\alpha)K^2 \end{pmatrix}. \]

12. Concavidade e convexidade: regra operacional
    - Hessiana negativa semidefinida:
      - Funcao concava.
      - Associada a maximos.
    - Hessiana positiva semidefinida:
      - Funcao convexa.
      - Associada a minimos.
    - *Mnemotecnica:* concava \(\rightarrow\) maximo, convexa \(\rightarrow\) minimo.

13. Classificacao de pontos criticos
    - \(\nabla f(\vec{x}^*) = \vec{0}\).
    - Hessiana:
      - Negativa definida \(\rightarrow\) maximo local.
      - Positiva definida \(\rightarrow\) minimo local.
      - Indefinida \(\rightarrow\) sela.

14. Sintese final
    - Segunda ordem \(\rightarrow\) curvatura e interações.
    - Requer definição de funções continuamente diferenciais
    - Teorema de Schwarz garante simetria da Hessiana
    - Hessiana \(\rightarrow\) agregador completo da informacao de curvatura.
    - Aplicação com Cobb-Douglas permite explicitar hipóteses de rendimentos marginais decrescentes
    - Fornece critério para classificação de pontos críticos
    - Permite avaliar comportamento local e global de funções

* Teorema da função implícita: roteiro de resposta


1) Muitos problemas econômicos são formulados por meio de equações implícitas
   a. As variáveis endógenas não podem ser isoladas analiticamente
   b. As condições de equilíbrio combinam restrições comportamentais, tecnológicas e de mercado
   c. O equilíbrio é definido por um sistema do tipo
      \[F(\vec{x}, \vec{y}) = \vec{0} \]
      1. \(\vec{x}\): variáveis exógenas ou parâmetros
      2. \(\vec{y}\): variáveis endógenas
2) O TFI garante, localmente:
   a. Existência do equilíbrio
   b. Unicidade do equilíbrio
   c. Diferenciabilidade das variáveis endógenas em relação às exógenas
   d. Fundamentação matemática da estática comparativa
3) Formulação escalar do TFI
   a. Seja \(F: U \subset \mathbb{R}^2 \rightarrow \mathbb{R}\), \(F \in C^1(U)\)
   b. Equação implícita:
      \[F(x,y)=0 \]
   c. Ponto de referência:
      \[(x_0,y_0) \in U \quad \text{tal que} \quad F(x_0,y_0)=0 \]
   d. Hipótese central:
      \[F_y(x_0,y_0) \neq 0 \]
   e. Conclusão: Existem vizinhanças abertas \(V\) de \(x_0\) e \(W\) de \(y_0\) e uma função
      \[y = \phi(x), \quad \phi \in C^1(V) \]
      \[\phi(x_0)=y_0, \quad F(x,\phi(x))=0 \;\; \forall x \in V \]
4) Diferenciando totalmente \(F(x,\phi(x))=0\):
    \[dF = F_x dx + F_y dy = 0 \]
   a. Resolvendo para \(dy/dx\), avaliada no ponto \((x_0,y_0)\):
       \[\frac{dy}{dx} = -\frac{F_x}{F_y} \]
5) Interpretação geométrica
   a. \(F(x,y)=0\) define uma curva de nível
   b. O gradiente \(\nabla F = (F_x,F_y)\) é normal à curva
   c. O vetor tangente local é \((1,dy/dx)\)
   d. A condição \(\nabla F \cdot (1,dy/dx)=0\) recupera exatamente a expressão do TFI
   e. Fundamenta taxas marginais de substituição técnica
      a. Função de produção definida por \(Y(K,L) = \bar{Y}\),
         a. \(dL/dK = -(\partial Y/\partial K)/(\partial Y/\partial L)\) desde que \(\partial Y/\partial L \neq 0\).
6) Generalização: uma equação e múltiplas variáveis
   a. Seja \(F: U \subset \mathbb{R}^{n+1} \rightarrow \mathbb{R}\), \(F \in C^1\)
      - \(\vec{x}=(x_1,\dots,x_n)^\top\)
      \[F(\vec{x},y)=0 \]
   b. Condição:
      \[F_y(\vec{x}_0,y_0) \neq 0 \]
   c. Derivadas parciais da função implícita:
      \[\frac{\partial y}{\partial x_i} = -\frac{F_{x_i}}{F_y} \]
7) Sistemas de equações: caso relevante em economia
   a. \(F: U \subset \mathbb{R}^n \times \mathbb{R}^m \rightarrow \mathbb{R}^m \)
      a. \(\vec{x} \in \mathbb{R}^n\): variáveis exógenas
      b. \(\vec{y} \in \mathbb{R}^m\): variáveis endógenas
   b. Sistema: \(F(\vec{x},\vec{y})=\vec{0} \)
8) Condição de aplicabilidade do TFI:
   a. Jacobiana em relação às variáveis endógenas:
   \[J_{\vec{y}}F(\vec{x}_0,\vec{y}_0) = \left[\frac{\partial F_i}{\partial y_j} \right]_{m\times m} \]
   a. Hipótese central: \(\det(J_{\vec{y}}F)\neq 0 \)
9) Diferenciação total do sistema
   a. Diferenciando:
   \[F(\vec{x},\vec{\phi}(\vec{x}))=\vec{0} \]
   a. obtém-se:
   \[\frac{\partial F}{\partial \vec{x}} d\vec{x} + \frac{\partial F}{\partial \vec{y}} d\vec{y} = \vec{0} \]
10) Fórmula matricial da estática comparativa
    a. Sob não-singularidade de \(\partial F/\partial \vec{y}\):
    \[d\vec{y} = -\left[\frac{\partial F}{\partial \vec{y}} \right]^{-1} \frac{\partial F}{\partial \vec{x}} d\vec{x} \]
    a. Cada elemento \((j,k)\) mede o impacto marginal de \(x_k\) sobre \(y_j\)
    b. Esta expressão encapsula toda a estática comparativa local
11) Aplicação: equilíbrio geral de trocas puras
    a. Dois bens: \(X,Y\)
    b. Dois consumidores: \(A,B\)
    c. Dotações:
       \[\vec{e}^A=(e_X^A,0), \quad \vec{e}^B=(0,e_Y^B) \]
    d. Preferências Cobb–Douglas:
       \[u^A=x_A^\alpha y_A^{1-\alpha}, \quad u^B=x_B^\beta y_B^{1-\beta} \]
    e. Numerário: \(p_Y=1\), preço relativo \(p=p_X\)
    f. Demanda e equação implícita do preço
       a. Demandas:
       \[x_A^d=\alpha e_X^A, \quad x_B^d=\frac{\beta e_Y^B}{p} \]
       a. Equilíbrio no mercado de \(X\):
       \[F(e_X^A,e_Y^B,p) \equiv \alpha e_X^A + \frac{\beta e_Y^B}{p} - e_X^A = 0 \]
    g. Derivadas parciais relevantes
        \[\frac{\partial F}{\partial p} = -\frac{\beta e_Y^B}{p^2} \quad\neq 0 \]
        \[\frac{\partial F}{\partial e_Y^B} = \frac{\beta}{p} \quad \frac{\partial F}{\partial e_X^A} = -(1-\alpha) \]
    h. Resultados de estática comparativa
        \[\frac{\partial p}{\partial e_Y^B} = \frac{p}{e_Y^B} > 0 \]
        \[\frac{\partial p}{\partial e_X^A} = -\frac{(1-\alpha)p^2}{\beta e_Y^B} < 0 \]
    i. Interpretação econômica
       a. Aumento em \(e_Y^B\) eleva a demanda por \(X\) → \(p\) aumenta
       b. Aumento em \(e_X^A\) amplia a oferta relativa de \(X\) → \(p\) cai
       c. Resultados consistentes com a função explícita do preço
    j. Equivalência com a solução por derivação direta
       \[\alpha e_X^A + \frac{\beta e_Y^B}{p} - e_X^A = 0 \]
       \[p = \frac{\beta e_Y^B}{(1-\alpha)e_X^A} \]
       a. Derivando diretamente:
         \[\frac{\partial p}{\partial e_Y^B} = \frac{p}{e_Y^B} \quad \frac{\partial p}{\partial e_X^A} = -\frac{p}{e_X^A} \]
       b. Substituindo \(p\) na segunda expressão:
          \[\frac{\partial p}{\partial e_X^A} = -\frac{(1-\alpha)p^2}{\beta e_Y^B} \]
12) Síntese conceitual
    a. O TFI estrutura a análise local de equilíbrio
    b. A estática comparativa é um problema de diferenciação total
    c. A Jacobiana endógena governa estabilidade e sensibilidade
    d. O exemplo reduzido preserva a generalidade do sistema completo



* Formas quadráticas e matrizes definidas: Roteiro de resposta
1. Motivação geral
   1. Problemas econômicos envolvem otimização com ou sem restrições
   2. Funções objetivo: utilidade, custo, portfólio
   3. Restrições: físicas, monetárias, institucionais
   4. Método padrão:
      - Identificar pontos críticos
      - Qualificar esses pontos
2. Condições de primeira ordem
   1. Pontos críticos satisfazem:
      \( \nabla f(\vec{x}_0) = \vec{0} \)
   2. Condição necessária
   3. Garante estacionariedade
   4. Não distingue máximo, mínimo ou sela
3. Papel das condições de segunda ordem
   1. Análise local na vizinhança do ponto crítico
   2. Baseada em derivadas de segunda ordem
   3. Associada a formas quadráticas
   4. Associada a matrizes definidas
4. Estrutura da exposição
   1. Definição formal de formas quadráticas
   2. Critérios de definitude para matrizes simétricas
   3. Ligação com otimização irrestrita
   4. Critérios via:
      - Autovalores
      - Menores principais
   5. Extensão para restrições lineares
   6. Introdução de definitude restrita
   7. Uso de matriz orlada
   8. Aplicação numérica em teoria da firma
5. Definição de forma quadrática
   1. Aplicação:
      \( Q : \mathbb{R}^n \to \mathbb{R} \)
   2. Homogênea de grau dois
   3. Representação por somatório:
      \[
      Q(\vec{x}) = \sum_{i=1}^n \sum_{j=1}^n a_{ij} x_i x_j
      \]
   4. Representação matricial:
      \[
      Q(\vec{x}) = \vec{x}^\top A \vec{x}
      \]
6. Simetrização da matriz
   1. Para qualquer matriz B:
      \[
      A = \frac{1}{2}(B + B^\top)
      \]
   2. Representação única da forma quadrática
   3. Simetria não altera Q
   4. Garante autovalores reais
7. Definitude: definições
   1. Positiva definida: \( \vec{x}^\top A \vec{x} > 0 \; \forall \vec{x} \neq \vec{0} \)
   2. Negativa definida: \( \vec{x}^\top A \vec{x} < 0 \; \forall \vec{x} \neq \vec{0} \)
   3. Positiva semidefinida: \( \vec{x}^\top A \vec{x} \ge 0 \) existe \( \vec{v} \neq 0 \) com igualdade
   4. Negativa semidefinida: definição análoga
   5. Indefinida: sinais opostos para vetores distintos
8. Relação com expansão de Taylor
   1. Função \( f \in C^2 \)
   2. Aproximação:
      \[f(\vec{x}_0 + \vec{h}) \approx f(\vec{x}_0) + \nabla f(\vec{x}_0)^\top \vec{h} + \frac{1}{2} \vec{h}^\top H_f(\vec{x}_0) \vec{h} \]
   3. Em ponto crítico:
      \[f(\vec{x}_0 + \vec{h}) \approx f(\vec{x}_0) + \frac{1}{2} \vec{h}^\top H_f(\vec{x}_0) \vec{h} \]
9. Interpretação da forma quadrática
   1. Termo dominante da variação local
   2. Define sinal de:
      \( f(\vec{x}_0 + \vec{h}) - f(\vec{x}_0) \)
   3. Correspondências:
      - Positiva definida \(\rightarrow\) mínimo local estrito
      - Negativa definida \(\rightarrow\) máximo local estrito
      - Indefinida \(\rightarrow\) ponto de sela
   4. Extensão multivariada da derivada segunda
10. Hessiana em problemas econômicos
    1. Hessiana é simétrica (Teorema de Schwarz)
    2. Autovalores reais
    3. Classificar ponto crítico equivale a: classificar definitude da Hessiana
    4. Semidefinitude: teste inconclusivo
11. Critérios de classificação
    1. Dois critérios principais
    2. Equivalentes para matrizes simétricas
    3. Escolha depende do contexto
12. Critério espectral
    1. Diagonalização:
       \( A = P \Lambda P^\top \)
    2. \( P \) ortogonal
    3. \( \Lambda = \text{diag}(\lambda_1,\dots,\lambda_n) \)
    4. Classificação:
       - Todos \( \lambda_i > 0 \) \(\rightarrow\) positiva definida
       - Todos \( \lambda_i < 0 \) \(\rightarrow\) negativa definida
       - Mistura de sinais \(\rightarrow\) indefinida
       - Zeros \(\rightarrow\) semidefinida
13. Critério dos menores principais
    1. \( A_k \): submatriz líder de ordem k
    2. \( D_k = \det(A_k) \)
    3. Positiva definida:
       \( D_k > 0 \; \forall k \)
    4. Negativa definida:
       \( (-1)^k D_k > 0 \)
    5. Semidefinitude:
       exige todos os menores principais
    6. Critério mais operacional em baixa dimensão
14. Introdução de restrições lineares
    1. Problemas econômicos típicos
    2. Apenas direções viáveis importam
    3. Restrições:
       \( B\vec{x} = \vec{0} \)
    4. Definitude restrita:
       avaliação da forma quadrática no subespaço viável

15. Definitude sob restrição
    1. Positiva definida restrita:
       \( \vec{x}^\top A \vec{x} > 0 \)
       para todo \( \vec{x} \neq 0 \) tal que \( B\vec{x} = 0 \)
    2. Analogia com condições de segunda ordem restritas
16. Matriz orlada
    1. Construção:
       \[H = \begin{pmatrix} \mathbf{0}_{m \times m} & B \\ B^\top & A \end{pmatrix} \]
    2. Matriz simétrica
    3. Projeta a forma quadrática no espaço viável
17. Critério da matriz orlada
    1. Analisar menores principais líderes de H
    2. Apenas os últimos \( n-m \)
    3. Sinais dependem de m
    4. Caso m = 1:
       - Positiva definida restrita:
         menores líderes negativos
18. Aplicação econômica
    1. Firma com dois insumos L e K
    2. Minimização de custo
    3. Função quadrática:
       \[C(L,K) = \frac{1}{2}L^2 + \frac{1}{2}K^2 + \frac{1}{4}LK \]
    4. Hessiana constante:
       \[H_C = \begin{pmatrix} 1 & \frac{1}{4} \\ \frac{1}{4} & 1 \end{pmatrix} \]
    5. Polinômio característico:
       \[\det(H_C - \lambda I) = (1-\lambda)^2 - \left(\frac{1}{4}\right)^2 = \lambda^2 - 2\lambda + \frac{15}{16} \]
    6. Autovalores:
       \[\lambda_1 = \frac{3}{4}, \quad \lambda_2 = \frac{5}{4} \]
    7. Hessiana positiva definida
    8. Análise válida globalmente
19. Restrição tecnológica
    1. Restrição linear:
       \[2L + K = \bar{Q} \]
    2. Matriz da restrição:
       \[B = \begin{pmatrix} 2 & 1 \end{pmatrix} \]
    3. Define subespaço viável
    4. Direções admissíveis satisfazem:
       \( 2\Delta L + \Delta K = 0 \)
    5. Vetor direcional genérico:
       \[\vec{h} = \begin{pmatrix} t \\ -2t \end{pmatrix} \]
20. Qualificação do ótimo restrito
    1. Matriz orlada:
       \[H = \begin{pmatrix} 0 & 2 & 1 \\ 2 & 1 & \frac{1}{4} \\ 1 & \frac{1}{4} & 1 \end{pmatrix} \]
    2. Menor principal líder relevante:
       \[\det \begin{pmatrix} 0 & 2 & 1 \\ 2 & 1 & \frac{1}{4} \\ 1 & \frac{1}{4} & 1 \end{pmatrix} < 0 \]
    3. Sinal consistente com m = 1
    4. Custo convexa ao longo da restrição
    5. Mínimo local estrito sob a restrição
21. Síntese final
    1. Formas quadráticas fundamentam a análise de segunda ordem
    2. Hessiana conecta matemática e intuição econômica
    3. Autovalores e menores principais são critérios equivalentes
    4. Matriz orlada estende o teste ao caso restrito
    5. Instrumental central em métodos quantitativos em economia




* Glossário

- Classe \(C^{1}\) :: Funções que possuem derivadas parciais de *primeira ordem* contínuas em seu domínio
  - Classe \(C^{2}\) :: Incluem funções com derivadas parciais de *segunda* ordem que são contínuas. Permite aplicar o Teorema de Schwarz (derivadas mistas iguais).
- Diferencial Vs. Derivada total :: O diferencial é uma *aproximação linear* da função para pequenas variações em suas variáveis independentes em torno de um ponto. A derivada total indica a taxa de variação de uma função em termos de uma variável considerando os efeitos diretos e indiretos
- Função afim :: Equivalente à função polinomial do primeiro grau com a forma: \(f(x) = ax + b\). Trata-se de uma transformação linear
- Funções transcendentares :: São funções que não podem ser expressas como solução de uma equação polinomial. Em outras palavras, não podem ser obtidas através de um número finito de operações algébricas
- Gradiente descendente :: Dada uma função \( f: \mathbb{R}^n \to \mathbb{R} \), o objetivo é encontrar o mínimo global ou local de \(f\). Atualiza iterativamente os parâmetros na direção oposta ao gradiente da função, que indica a maior taxa de crescimento de \(f\). A regra de atualização é expressa por: \(\mathbf{w}_{k+1} = \mathbf{w}_k - \eta \nabla f(\mathbf{w}_k)\);  \(\eta\): taxa de aprendizado.
- Multiplicador de Lagrange (interpretação) :: mede a variação no valor ótimo da função objetivo decorrente de um relaxamento marginal da restrição. Representa o preço-sombra do recurso escasso.
- Preço-sombra :: Valor marginal implícito de um recurso escasso.
- Produto escalar :: Formado pela multiplicação dos elementos dos vetores, subsequentemente somados. O resultado fornece um número real. Produto escalar é o caso particular de um produto interno.
- Produto vetorial :: Sejam dois vetores \(\vec{a}\) e \(\vec{b}\) linearmente independenetes, o produto vetorial (denotado por \(\times\) ou \(\wedge\)) resulta em um vetor normal a esses dois. Resultado é um vetor, não um escalar.
  - Comprimento do produto vetorial :: Pode ser interpretado como a área do paralogramo formado pelos vetores \(\vec{a}\) e \(\vec{b}\)
  - Cálculo :: é dado pelo determinante formado pelo vetores unitários canônicos e os vetores \(\vec{a}\) e \(\vec{b}\) nas linhas. Por essa razão, é anticomutativo (\(\vec{a}\times\vec{b} = - \vec{b}\times\vec{a}\)
  - Produto triplo escalar :: Fornece a multiplicação de três vetores juntos, sendo equivalente ao cálculo do volume e pode envolver o produto escalar de um dos vetores com o produto vetorial dos demais vetores
- Taxa Marginal de Transformação :: representa a quantidade de um bem que deve ser sacrificada para produzir uma unidade adicional de outro bem, mantendo constantes os recursos e a tecnologia disponíveis. Matematicamente, a TMT é expressa como a inclinação (em valor absoluto) da Fronteira de Possibilidades de Produção (FPP) em um ponto específico: \(\text{TMT}_{\vec{d}}(\vec{I}_0) = -\frac{\nabla F_2(\vec{I}_0)\cdot\vec{d}} {\nabla F_1(\vec{I}_0)\cdot\vec{d}}\)
  - TMT e FPP :: A TMT varia ao longo da FPP devido à lei dos rendimentos marginais decrescentes: à medida que mais recursos são alocados para a produção de um bem, a produtividade adicional obtida diminui
- Teorema Clairaut-Schwarz :: A ordem das derivadas parciais *mistas* não importam para funções de classe \(C^{2}\). Como consequência, as derivadas mistas são iguais.
  - Teorema de Young :: Garante a igualdade das derivadas parciais mistas sob hipóteses de regularidade mais fracas. Em geral, basta a existência das derivadas mistas e a continuidade de uma delas no ponto considerado.
- Teorema do confronto :: Utilizado para computar o limite de uma função a partir da comparação de funções próximas com limites conhecidos.
- Teorema de Euler para Funções Homogêneas :: Se uma função \(f(x_{1},...,x_{n})\) é homogênea de grau \(k\), então a soma de cada variável multiplicada pela sua derivada parcial correspondente é igual a \(k\) vezes a função original
- Teorema de Weierstrass (valores extremos) :: Seja \(f : K \rightarrow \mathbb{R}\) uma função contínua definida em um conjunto \(K \subset \mathbb{R}^n\) compacto. Então \(f\) atinge um máximo e um mínimo globais em \(K\). O teorema assegura existência de extremos, mas não fornece sua localização nem critérios de unicidade.
  - Ideia de conjunto compacto :: Intuitivamente, isso significa que o conjunto não se estende ao infinito e contém todos os seus pontos de fronteira.
- Versor :: É o mesmo que vetor unitário. Definido em um espaço vetorial normado dotado de norma igual a um. Por consequência, o produto escalar de dois vetores unitários é equivalente ao cosseno do ângulo entre eles. Para normalizar um vetor, basta dividí-lo por sua norma.
- Vetor normal à reta :: Dada uma equação de reta \(ax + by + c = 0\), \(\vec{n} = (a,b)\) é o vetor normal a essa reta. Dito de outro modo, o produto escalar entre (x,y) e \(\vec{n}\) é zero. Outra forma de calcular é a partir negativo do inverso da inclinação da reta tangente a essa curva (derivada). Depois, basta substituir a inclinação na equação da reta.
